<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>岁染</title>
  <icon>https://www.gravatar.com/avatar/7228219e90ece9b38ea5921da1fcc500</icon>
  <subtitle>别来无恙，你在心上</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2024-02-07T15:35:37.514Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>Kagura</name>
    <email>651421775@qq.com</email>
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title></title>
    <link href="http://example.com/2024/01/19/%E3%80%90%E6%95%B0%E5%AD%A6%E3%80%91%E9%9B%B6%E7%A2%8E%E6%95%B0%E5%AD%A6%E7%9F%A5%E8%AF%86/"/>
    <id>http://example.com/2024/01/19/%E3%80%90%E6%95%B0%E5%AD%A6%E3%80%91%E9%9B%B6%E7%A2%8E%E6%95%B0%E5%AD%A6%E7%9F%A5%E8%AF%86/</id>
    <published>2024-01-19T09:41:30.626Z</published>
    <updated>2024-02-07T15:35:37.514Z</updated>
    
    <content type="html"><![CDATA[<h2 id="罗尔定理">罗尔定理</h2><p>罗尔定理其实很简单，说的就是在一个连续可导的函数内，如果区间<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[a,b]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">]</span></span></span></span>中存在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(a)=f(b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span>，那么必有一点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ξ</mi></mrow><annotation encoding="application/x-tex">\xi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span></span></span></span> 使得<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>ξ</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">f&#x27;(\xi)=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>。</p><blockquote><p>比较容易发现，连续函数在欧几里得空间上不存在跳跃点和间断点，若某区间两个端点值相等，那么函数必然存在以下情况:</p><ul><li>始终为常数</li><li>先增后减</li><li>先减后增</li></ul><p>无论哪种情况，势必会存在某一点的斜率为0</p></blockquote><h2 id="拉格朗日中值定理">拉格朗日中值定理</h2><p>对于罗尔定理的进一步推导，我们令：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></mfrac><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>a</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(x)=f(x)-(f(a)+\frac{f(b)-f(a)}{b-a}(x-a))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.1963em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">a</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mclose">))</span></span></span></span></span></p><p>这里面，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{f(b)-f(a)}{b-a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4133em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">a</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">b</span><span class="mclose mtight">)</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">a</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>实际上表示区间平均斜率，实际上，根据微分的定义，假设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>→</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">b\to a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>，此时就是该点的导数。</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>是位于区间<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(a,b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span>中的一点，根据微分定义，差值就等于当前点减去左端点，而在这里<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>的定义是依据区间斜率与真实斜率变化的残差。</p><p>于是很显然，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><mi>ϕ</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\phi(a)=\phi(b)=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>，残差就是真实值。</p><p>根据罗尔定理:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>ϕ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>ξ</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>ξ</mi><mo stretchy="false">)</mo><mo>−</mo><mfrac><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></mfrac><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\phi&#x27;(\xi)=f&#x27;(\xi)-\frac{f(b)-f(a)}{b-a}=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.1963em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">a</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span></p><p>可以得到：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>ξ</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(b)-f(a)=f&#x27;(\xi)(b-a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span></span></p><blockquote><p>实际上，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>+</mo><mfrac><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></mfrac><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y=f(a)+\frac{f(b)-f(a)}{b-a}(x-a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.4133em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">a</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">b</span><span class="mclose mtight">)</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">a</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span>是一个直线方程，即链接端点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a,b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span></span></span></span>的直线。</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">\phi(x)=f(x)-y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></p></blockquote><p><strong>碎碎念</strong></p><p>其实罗尔定理不难，从数形结合的角度很容易就解释的通。我们只需要记住，在连续的函数内，若两个端点值相同，那么必然存在一点作为缓冲点，该点的梯度为零。</p><p>那么拉格朗日中值定理又是如何推导的？</p><p>这里引入了残差的概念，真实值减去模拟值，即减去链接两点的直线，残差毫无疑问在两个端点处为零且相等，那么就必然存在某个点，使得残差的导数为零。</p><p>于是可以进一步推导：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>ϕ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mfrac><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></mfrac><mo>=</mo><mn>0</mn><mspace linebreak="newline"></mspace><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo><mo>−</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi&#x27;(x)=f&#x27;(x)-\frac{f(b)-f(a)}{b-a}=0\\f&#x27;(x)(b-a)=f(b)-f(a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.1963em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">a</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span></span></p><p><strong>关键词</strong></p><p>罗尔定理：</p><ul><li>两端相等，中间导数为零</li></ul><p>拉格朗日中值定理</p><ul><li>残差端点相等，存在一点导数乘上区间等于区间值差。</li></ul><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;罗尔定理&quot;&gt;罗尔定理&lt;/h2&gt;
&lt;p&gt;罗尔定理其实很简单，说的就是在一个连续可导的函数内，如果区间&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://example.com/2024/01/18/%E3%80%90Coursera%E3%80%91%E7%BB%8F%E5%85%B8%E8%AF%BE%E7%A8%8B/"/>
    <id>http://example.com/2024/01/18/%E3%80%90Coursera%E3%80%91%E7%BB%8F%E5%85%B8%E8%AF%BE%E7%A8%8B/</id>
    <published>2024-01-18T13:37:47.996Z</published>
    <updated>2024-01-26T16:16:12.369Z</updated>
    
    <content type="html"><![CDATA[<h1>【Coursera】经典课程</h1><hr><h1>Learning How to Learn</h1><h3 id="Key-Point">Key Point</h3><h3 id="1-Diffused-Model-Focused-Model">1.  Diffused Model &amp; Focused Model</h3><p>When you pay your undivided attention to doing something, your brain will form a working model named the <em>Focused Model</em>.</p><p>The focused Model helps you to handle your work logically, but if you want something more creative, you have to change your thinking model.</p><h3 id="2-Memory">2.  Memory</h3><p>Long-term memory and working memory.</p><p>working memory only has four chunks.</p><p>Space repetition will help short-term memory turn to long-term memory.</p><p>Enough sleep is essential for this process.</p><blockquote><p>sleep is actually your brain’s way of keeping itself clean and healthy.</p></blockquote><p>A critical idea: Dream about what you want.</p><p>Dreaming about what you’re studying can substantially enhance your ability to understand it.</p><h3 id="3-Emotion">3.  Emotion</h3><p>Asking questions to keep your attention.</p><p>You learn more by active engagement rather than passive listening.</p><p>In essence, a lot of success in life is that passion and persistence.</p><h3 id="4-Productive-environment">4.  Productive environment</h3><p>You should be surrounded by other people who are stimulating you.</p><h3 id="5-Exercise">5.  Exercise</h3><p>Exercise not only can re-build your neuron connections, but also boost mood.</p><h3 id="6-Chunk">6.  Chunk</h3><p>Basically, a chunk is a network of neurons that used to firing together.</p><p>How to form a chunk:</p><ul><li>The first step in chunking is simply to focus your undivided attention on the information you want to chunk.</li><li>The second step in chunking is to understand the basic idea you are trying to chunk.</li><li>The third step to chunk is gaining context, so you can see not just how, but also where to use this chunk.</li></ul><h3 id="7-Recall">7.  Recall</h3><blockquote><p>You often realize that the first time you actually understand something is when you can actually do it by yourself.</p></blockquote><p>To avoid being caught in the illusions of competence, after you’ve read the material, simply look away, and see what you can recall from the material you’ve just read.</p><p>Testing yourself. Mistakes can help you correct your thinking, so you can learn better and do better.</p><h3 id="8-Metaphor-and-analogy">8.  Metaphor and analogy</h3><h3 id="9-Habit">9.  Habit</h3><h3 id="10-Focus-training">10.  Focus training</h3><h3 id="11-Devote-all-your-orgen">11.  Devote all your orgen</h3><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;【Coursera】经典课程&lt;/h1&gt;
&lt;hr&gt;
&lt;h1&gt;Learning How to Learn&lt;/h1&gt;
&lt;h3 id=&quot;Key-Point&quot;&gt;Key Point&lt;/h3&gt;
&lt;h3 id=&quot;1-Diffused-Model-Focused-Model&quot;&gt;1.  Di</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://example.com/2024/01/17/%E3%80%90Latex%E3%80%91%E5%B8%B8%E8%A7%81%E5%85%AC%E5%BC%8F%E6%94%B6%E8%97%8F/"/>
    <id>http://example.com/2024/01/17/%E3%80%90Latex%E3%80%91%E5%B8%B8%E8%A7%81%E5%85%AC%E5%BC%8F%E6%94%B6%E8%97%8F/</id>
    <published>2024-01-17T14:59:55.545Z</published>
    <updated>2024-01-17T15:03:34.275Z</updated>
    
    <content type="html"><![CDATA[<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mi mathvariant="normal">.</mi><mspace width="1em"><munderover><mo>∑</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>A</mi><mi>l</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mo stretchy="false">{</mo><msub><mi>d</mi><mrow><mi>l</mi><mi>i</mi></mrow></msub><mo>≤</mo><msub><mi>d</mi><mn>0</mn></msub><mo stretchy="false">}</mo></mrow><mi>N</mi></munderover><mi>G</mi><mo stretchy="false">(</mo><msub><mi>d</mi><mrow><mi>l</mi><mi>i</mi></mrow></msub><mo separator="true">,</mo><msub><mi>d</mi><mn>0</mn></msub><mo stretchy="false">)</mo><msub><mi>R</mi><mi>i</mi></msub><mspace linebreak="newline"></mspace><mo>=</mo><munderover><mo>∑</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mo stretchy="false">{</mo><msub><mi>d</mi><mrow><mi>l</mi><mi>i</mi></mrow></msub><mo>≤</mo><msub><mi>d</mi><mn>0</mn></msub><mo stretchy="false">}</mo></mrow><mi>N</mi></munderover><mi>G</mi><mo stretchy="false">(</mo><msub><mi>d</mi><mrow><mi>l</mi><mi>i</mi></mrow></msub><mo separator="true">,</mo><msub><mi>d</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mfrac><mrow><msub><mi>W</mi><mi>i</mi></msub><mo>+</mo><msub><mi>O</mi><mi>i</mi></msub></mrow><mrow><munder><mo>∑</mo><mrow><mi>l</mi><mo>∈</mo><mo stretchy="false">{</mo><msub><mi>d</mi><mrow><mi>i</mi><mi>l</mi></mrow></msub><mo>≤</mo><msub><mi>d</mi><mn>0</mn></msub><mo stretchy="false">}</mo></mrow></munder><mi>G</mi><mo stretchy="false">(</mo><msub><mi>d</mi><mrow><mi>i</mi><mi>l</mi></mrow></msub><mo separator="true">,</mo><msub><mi>d</mi><mn>0</mn></msub><mo stretchy="false">)</mo><msub><mi>P</mi><mi>l</mi></msub></mrow></mfrac></mspace></mrow><annotation encoding="application/x-tex">max. \quad \sum_{l=1}^N A_l=\sum_{l=1}^N\sum_{i\in \{d_{li}\le d_0\}}^NG(d_{li},d_0)R_i\\=\sum_{l=1}^N\sum_{i\in \{d_{li}\le d_0\}}^NG(d_{li},d_0)\frac{W_i+O_i}{\sum_{l\in \{d_{il}\le d_0\}}G(d_{il},d_0)P_l}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.1304em;vertical-align:-1.3021em;"></span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mord">.</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.3443em;vertical-align:-1.516em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.809em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mopen mtight">{</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mrel mtight">≤</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">}</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.516em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.3443em;vertical-align:-1.516em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.809em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mopen mtight">{</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mrel mtight">≤</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">}</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.516em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2253em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mrel mtight">∈</span><span class="mopen mtight">{</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span></span></span></span></span></span></span><span class="mrel mtight">≤</span><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">}</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4747em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1607em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>表示网格总数，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>O</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">O_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>表示格网<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 原始的服务设施能力总和，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">W_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为格网<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 更新的服务设施的服务能力总和，计算公式为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>W</mi><mi>i</mi></msub><mo>=</mo><mo>∑</mo><mi>T</mi><mo>⋅</mo><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">W_i= \sum{T}\cdot x_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.6em;vertical-align:-0.55em;"></span><span class="mop op-symbol large-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 表示数量矩阵<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>在第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 个格网的分量，记作：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mo stretchy="false">[</mo><msub><mi>x</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">x_i=[x_{i1},\cdots,x_{ij}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span>表示修正后的设施价值参数，记作：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>T</mi><mo>=</mo><mo stretchy="false">[</mo><msub><mi>T</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><msub><mi>T</mi><mi>j</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">T=[T_1,\cdots,T_j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></p><p>式<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span></span></span></span>中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的原始矩阵<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>记作：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>X</mi><mo>=</mo><mrow><mo fence="true">∣</mo><mtable rowspacing="0.16em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mstyle></mtd></mtr></mtable><mo fence="true">∣</mo></mrow></mrow><annotation encoding="application/x-tex">X=\left|\begin{matrix}x_{11} &amp; \cdots  &amp; x_{1j} \\\vdots &amp;\ddots &amp;  \vdots \\x_{i1} &amp; \cdots &amp; x_{ij} \\\end{matrix}\right|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.26em;vertical-align:-1.88em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.362em;"><span style="top:-3.166em;"><span class="pstrut" style="height:5.016em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-3.764em;"><span class="pstrut" style="height:5.016em;"></span><span style="height:3.016em;width:0.3333em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="3.016em" style="width:0.3333em" viewbox="0 0 333.33000000000004 3016" preserveaspectratio="xMinYMin"><path d="M145 0 H188 V3016 H145z M145 0 H188 V3016 H145z"/></svg></span></span><span style="top:-6.7721em;"><span class="pstrut" style="height:5.016em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.38em;"><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.88em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.38em;"><span style="top:-5.04em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">⋯</span></span></span><span style="top:-3.18em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">⋱</span></span></span><span style="top:-1.98em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">⋯</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.88em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.38em;"><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.3675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1675em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.88em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.362em;"><span style="top:-3.166em;"><span class="pstrut" style="height:5.016em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-3.764em;"><span class="pstrut" style="height:5.016em;"></span><span style="height:3.016em;width:0.3333em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="3.016em" style="width:0.3333em" viewbox="0 0 333.33000000000004 3016" preserveaspectratio="xMinYMin"><path d="M145 0 H188 V3016 H145z M145 0 H188 V3016 H145z"/></svg></span></span><span style="top:-6.7721em;"><span class="pstrut" style="height:5.016em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>矩阵<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> 记录设施的数量分配信息，向量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span> 记录设施的服务能力，他们蕴含了问题中自变量的最基本信息。</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;bloc</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>【数据分析】常见问题及解法</title>
    <link href="http://example.com/2024/01/17/%E3%80%90%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E3%80%91%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E9%81%87%E5%88%B0%E9%97%AE%E9%A2%98/"/>
    <id>http://example.com/2024/01/17/%E3%80%90%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E3%80%91%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E9%81%87%E5%88%B0%E9%97%AE%E9%A2%98/</id>
    <published>2024-01-17T14:19:42.723Z</published>
    <updated>2024-01-17T18:10:06.796Z</updated>
    
    <content type="html"><![CDATA[<h1>【采样】</h1><ol><li>随机选取样本：</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.sample(n=<span class="number">6</span>)</span><br></pre></td></tr></table></figure><ol start="2"><li>按照百分比随机选取样本</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.sample(frac=<span class="number">0.6</span>)</span><br></pre></td></tr></table></figure><ol start="3"><li>可复现的随机种子</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.sample(n=<span class="number">6</span>,random_state=<span class="number">42</span>)</span><br></pre></td></tr></table></figure><hr><h1>【地理信息】</h1><blockquote><h3 id="创建凸包-Convex">创建凸包(Convex)</h3></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> shapely.geometry <span class="keyword">import</span> Polygon,MultiPolygon</span><br><span class="line"><span class="comment"># GeoPandas中的geometry继承自shapely.geometry</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一组示例矢量面</span></span><br><span class="line">polygon1 = Polygon([(<span class="number">0</span>, <span class="number">0</span>), (<span class="number">1</span>, <span class="number">0</span>), (<span class="number">1</span>, <span class="number">1</span>), (<span class="number">0</span>, <span class="number">1</span>)])</span><br><span class="line">polygon2 = Polygon([(<span class="number">1</span>, <span class="number">0</span>), (<span class="number">2</span>, <span class="number">0</span>), (<span class="number">2</span>, <span class="number">1</span>), (<span class="number">1</span>, <span class="number">1</span>)])</span><br><span class="line">polygon3 = Polygon([(<span class="number">2</span>, <span class="number">0</span>), (<span class="number">3</span>, <span class="number">0</span>), (<span class="number">3</span>, <span class="number">1</span>), (<span class="number">2</span>, <span class="number">1</span>)])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将矢量面合并为一个多边形集合</span></span><br><span class="line"><span class="comment"># 这也是不规则跨空间面要素的存储方式</span></span><br><span class="line"></span><br><span class="line">multi_polygon=MultiPolygon([polygon1,...])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对这个多边形集创建凸包</span></span><br><span class="line">convex_hull=multi_polygon.convex_hull</span><br></pre></td></tr></table></figure><p>上面这组示例是介绍从矢量面开始构建凸集，实际上凸集是<code>geometry</code>对象的一个属性，可以直接进行获取。例如在GeoPandas中：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.geometry.convex_hull</span><br></pre></td></tr></table></figure><blockquote><h3 id="合并地理几何体">合并地理几何体</h3></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> geopandas <span class="keyword">as</span> gpd</span><br><span class="line"><span class="keyword">from</span> shapely.geometry <span class="keyword">import</span> Polygon</span><br><span class="line"></span><br><span class="line">polygon1 = Polygon([(<span class="number">0</span>, <span class="number">0</span>), (<span class="number">1</span>, <span class="number">0</span>), (<span class="number">1</span>, <span class="number">1</span>), (<span class="number">0</span>, <span class="number">1</span>)])</span><br><span class="line">polygon2 = Polygon([(<span class="number">1</span>, <span class="number">0</span>), (<span class="number">2</span>, <span class="number">0</span>), (<span class="number">2</span>, <span class="number">1</span>), (<span class="number">1</span>, <span class="number">1</span>)])</span><br><span class="line"></span><br><span class="line">gdf=gpd.GeoDataFrame(geometry=[polygon1,polygon2])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加一个列&#x27;Group&#x27;作为合并的依据</span></span><br><span class="line">gdf[<span class="string">&#x27;group&#x27;</span>]=[<span class="string">&#x27;Group1&#x27;</span>,<span class="string">&#x27;Group1&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 依据合并key进行几何体合并</span></span><br><span class="line">merge=gdf.dissolve(by=<span class="string">&#x27;group&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可视化</span></span><br><span class="line">gdf.plot(edgecolor=<span class="string">&#x27;black&#x27;</span>,facecolor=<span class="string">&#x27;none&#x27;</span>,linewidth=<span class="number">2</span>)</span><br><span class="line">merge.plot(edgecolor=<span class="string">&#x27;red&#x27;</span>,facecolor=<span class="string">&#x27;none&#x27;</span>,linewidth=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><strong>知识点</strong>：</p><ul><li>GeoPandas绘制函数<ul><li>df.plot(edgecolor,facecolor,linewith)</li></ul></li><li>创建GDF<ul><li>gpd.GeoDataFrame(geometry=[‘’])</li></ul></li><li>合并对象(重构点集)<ul><li>gpd.dissolve(by=key)</li></ul></li></ul><blockquote><h3 id="利用Merge方法">利用Merge方法</h3></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> geopandas <span class="keyword">as</span> gpd</span><br><span class="line"><span class="keyword">from</span> shapely.geometry <span class="keyword">import</span> Point</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建两个示例 GeoDataFrame</span></span><br><span class="line">data1 = &#123;<span class="string">&#x27;ID&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">         <span class="string">&#x27;geometry&#x27;</span>: [Point(<span class="number">0</span>, <span class="number">0</span>), Point(<span class="number">1</span>, <span class="number">1</span>), Point(<span class="number">2</span>, <span class="number">2</span>)]&#125;</span><br><span class="line">gdf1 = gpd.GeoDataFrame(data1, crs=<span class="string">&#x27;EPSG:4326&#x27;</span>)</span><br><span class="line"></span><br><span class="line">data2 = &#123;<span class="string">&#x27;ID&#x27;</span>: [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">         <span class="string">&#x27;value&#x27;</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>],</span><br><span class="line">         <span class="string">&#x27;geometry&#x27;</span>: [Point(<span class="number">1</span>, <span class="number">1</span>), Point(<span class="number">2</span>, <span class="number">2</span>), Point(<span class="number">3</span>, <span class="number">3</span>)]&#125;</span><br><span class="line">gdf2 = gpd.GeoDataFrame(data2, crs=<span class="string">&#x27;EPSG:4326&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 &#x27;ID&#x27; 列进行合并</span></span><br><span class="line">merged_gdf = gdf1.merge(gdf2, on=<span class="string">&#x27;ID&#x27;</span>,how=inner)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="built_in">print</span>(merged_gdf)</span><br></pre></td></tr></table></figure><p><strong>知识点</strong>：</p><ul><li>合并<ul><li>gdp_1.merge(gdp_2,on=‘ID’,how=inner)</li><li>on表示主键，how表示合并方法</li></ul></li></ul><blockquote><h3 id="空间关系">空间关系</h3></blockquote><p>🌟 <strong>包含</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g.contains()</span><br></pre></td></tr></table></figure><p>🌟 <strong>相交</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g.intersects()</span><br></pre></td></tr></table></figure><blockquote><h3 id="创建缓冲区">创建缓冲区</h3></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> geopandas <span class="keyword">as</span> gpd</span><br><span class="line"><span class="keyword">from</span> shapely.geometry <span class="keyword">import</span> Point</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个示例 GeoDataFrame</span></span><br><span class="line">data = &#123;<span class="string">&#x27;geometry&#x27;</span>: [Point(<span class="number">0</span>, <span class="number">0</span>), Point(<span class="number">1</span>, <span class="number">1</span>), Point(<span class="number">2</span>, <span class="number">2</span>)]&#125;</span><br><span class="line">gdf = gpd.GeoDataFrame(data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算质心</span></span><br><span class="line">gdf[<span class="string">&#x27;centroid&#x27;</span>]=gdf[<span class="string">&#x27;geometry&#x27;</span>].centroid</span><br><span class="line">gdf[<span class="string">&#x27;buffer&#x27;</span>]=gdf[<span class="string">&#x27;centroid&#x27;</span>].buffer(distance=<span class="number">1.0</span>) <span class="comment"># 圆形缓冲区</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可视化矢量面、质心和缓冲区</span></span><br><span class="line">ax=gdf.plot(facecolor=<span class="string">&#x27;none&#x27;</span>,edgecolor=<span class="string">&#x27;blue&#x27;</span>)</span><br><span class="line">gdf[<span class="string">&#x27;centroid&#x27;</span>].plot(ax=ax,color=<span class="string">&#x27;red&#x27;</span>,marker=<span class="string">&#x27;o&#x27;</span>,markersize=<span class="number">50</span>)</span><br><span class="line">gdf[<span class="string">&#x27;buffer&#x27;</span>].plot(ax=ax,facecolor=<span class="string">&#x27;none&#x27;</span>,edgecolor=<span class="string">&#x27;green&#x27;</span>,alpha=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示图形</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><strong>知识点：</strong></p><ul><li>质心<ul><li>geometry.centroid</li></ul></li><li>缓冲区<ul><li>geometry.buffer</li></ul></li><li>在同一图层上绘制<ul><li>创建图层：ax=gpd.plot()</li><li>在图层上绘制：geometry.plot(ax=ax,…)</li></ul></li><li>绘制点<ul><li>point.plot(color,marker,markersize)</li></ul></li></ul><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
    
    
    <summary type="html">None</summary>
    
    
    
    <category term="不想学辣" scheme="http://example.com/categories/%E4%B8%8D%E6%83%B3%E5%AD%A6%E8%BE%A3/"/>
    
    
    <category term="数据分析" scheme="http://example.com/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://example.com/2023/11/29/Week%201/"/>
    <id>http://example.com/2023/11/29/Week%201/</id>
    <published>2023-11-29T13:16:45.867Z</published>
    <updated>2023-11-29T13:16:45.867Z</updated>
    
    <content type="html"><![CDATA[<hr><h1>Week 1.</h1><h2 id="Introduction-to-the-Focused-and-Diffuse-Modes">Introduction to the Focused and Diffuse Modes</h2><blockquote><p>Incidentally, both metaphor and analogy are really helpful when you’re trying to learn something new.</p></blockquote><p>So how are you going to develop that new thought in the first place?</p><p>![image-20231026170845664](【公开课】Learning to how to learn/image-20231026170845664.png)</p><p>Diffuse Model: you can look at things broadly from a very different, big-picture perspective. You can make new neural connections traveling along new pathways. <span style="color:yellow">You can at least get to the initial place you need to be in to home in on a solution.</span></p><p>Focused Model: You can focus in as tightly as you often do to finalize any kind of problem solving. Understand the finest aspects of a concept.</p><blockquote><p>This raises a puzzle. In the face of so much turnover, how do memories stay stable over so many years?</p><p>This raises a puzzle: 这就导致了一个问题</p><p>In the face of: 面对</p></blockquote><p>This illustrates that, intriguingly(有趣地 /ɪnˈtriːɡɪŋli/ ) that you are not the same person you were after a night’s sleep or even a nap.</p><p>In the first week, you will learn how to take advantage of your unconscious mind and also sleep to make every things easier.</p><h2 id="A-procrastination-preview">A procrastination preview</h2><blockquote><p>In this episode, we’re going to give you a litter insight into procrastination. Why it raises, and a powerful little tool to help you address it.</p></blockquote><p>![image-20231027165254635](【公开课】Learning to how to learn/image-20231027165254635.png)</p><p>funnel: 漏斗，通过漏斗，传送，传输</p><p>A handy little mental tool: Pomodoro(番茄钟)</p><p>How to use Pomodoro?</p><ul><li>set a timer to 25 mins.</li><li>turn off all the interruptions</li><li>focus!</li><li>gain your reward!</li></ul><p>That’s it!</p><p>It’s a little like doing an intense 25 minute workout at a mental gym, followed by some mental relaxation.</p><h2 id="Practice-Makes-Permanent">Practice Makes Permanent</h2><blockquote><p>But let’s back up a step. (退一步讲)</p><p>At least in part. (至少有一部分)</p></blockquote><p>![image-20231027170310316](【公开课】Learning to how to learn/image-20231027170310316-1698397391538-1.png)</p><p>Neurons become linked together through repeated use. The more abstract something is, the more important it is to practice in order to bring those ideas into reality for you.</p><blockquote><p>bring sth. into reality for you. 为你所用</p></blockquote><p>If you don’t do this (means have a short break afte a tense focus working), if instead you learn by cramming (填鸭式的), your knowledge base will all in a jumble (乱七八糟) with everything confused, a poor foundation.</p><p>![image-20231027171119266](【公开课】Learning to how to learn/image-20231027171119266.png)</p><h2 id="Introduction-of-Memory">Introduction of Memory</h2><p><strong>Working memory</strong></p><ul><li>Is the part of memory that has to do with what you’re immediately and consciously processing in your mind.</li><li>![image-20231027171427025](【公开课】Learning to how to learn/image-20231027171427025.png)</li><li>7 chunks or 4 chunks of information</li></ul><p><strong>Long term memory</strong></p><ul><li>It’s distribute over a big area.</li><li>Different kinds of long term memories are stored in different regions of the brain.</li></ul><img src="/2023/11/29/Week%201/image-20231027171658608.png" alt="image-20231027171658608" style="zoom:50%;"><img src="/2023/11/29/Week%201/image-20231027171741472.png" alt="image-20231027171741472" style="zoom:50%;"><p><strong>Technique: spaced repetition</strong></p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;hr&gt;
&lt;h1&gt;Week 1.&lt;/h1&gt;
&lt;h2 id=&quot;Introduction-to-the-Focused-and-Diffuse-Modes&quot;&gt;Introduction to the Focused and Diffuse Modes&lt;/h2&gt;
&lt;blockquote&gt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>扇贝英语 听力 积累材料</title>
    <link href="http://example.com/2023/11/13/%E3%80%90%E8%8B%B1%E8%AF%AD%E3%80%91%E6%89%87%E8%B4%9D%E5%90%AC%E5%8A%9B%E7%A7%AF%E7%B4%AF%E6%9D%90%E6%96%99/"/>
    <id>http://example.com/2023/11/13/%E3%80%90%E8%8B%B1%E8%AF%AD%E3%80%91%E6%89%87%E8%B4%9D%E5%90%AC%E5%8A%9B%E7%A7%AF%E7%B4%AF%E6%9D%90%E6%96%99/</id>
    <published>2023-11-13T14:55:39.011Z</published>
    <updated>2023-11-13T15:46:51.108Z</updated>
    
    <content type="html"><![CDATA[<h4 id="🏷️-探寻孤独背后的秘密">🏷️ 探寻孤独背后的秘密</h4><p>Everybody feels lonely <code>from time to time.</code></p><blockquote><p>from time to time 时不时</p></blockquote><p>But over the last few decades, this <code>occasional</code> feeling has become <code>chronic</code> for millions.</p><blockquote><p>过去几十年，这种偶尔出现的感觉已经变成数百万人的长期感受</p></blockquote><p>In the US, 46% of the entire population feel lonely <code>regularly</code>.</p><blockquote><p>regularly: 经常的</p></blockquote><p>Loneliness is a purely subjective, individual experience.</p><blockquote><p>孤独是一种纯粹主观，个人的体验</p></blockquote><p>Nothing can <code>protect</code> you <code>against</code> loneliness, because it’s <code>part of your biology</code>.</p><blockquote><p>protect against: 保护</p><p>part of your biology: 你的天性</p></blockquote><p>It was a great indicator of how likely you were to survive.</p><blockquote><p>这一指标可以很好的衡量你春晖的概率</p></blockquote><p>While those who did not got kicked out and most likely died.</p><blockquote><p>那些没做出改变的人就会遭到排斥，更有可能死亡</p></blockquote><p>Intellectuals <code>moved away</code> from the collectivism of the Middle Ages, while the young Protestant theology stressed individual responsibility,</p><blockquote><p>知识分子“远离”中世纪的集体主义，而年轻的新教神学强调个人责任，</p><p>stress : 强调</p></blockquote><p>This trend accelerated during the Industrial Revolution.</p><blockquote><p>这一趋势在工业革命期间增强</p></blockquote><p>As our world rapidly became modern, this trend sped up more and more.</p><blockquote><p>随着现代化的飞速发展，这一趋势逐渐增强</p></blockquote><p>We are still biologically fine-tuned to being with each other.</p><blockquote><p>fine-tune : 微调，调整, adj. 有调整的，有提高的</p></blockquote><hr><p>🏷️</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
    
    
    <summary type="html">复习一下下</summary>
    
    
    
    <category term="不想学辣" scheme="http://example.com/categories/%E4%B8%8D%E6%83%B3%E5%AD%A6%E8%BE%A3/"/>
    
    
    <category term="英语" scheme="http://example.com/tags/%E8%8B%B1%E8%AF%AD/"/>
    
  </entry>
  
  <entry>
    <title>扇贝英语 阅读 积累材料</title>
    <link href="http://example.com/2023/11/13/%E3%80%90%E8%8B%B1%E8%AF%AD%E3%80%91%E6%89%87%E8%B4%9D%E9%98%85%E8%AF%BB%E7%A7%AF%E7%B4%AF%E6%9D%90%E6%96%99/"/>
    <id>http://example.com/2023/11/13/%E3%80%90%E8%8B%B1%E8%AF%AD%E3%80%91%E6%89%87%E8%B4%9D%E9%98%85%E8%AF%BB%E7%A7%AF%E7%B4%AF%E6%9D%90%E6%96%99/</id>
    <published>2023-11-13T14:16:13.683Z</published>
    <updated>2023-11-13T14:54:58.748Z</updated>
    
    <content type="html"><![CDATA[<hr><h3 id="🏷️-Why-Bilinguals-May-Have-a-Memory-Advantage-–-New-Research">🏷️ Why Bilinguals May Have a Memory Advantage – New Research</h3><p>But a new study, published in Science Advances,has revealed that this may actually give bilinguals an advantage <code>when it comes to</code> memory.</p><blockquote><p>when it comes to： 当涉及到</p><p>reveal: 揭示，揭露</p></blockquote><p>So it is easy to see why, upon hearing the first sounds of a word, potential candidate words are activates, not only from one language, but from the other one as well.</p><blockquote><p>So it is easy to see: 很容易理解</p></blockquote><p>This could certainly indicate that bilinguals are more efficient at multitasking and more able to focus on the task at hand, especially when the task requires ignoring irrelevant information.(think trying to work in a noisy cafe)</p><p>🐺 <strong>unfamiliar words</strong></p><p><code>apparatus</code> n. 装置，器械，组织，机构</p><p><code>tougher</code> adj. 较坚强的，较艰苦的</p><p><code>cut down</code> 减少，砍倒</p><p><code>retrieve</code> v. 收回，取回，挽回，补救，检索</p><p><code>cognitive</code> adj. 认知的，感知的</p><p><code>resemble</code> v. 类似</p><p><code>manipulate</code> v. 操纵，使用，熟练操作</p><p><code>overlap</code> v. 重叠 n. 交叠的部分</p><p><code>Not surprisingly</code> 不出所料</p><p>🔑 <strong>文章大意</strong></p><p>双语或多语言者需要花费更大的时间去记忆，但实际上，这种记忆要比单语言者更加的稳固，即使在生成备选队列：<code>fills in the blanks, cutting down from a vast list of potential candidate words to predict the target word.</code> 需要更多的精力。</p><hr><h3 id="🏷️-TikTok-Is-Changing-the-Way-Books-Are-Recommended-and-Sold">🏷️ TikTok Is Changing the Way Books Are Recommended and Sold</h3><p>TikTok is not the first platform to alter the publishing landscape.</p><blockquote><p>alter sth landscape: 颠覆XXX</p></blockquote><p>Novels categorised as “romance” have enjoyed the biggest boost, as happened with previous technological shifts, including the rise of e-books.</p><blockquote><p>被划分为罗曼史的小说获得了最大的推动力，这与以往之前的科技转型中常出现的情景类似，如电子书的崛起</p></blockquote><p>Publishers, happy for new sales, are also a bit perplexed; their official TikTok accounts are unpopular by comparison.</p><blockquote><p>by comparison: 相较之下</p></blockquote><p>Such tricks are rapidly becoming the norm.</p><blockquote><p>这样的策略正在快速变成常态。</p></blockquote><p>🐺 <strong>unfamiliar words</strong></p><p><code>flaunt</code> v. n. 炫耀，夸耀，卖弄</p><p><code>meticulously</code> adv. 仔细的</p><p><code>manicured</code> adj. 精心护理的，修剪整齐的</p><p><code>make a mark</code> 留下深渊影响</p><p><code>splinter</code> v. 分裂，分离(splinter into) n. 尖碎片</p><p><code>unearth</code> v. 挖掘，发掘，找到</p><p><code>go viral</code> 疯狂传播，走红(spread rapidly)</p><p><code>flick</code> v. 轻弹</p><p><code>shelve</code> v. 搁置，倾斜，成斜坡</p><p><code>perplexed</code> adj. 困惑的，迷惑不解的</p><p><code>keep up</code> 坚持</p><p><code>executive</code> adj. 行政的，管理的，高档的 n. 主管，经理</p><p><code>making the most of</code> 充分利用</p><p><code>keep an eye out</code> 留心观察 (for)</p><p>🔑 <strong>文章大意</strong></p><p>短视频平台给传统书籍领域带来新的机遇，即通过推荐、活动和宣传来提高书籍知名度，甚至是发掘一些潜在的</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
    
    
    <summary type="html">复习一下下</summary>
    
    
    
    <category term="不想学辣" scheme="http://example.com/categories/%E4%B8%8D%E6%83%B3%E5%AD%A6%E8%BE%A3/"/>
    
    
    <category term="英语" scheme="http://example.com/tags/%E8%8B%B1%E8%AF%AD/"/>
    
  </entry>
  
  <entry>
    <title>【GIS实践】基于改进区域生长的临近斑块分类方法</title>
    <link href="http://example.com/2023/11/13/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E5%9F%BA%E4%BA%8E%E6%94%B9%E8%BF%9B%E5%8C%BA%E5%9F%9F%E7%94%9F%E9%95%BF%E6%B3%95%E7%9A%84%E5%9F%8E%E5%B8%82%E6%96%91%E5%9D%97%E5%88%86%E7%B1%BB/"/>
    <id>http://example.com/2023/11/13/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E5%9F%BA%E4%BA%8E%E6%94%B9%E8%BF%9B%E5%8C%BA%E5%9F%9F%E7%94%9F%E9%95%BF%E6%B3%95%E7%9A%84%E5%9F%8E%E5%B8%82%E6%96%91%E5%9D%97%E5%88%86%E7%B1%BB/</id>
    <published>2023-11-13T10:35:06.774Z</published>
    <updated>2023-11-13T10:36:19.846Z</updated>
    
    <content type="html"><![CDATA[<h1>基于改进区域生长的临近斑块分类方法</h1><hr><h2 id="一、背景描述">一、背景描述</h2><p>根据Tobler第一定理，距离相近的地物有着更加紧密的关系，因此，在对城市低效用地的重新评估过程中，往往需要考虑当前低效用地斑块与周边斑块的关系。低效用地斑块的整改也会对周边非低效用地产生影响，为了降低二次规划整治成本，提升区块景观美学价值，最大化经济社会效益，本文将考虑低效用地斑块与周边地物的关联程度，并将满足条件的非低效用地与低效用地聚合。</p><p>现有数据中，斑块用地是大小不一、形状各异的矢量面数据，传统的空间分类方式较难考虑到矢量面的大小、拓扑关系，容易将小低效用地与大面积非低效用地联合考虑，这样的结果并不符合最大化社会经济效益的目标。为了基于以低效斑块用地为核心的拓扑关系进行区域分类，本文拟采用区域生长法来实现相似斑块的合并。</p><hr><h2 id="二、算法理论">二、算法理论</h2><p>区域生长算法是图像处理领域中常见的图像分割方法，其基本思想是从图像的一个像素或邻域中出发，比较相邻部分的特征，按照相似原则不断合并，直至不能再合并的分割方式。区域生长算法按照邻域和相似性准则不同，可分为单一型、质心型和混合型三种区域增长方法，其核心任务在于：</p><ul><li>确定区域的数目</li><li>选择有意义的特征</li><li>确定相似性准则</li></ul><p>由于斑块之间是面积不一、没有规范空间分布的矢量面数据，在本文的工作中，将采用混合型增长的方式进行合并。</p><h3 id="2-1-特征权重确定">2.1  特征权重确定</h3><p>为了确保选取的特征最具代表性，可以考虑基于信息增益的方式，利用熵权法(Entropy Weight Method)对现有特征进行权重分配。熵权法是客观赋权的一种方式，对应的主观赋权有专家打分法，熵权法只注重数据本身，不会受到人为因素的影响。熵权法是利用信息稳定程度而提出的方法，一般来说，某列属性越稳定，它的信息就越可信，那么在实际的权重也应当越高。</p><p>假设当前每个斑块具有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>个特征，并且一共有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>个斑块，其中低效用地斑块为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>个，非低效用地为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>−</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">m-k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>个。</p><p>特征<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>的信息熵写作：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>E</mi><mi>i</mi></msub><mo>=</mo><mo>∑</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><msub><mi>X</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">E_i=\sum-\log(P(X_{ij}))X_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.6em;vertical-align:-0.55em;"></span><span class="mop op-symbol large-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">))</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">X_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>表示特征<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>的随机变量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>。</p><p>为了去除各个特征的量纲影响，需要先对特征进行归一化。</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>X</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">Y_{ij}=\frac{X_{ij}-min(X_i)}{max(X_i)-min(X_i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">min</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">min</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Y_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>表示特征<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>的随机变量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>的归一化值。接着，基于频率替代概率，并计算归一化信息熵：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo>∑</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac><mspace linebreak="newline"></mspace><msub><mi>H</mi><mi>i</mi></msub><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mrow><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>∑</mo><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_{ij}=\frac{Y_{ij}}{\sum Y_{ij}}\\H_i=-\frac{1}{ln(m)}\sum p_{ij}ln(p_{ij})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3324em;vertical-align:-0.9721em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2574em;vertical-align:-0.936em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-symbol large-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">H_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>表示特征<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>的归一化信息熵，最后再通过计算各个特征的归一化信息熵占比来确定特征的权重：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>W</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mn>1</mn><mo>−</mo><msub><mi>H</mi><mi>i</mi></msub></mrow><mrow><mi>k</mi><mo>−</mo><mo>∑</mo><msub><mi>H</mi><mi>j</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">W_i=\frac{1-H_i}{k-\sum H_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3324em;vertical-align:-0.9721em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>经过选取后的特征权重为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>i</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">W_i, i\in [1,n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span>。</p><hr><h3 id="2-2-相似性准则确定">2.2  相似性准则确定</h3><h4 id="2-2-1-缓冲区距离">2.2.1  缓冲区距离</h4><p>此时，我们需要考虑如何设置相似性准则，并且实现合并。</p><p>区块的合并需要考虑空间可达性，一般认为，设施==半径D[查文献]==(步行距离1200/800/400)内的区块具有良好的可达性。</p><p>因此，我们将对低效用地构建半径为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>的缓冲区，并计算该区域内的相邻地块特征。</p><blockquote><p>改进： 是否可以采用自适应缓冲区？</p></blockquote><h4 id="2-2-2-相似度度量">2.2.2 相似度度量</h4><p>分类结果的具体质量应该取决于相似度度量算法，以及它的实现。如果一个分类还能挖掘一些或者全部的隐藏模式，我们也可以认为它是一个高质量的分类方法。通常，数据科学家们使用相异度/相似度矩阵 （Dissimilarity/Similarity metric）来对不同数据特征之间的相似度进行度量，一般是通过距离公式进行。</p><p>在我们的工作中，将采用余弦相似度对数据进行度量：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>s</mi><mi>i</mi><mi>m</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>x</mi><mo>⋅</mo><mi>y</mi></mrow><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mo>×</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>y</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">sim(x,y)=\frac{x\cdot y}{||x||\times||y||}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">im</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣∣</span><span class="mord mathnormal">x</span><span class="mord">∣∣</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">∣∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord">∣∣</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x,y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>为斑块<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>与斑块<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>的特征向量，这些特征向量的构成方式为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>x</mi><mo>=</mo><mo stretchy="false">[</mo><msub><mi>W</mi><mn>1</mn></msub><mo>×</mo><msub><mi>X</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>W</mi><mi>i</mi></msub><mo>×</mo><msub><mi>X</mi><mi>i</mi></msub><msup><mo stretchy="false">]</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">x=[W_1\times X_1,...,W_i\times X_i]^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></p><p>本文将采用非负实数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span>作为相似度阈值，当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>i</mi><mi>m</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>≥</mo><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">sim(x,y)\ge \epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">im</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span>时，视为二者具有较高的相似度。本文将分别设置<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi><mtext>为</mtext><mn>0.6</mn><mo separator="true">,</mo><mn>0.7</mn><mo separator="true">,</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">\epsilon为0.6,0.7,0.8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ϵ</span><span class="mord cjk_fallback">为</span><span class="mord">0.6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.7</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.8</span></span></span></span>，并探究其对最终结果的影响。、</p><p>同时，为了考虑空间衰减，可能需要根据缓冲区的类型来进行空间衰减，距离越接近的区块，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span>的取值越低。</p><h4 id="2-2-3-面积关系">2.2.3 面积关系</h4><p>实际上，不同的区块有着一个至关重要的属性：面积。即使两个斑块的特征十分接近，但若低效用地面积远小于非低效用地，那么对于他们之间的合并是有待商榷的。为了尽可能保证经济效益，应当避免将面积过大的非低效用地考虑进面积较小的低效用地的联合整改队列中。</p><p>考虑到低效用地<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>与非低效用地<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>的面积<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">S_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>，现有如下分段措施：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>ϵ</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mspace width="1em"><msub><mi>S</mi><mi>j</mi></msub><mo>≥</mo><mn>2</mn><msub><mi>S</mi><mi>i</mi></msub></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>ϵ</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>α</mi><mfrac><msub><mi>S</mi><mi>j</mi></msub><msub><mi>S</mi><mi>i</mi></msub></mfrac></mrow></msup></mrow></mfrac><mo separator="true">,</mo><mspace width="1em"><msub><mi>S</mi><mi>j</mi></msub><mo>∈</mo><mo stretchy="false">(</mo><mn>0.5</mn><msub><mi>S</mi><mi>i</mi></msub><mo separator="true">,</mo><mn>2</mn><msub><mi>S</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>ϵ</mi><mo>=</mo><mn>0.5</mn><mo separator="true">,</mo><mspace width="1em"><msub><mi>S</mi><mi>j</mi></msub><mo>≤</mo><mn>0.5</mn><msub><mi>S</mi><mi>i</mi></msub></mspace></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{cases}\epsilon=1,\quad S_j\ge2S_i\\\epsilon=\frac{1}{1+e^{-\alpha\frac{S_j}{S_i}}},\quad S_j \in (0.5S_i,2S_i)\\\epsilon=0.5,\quad S_j\le0.5S_i\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.0131em;vertical-align:-2.2566em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.9em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-1.892em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.616em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.616em" style="width:0.8889em" viewbox="0 0 888.89 616" preserveaspectratio="xMinYMin"><path d="M384 0 H504 V616 H384z M384 0 H504 V616 H384z"/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.616em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.616em" style="width:0.8889em" viewbox="0 0 888.89 616" preserveaspectratio="xMinYMin"><path d="M384 0 H504 V616 H384z M384 0 H504 V616 H384z"/></svg></span></span><span style="top:-4.9em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.7566em;"><span style="top:-4.7566em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.3166em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.19em;"><span class="pstrut" style="height:3.2568em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.7954em;"><span style="top:-3.7954em;margin-right:0.0714em;"><span class="pstrut" style="height:3.0829em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size1 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.516em;"><span style="top:-2.468em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:-0.0576em;margin-right:0.1em;"><span class="pstrut" style="height:2.6595em;"></span><span class="mord mathnormal mtight">i</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3147em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.8327em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3448em;margin-left:-0.0576em;margin-right:0.1em;"><span class="pstrut" style="height:2.6595em;"></span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5092em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8467em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size1 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.4868em;"><span class="pstrut" style="height:3.2568em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.6508em;"><span class="pstrut" style="height:3.2568em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1251em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord">0.5</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-1.1834em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0.5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0.5</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.2566em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>为一个非负参数，用于控制<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span>的变化速率。本实验将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>的值设置为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span>。</p><h4 id="2-2-4-空间重叠">2.2.4 空间重叠</h4><p>实际上，由于缓冲区本身的特性，有些非低效用地可能会被多个低效用地斑块所考虑，此时，我们将多个低效用地视为一个面积更大的区域，该区域的面积为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mo>=</mo><mo>∑</mo><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S=\sum S_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.6em;vertical-align:-0.55em;"></span><span class="mop op-symbol large-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>表示大区域的面积，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>表示可达该非低效用地的第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>个低效斑块。</p><p>实际上 ，当发生空间叠置时，即使是相同类型的低效斑块，其属性也有可能有较大不同。</p><p>因此，在这种情况下，需要先评估重叠的几个低效斑块的相似度，再决定能否合成一个大的区块。</p><p>若低效斑块相似度较高，则将该非低效用地与几个低效斑块用地进行相似度比较，选择最高值来判断是否高于相似度阈值。</p><p>若低效相似度较低，则需要分别考虑每个低效斑块与非低效斑块的相似度，而不是将其视为一个更大的源区块。</p><hr><h2 id="三、技术流程图">三、技术流程图</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">graph TB</span><br><span class="line">id1[所有斑块属性导出]--&gt;id2(基于熵权法确定特征权重)</span><br><span class="line">id2--&gt;id3(构建特征向量)</span><br><span class="line"></span><br><span class="line">id4[低效用地]--&gt;id5(构建缓冲区)</span><br><span class="line">id5--&gt;id6(确定缓冲区内的非低效用地)</span><br><span class="line"></span><br><span class="line">id6--&gt;id7(相似度计算)</span><br><span class="line">id3--&gt;id7</span><br><span class="line"></span><br><span class="line">id7--&gt;id8(判断空间关系)</span><br><span class="line">id8--&gt;id10(确定低效斑块集群面积)</span><br><span class="line">id10--&gt;id11(更新阈值参数)</span><br><span class="line">id11--&gt;id12&#123;相似度是否大于阈值&#125;</span><br><span class="line">id12--Y --&gt;id13[将非低效用地视为联合整改部分]</span><br><span class="line">id12--N--&gt;id14[不做修改]</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h2 id="四、实现代码">四、实现代码</h2><h3 id="4-1-数据预处理">4.1  数据预处理</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"><span class="keyword">import</span> geopandas <span class="keyword">as</span> gpd</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"></span><br><span class="line">path=<span class="string">r&quot;G:\bankuai&quot;</span></span><br><span class="line">data=gpd.read_file(path+<span class="string">r&quot;\zonghe2.shp&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># visualizing the distribution of blocks in ChangSha </span></span><br><span class="line">data.plot()</span><br></pre></td></tr></table></figure><img src="/2023/11/13/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E5%9F%BA%E4%BA%8E%E6%94%B9%E8%BF%9B%E5%8C%BA%E5%9F%9F%E7%94%9F%E9%95%BF%E6%B3%95%E7%9A%84%E5%9F%8E%E5%B8%82%E6%96%91%E5%9D%97%E5%88%86%E7%B1%BB/Users/lenovo/Documents/tencent files/651421775/filerecv/基于区域生长的临近斑块分类方法/image-20231113175047820.png" alt="image-20231113175047820" style="zoom:50%;"><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># exploratory data analysis</span></span><br><span class="line">D=copy.deepcopy(data)</span><br><span class="line">data.shape</span><br><span class="line"><span class="comment"># (3700, 14)</span></span><br><span class="line">data.head(<span class="number">5</span>)</span><br></pre></td></tr></table></figure><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>OBJECTID</th>      <th>lb</th>      <th>Shape_Leng</th>      <th>Shape_Area</th>      <th>idd</th>      <th>OBJECTID_1</th>      <th>idd_1</th>      <th>COUNT</th>      <th>AREA</th>      <th>MEAN</th>      <th>MEAN_1</th>      <th>MEAN_12</th>      <th>MEAN_12_13</th>      <th>geometry</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>1</td>      <td>0</td>      <td>462.698517</td>      <td>7842.037150</td>      <td>1</td>      <td>1</td>      <td>1</td>      <td>634</td>      <td>10138.566790</td>      <td>4.885384</td>      <td>419.828282</td>      <td>583860.130028</td>      <td>1.097882e+06</td>      <td>POLYGON Z ((694423.228 3118300.460 0.000, 6943...</td>    </tr>    <tr>      <th>1</th>      <td>2</td>      <td>0</td>      <td>1693.463425</td>      <td>115652.876853</td>      <td>2</td>      <td>2</td>      <td>2</td>      <td>9333</td>      <td>149248.018695</td>      <td>2.210137</td>      <td>49.167335</td>      <td>177414.284438</td>      <td>7.246673e+05</td>      <td>POLYGON Z ((698632.417 3106524.626 0.000, 6987...</td>    </tr>    <tr>      <th>2</th>      <td>3</td>      <td>11</td>      <td>1100.566517</td>      <td>76822.340277</td>      <td>3</td>      <td>3</td>      <td>3</td>      <td>6191</td>      <td>99002.944792</td>      <td>2.194382</td>      <td>55.816331</td>      <td>83970.746248</td>      <td>6.581549e+05</td>      <td>POLYGON Z ((698213.537 3106892.204 0.000, 6981...</td>    </tr>    <tr>      <th>3</th>      <td>4</td>      <td>0</td>      <td>813.027834</td>      <td>33316.074792</td>      <td>4</td>      <td>4</td>      <td>4</td>      <td>2683</td>      <td>42905.007410</td>      <td>3.220493</td>      <td>60.284221</td>      <td>138651.257203</td>      <td>7.675609e+05</td>      <td>POLYGON Z ((700789.640 3106976.923 0.000, 7006...</td>    </tr>    <tr>      <th>4</th>      <td>5</td>      <td>0</td>      <td>931.012175</td>      <td>54895.664372</td>      <td>5</td>      <td>5</td>      <td>5</td>      <td>4426</td>      <td>70778.070368</td>      <td>1.702563</td>      <td>34.498813</td>      <td>145172.013136</td>      <td>7.156062e+05</td>      <td>POLYGON Z ((699126.327 3107255.440 0.000, 6989...</td>    </tr>  </tbody></table><p>这些Mean由城市开敞度、绿度、人口密度等属性构成。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">data[<span class="string">&#x27;class&#x27;</span>]=[<span class="number">0</span> <span class="keyword">if</span> data.iloc[i][<span class="string">&#x27;lb&#x27;</span>]!=<span class="number">0</span>  <span class="keyword">else</span> <span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(data.shape[<span class="number">0</span>])] <span class="comment"># assign the type according to the lb attribute. </span></span><br><span class="line"><span class="comment"># lb!=0 means inefficient land-use block</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># create buffer</span></span><br><span class="line">data[<span class="string">&quot;geometry&quot;</span>]=data.buffer(<span class="number">1200</span>)</span><br><span class="line">data[<span class="string">&#x27;geometry&#x27;</span>].plot()</span><br></pre></td></tr></table></figure><img src="/2023/11/13/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E5%9F%BA%E4%BA%8E%E6%94%B9%E8%BF%9B%E5%8C%BA%E5%9F%9F%E7%94%9F%E9%95%BF%E6%B3%95%E7%9A%84%E5%9F%8E%E5%B8%82%E6%96%91%E5%9D%97%E5%88%86%E7%B1%BB/Users/lenovo/Documents/tencent files/651421775/filerecv/基于区域生长的临近斑块分类方法/image-20231113180646064.png" alt="image-20231113180646064" style="zoom:50%;"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># construct the adjacency list between two types.</span></span><br><span class="line">Df=collections.defaultdict(<span class="built_in">list</span>)</span><br><span class="line">A=data[data[<span class="string">&#x27;class&#x27;</span>]==<span class="number">0</span>] <span class="comment"># inefficient</span></span><br><span class="line">B=copy.deepcopy(data) </span><br><span class="line">isConsidered=collections.defaultdict(<span class="built_in">list</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(B.shape[<span class="number">0</span>]):</span><br><span class="line">    <span class="comment"># isConsidered：[Is it used?the closest object]</span></span><br><span class="line">    isConsidered[B.iloc[i].OBJECTID]=[<span class="literal">False</span>,B.iloc[i].OBJECTID]</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="comment"># Determining adjacency</span></span><br><span class="line"><span class="keyword">import</span> alive_progress</span><br><span class="line">Df=collections.defaultdict(<span class="built_in">list</span>)</span><br><span class="line">InvertDf=collections.defaultdict(<span class="built_in">list</span>)</span><br><span class="line"><span class="keyword">with</span> alive_progress.alive_bar(A.shape[<span class="number">0</span>],force_tty=<span class="literal">True</span>) <span class="keyword">as</span> bar:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(A.shape[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(B.shape[<span class="number">0</span>]):</span><br><span class="line">            <span class="keyword">if</span>  (c:=A.iloc[i])[<span class="string">&quot;geometry&quot;</span>].intersects((v:=B.iloc[j]).geometry):</span><br><span class="line">                Df[c.OBJECTID].append(v.OBJECTID)</span><br><span class="line">                InvertDf[v.OBJECTID].append(c.OBJECTID)</span><br><span class="line">        bar()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="4-2-特征向量构建">4.2  特征向量构建</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Using Entropy Weight Method</span></span><br><span class="line"><span class="comment"># By the way, perhaps Coefficient of Variation Method is better</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">EWM</span>(<span class="params">data</span>):</span><br><span class="line">    t=(data-data.<span class="built_in">min</span>(axis=<span class="number">0</span>))/(data.<span class="built_in">max</span>(axis=<span class="number">0</span>)-data.<span class="built_in">min</span>(axis=<span class="number">0</span>))</span><br><span class="line">    rt=t</span><br><span class="line">    t=t/t.<span class="built_in">sum</span>(axis=<span class="number">0</span>)</span><br><span class="line">    t[t&lt;<span class="number">0.0001</span>]=<span class="number">0.0001</span></span><br><span class="line">    entropy=-<span class="number">1</span>/np.log(t.shape[<span class="number">0</span>])*np.<span class="built_in">sum</span>(t*np.log(t))</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span>(entropy)!=<span class="built_in">list</span>:</span><br><span class="line">        entropy=[entropy]</span><br><span class="line">    <span class="keyword">return</span> [(<span class="number">1</span>-i)/(<span class="built_in">len</span>(entropy)-<span class="built_in">sum</span>(entropy)) <span class="keyword">for</span> i <span class="keyword">in</span> entropy],rt</span><br><span class="line"></span><br><span class="line">EWMD=data[[<span class="string">&#x27;MEAN&#x27;</span>,<span class="string">&quot;MEAN_1&quot;</span>,<span class="string">&quot;MEAN_12&quot;</span>,<span class="string">&quot;MEAN_12_13&quot;</span>]]</span><br><span class="line"></span><br><span class="line">features=EWM(EWMD)</span><br><span class="line"></span><br><span class="line"><span class="comment"># constructing feature vectors</span></span><br><span class="line">s=s=features[<span class="number">1</span>]*features[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">nf=pd.DataFrame(s)</span><br><span class="line">nf[<span class="string">&#x27;oid&#x27;</span>]=data[<span class="string">&#x27;idd&#x27;</span>]</span><br><span class="line">nf</span><br></pre></td></tr></table></figure><img src="/2023/11/13/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E5%9F%BA%E4%BA%8E%E6%94%B9%E8%BF%9B%E5%8C%BA%E5%9F%9F%E7%94%9F%E9%95%BF%E6%B3%95%E7%9A%84%E5%9F%8E%E5%B8%82%E6%96%91%E5%9D%97%E5%88%86%E7%B1%BB/Users/lenovo/Documents/tencent files/651421775/filerecv/基于区域生长的临近斑块分类方法/image-20231113181549060.png" alt="image-20231113181549060" style="zoom:50%;"><h3 id="4-3-相似度计算">4.3  相似度计算</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Using cosine similarity</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sim</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="keyword">return</span> np.dot(x,y)/(np.linalg.norm(x)*np.linalg.norm(y)+<span class="number">1e-6</span>)</span><br></pre></td></tr></table></figure><p>如果不考虑空间异质性和时空同现什么的，也许并查集会是一个更高效的数据结构。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">us</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,n</span>):</span><br><span class="line">        self.n=n</span><br><span class="line">        self.init()</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">self,x</span>):</span><br><span class="line">        <span class="keyword">if</span> self.parents[x]!=x:self.parents[x]=self.find(self.parents[x])</span><br><span class="line">        <span class="keyword">return</span> self.parents[x]</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">union</span>(<span class="params">self,a,b</span>):</span><br><span class="line">        <span class="keyword">if</span> (ra:=self.find(a))!=(rb:=self.find(b)):</span><br><span class="line">            self.parents[ra]=rb</span><br><span class="line">            self.areas[rb]+=self.areas[ra]</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">init</span>(<span class="params">self</span>):</span><br><span class="line">        self.parents=<span class="built_in">dict</span>(<span class="built_in">zip</span>((v:=[self.n.iloc[i].OBJECTID <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.n.shape[<span class="number">0</span>])]),v))</span><br><span class="line">        self.areas=<span class="built_in">dict</span>(<span class="built_in">zip</span>(v,[self.n.iloc[i].Shape_Area <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.n.shape[<span class="number">0</span>])]))</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getArea</span>(<span class="params">self,x</span>):</span><br><span class="line">        <span class="keyword">return</span> self.areas[x]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">InitUS</span>(<span class="params">epsilon=<span class="number">0.9999</span></span>):</span><br><span class="line">    u=us(A)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(A.shape[<span class="number">0</span>]):</span><br><span class="line">        idxI=A.iloc[i].OBJECTID</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,A.shape[<span class="number">0</span>]):</span><br><span class="line">            idxJ=A.iloc[j].OBJECTID</span><br><span class="line">            xi,xj=nf[nf[<span class="string">&#x27;oid&#x27;</span>]==idxI].values.reshape(-<span class="number">1</span>)[:-<span class="number">1</span>],nf[nf[<span class="string">&#x27;oid&#x27;</span>]==idxJ].values.reshape(-<span class="number">1</span>)[:-<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> sim(xi,xj)&gt;=epsilon:</span><br><span class="line">                u.union(idxI,idxJ)</span><br><span class="line">    <span class="keyword">return</span> u</span><br><span class="line">    </span><br><span class="line">u=InitUS() </span><br></pre></td></tr></table></figure><p>很可惜，如果想要考虑空间衰减，并查集需要做一些改进。这里处于时间关系，就直接使用邻接表进行了。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Iterate over InvertDf to determine the similarity of the source points</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SourceSim</span>(<span class="params">T:<span class="built_in">list</span>,epsilon=<span class="number">0.9</span></span>):</span><br><span class="line">    s=A[A[<span class="string">&#x27;OBJECTID&#x27;</span>]==T[<span class="number">0</span>]][<span class="string">&#x27;Shape_Area&#x27;</span>].values[<span class="number">0</span>]</span><br><span class="line">    R=[T[<span class="number">0</span>]]</span><br><span class="line">    <span class="keyword">if</span> (v:=<span class="built_in">len</span>(T))==<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> s,R</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(v):</span><br><span class="line">      </span><br><span class="line">        ts=A[A[<span class="string">&#x27;OBJECTID&#x27;</span>]==T[n]][<span class="string">&#x27;Shape_Area&#x27;</span>].values[<span class="number">0</span>]</span><br><span class="line">        record=[T[n]] </span><br><span class="line">        <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(n+<span class="number">1</span>,v):</span><br><span class="line">            xn,xm=nf[nf[<span class="string">&#x27;oid&#x27;</span>]==T[n]].values.reshape(-<span class="number">1</span>)[:-<span class="number">1</span>],nf[nf[<span class="string">&#x27;oid&#x27;</span>]==T[m]].values.reshape(-<span class="number">1</span>)[:-<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> sim(xn,xm)&gt;=epsilon:</span><br><span class="line">                ts+=A[A[<span class="string">&#x27;OBJECTID&#x27;</span>]==T[m]][<span class="string">&#x27;Shape_Area&#x27;</span>].values[<span class="number">0</span>]</span><br><span class="line">            record.append(T[m])</span><br><span class="line">        <span class="keyword">if</span> s&lt;ts:</span><br><span class="line">            s=ts</span><br><span class="line">            R=record</span><br><span class="line">    <span class="keyword">return</span> s,R</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">bone_area_withInvert</span>(<span class="params">alpha,isConsidered</span>):</span><br><span class="line">    ic=copy.deepcopy(isConsidered)</span><br><span class="line">    newDf=copy.deepcopy(Df)</span><br><span class="line">    <span class="keyword">with</span> alive_progress.alive_bar(<span class="built_in">len</span>(newDf),force_tty=<span class="literal">True</span>) <span class="keyword">as</span> bar:</span><br><span class="line">        <span class="keyword">for</span> i,j <span class="keyword">in</span> newDf.items():</span><br><span class="line">            x=nf[nf[<span class="string">&#x27;oid&#x27;</span>]==i].values.reshape(-<span class="number">1</span>)[:-<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> j:</span><br><span class="line">                y=nf[nf[<span class="string">&#x27;oid&#x27;</span>]==_].values.reshape(-<span class="number">1</span>)[:-<span class="number">1</span>]</span><br><span class="line">                <span class="keyword">if</span> ic[_][<span class="number">0</span>]:<span class="keyword">continue</span></span><br><span class="line">                S_y=B[B[<span class="string">&#x27;OBJECTID&#x27;</span>]==_][<span class="string">&#x27;Shape_Area&#x27;</span>].values[<span class="number">0</span>]</span><br><span class="line">                S_x,records=SourceSim(InvertDf[_],<span class="number">0.7</span>)</span><br><span class="line">                epsilon=<span class="number">0.5</span> <span class="keyword">if</span> S_y&lt;=(<span class="number">0.5</span>*S_x) <span class="keyword">else</span> <span class="number">1</span>/(<span class="number">1</span>+np.exp(-alpha*(S_y/S_x)))</span><br><span class="line">                s=sim(x,y)</span><br><span class="line">                <span class="keyword">for</span> k <span class="keyword">in</span> records:</span><br><span class="line">                    <span class="keyword">if</span> (S:=sim(nf[nf[<span class="string">&#x27;oid&#x27;</span>]==k].values.reshape(-<span class="number">1</span>)[:-<span class="number">1</span>],y))&gt;=epsilon <span class="keyword">and</span> S&gt;=s:</span><br><span class="line"></span><br><span class="line">                        ic[_][<span class="number">0</span>]=<span class="literal">True</span></span><br><span class="line">                        ic[_][<span class="number">1</span>]=k</span><br><span class="line">            bar()</span><br><span class="line">                        </span><br><span class="line">    <span class="keyword">return</span> ic</span><br></pre></td></tr></table></figure><p>![image-20231113182027541](C:/Users/lenovo/Documents/tencent files/651421775/filerecv/基于区域生长的临近斑块分类方法/image-20231113182027541.png)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Assign attributes</span></span><br><span class="line">data[<span class="string">&#x27;IsUpdate&#x27;</span>]=[<span class="literal">False</span> <span class="keyword">if</span> ((v:=data.iloc[i])[<span class="string">&#x27;class&#x27;</span>]==<span class="number">0</span> <span class="keyword">or</span> IC[v.OBJECTID][<span class="number">0</span>]==<span class="literal">False</span>) <span class="keyword">else</span> <span class="literal">True</span>  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(data.shape[<span class="number">0</span>])]</span><br><span class="line">data[<span class="string">&#x27;Source&#x27;</span>]=[data.iloc[i].OBJECTID <span class="keyword">if</span> (v:=data.iloc[i])[<span class="string">&quot;class&quot;</span>]==<span class="number">0</span> <span class="keyword">else</span> IC[v.OBJECTID][<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(data.shape[<span class="number">0</span>])]</span><br><span class="line">data[<span class="string">&#x27;Final&#x27;</span>]=[<span class="number">0</span> <span class="keyword">if</span> (data.iloc[i][<span class="string">&#x27;class&#x27;</span>]==<span class="number">0</span> <span class="keyword">or</span> data.iloc[i][<span class="string">&#x27;IsUpdate&#x27;</span>]) <span class="keyword">else</span> <span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(data.shape[<span class="number">0</span>])]</span><br><span class="line"></span><br><span class="line"><span class="comment"># undo buffer</span></span><br><span class="line">data.geometry=D.geometry</span><br><span class="line"></span><br><span class="line"><span class="comment"># save</span></span><br><span class="line">data.to_file(path+<span class="string">r&quot;\\Recluster_with4features_.shp&quot;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="五、结果展示">五、结果展示</h2><img src="/2023/11/13/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E5%9F%BA%E4%BA%8E%E6%94%B9%E8%BF%9B%E5%8C%BA%E5%9F%9F%E7%94%9F%E9%95%BF%E6%B3%95%E7%9A%84%E5%9F%8E%E5%B8%82%E6%96%91%E5%9D%97%E5%88%86%E7%B1%BB/image-20231113182610738.png" alt="image-20231113182610738" style="zoom:50%;"><img src="/2023/11/13/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E5%9F%BA%E4%BA%8E%E6%94%B9%E8%BF%9B%E5%8C%BA%E5%9F%9F%E7%94%9F%E9%95%BF%E6%B3%95%E7%9A%84%E5%9F%8E%E5%B8%82%E6%96%91%E5%9D%97%E5%88%86%E7%B1%BB/image-20231113182730196.png" alt="image-20231113182730196" style="zoom:50%;"><h3 id="分类结果">分类结果</h3><img src="/2023/11/13/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E5%9F%BA%E4%BA%8E%E6%94%B9%E8%BF%9B%E5%8C%BA%E5%9F%9F%E7%94%9F%E9%95%BF%E6%B3%95%E7%9A%84%E5%9F%8E%E5%B8%82%E6%96%91%E5%9D%97%E5%88%86%E7%B1%BB/image-20231113182824258.png" alt="image-20231113182824258" style="zoom:50%;"><p>部分分类结果</p><img src="/2023/11/13/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E5%9F%BA%E4%BA%8E%E6%94%B9%E8%BF%9B%E5%8C%BA%E5%9F%9F%E7%94%9F%E9%95%BF%E6%B3%95%E7%9A%84%E5%9F%8E%E5%B8%82%E6%96%91%E5%9D%97%E5%88%86%E7%B1%BB/image-20231113182932028.png" alt="image-20231113182932028" style="zoom:50%;"><hr><h2 id="六、进一步工作">六、进一步工作</h2><p>接下来将抽取10%的重分类斑块由专家进行评估，获得是否需要重建、部分整改、全部整改的标签(A,B,C)</p><p>并基于机器学习方法，对剩下的90%的斑块进行计算</p><p>基于结构分析模型对其中的隐变量关系进行探究</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
    
    
    <summary type="html">姐姐的一个项目</summary>
    
    
    
    <category term="不想学辣" scheme="http://example.com/categories/%E4%B8%8D%E6%83%B3%E5%AD%A6%E8%BE%A3/"/>
    
    
    <category term="项目实践" scheme="http://example.com/tags/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5/"/>
    
  </entry>
  
  <entry>
    <title>Daily Vocabulary Review</title>
    <link href="http://example.com/2023/10/17/%E3%80%90English%E3%80%91Daily%20Words/"/>
    <id>http://example.com/2023/10/17/%E3%80%90English%E3%80%91Daily%20Words/</id>
    <published>2023-10-17T15:32:38.277Z</published>
    <updated>2023-10-17T17:16:59.205Z</updated>
    
    <content type="html"><![CDATA[<h2 id="20231017">20231017</h2><ul><li><code>suppose to do</code> 应该做</li><li><code>essentially</code>  本质上</li><li><code>swipe short videos</code>  刷短视频</li><li><code>aggravates</code>  恶化，加重</li><li><code>incapable</code>  无能为力的</li><li><code>desensitization</code>  脱敏</li><li><code>unproductive</code>  徒劳无功</li><li><code>nomadic</code>  游牧的，流浪的</li><li><code>cradle</code>  摇篮，发源地</li><li><code>discern</code>  看出，了解，识别，分清</li><li><code>tantalizing</code>  诱人的</li><li><code>connote</code> 意味着，暗示</li><li><code>tournament</code>  比赛，锦标赛</li><li><code>copious</code>  丰富的，富饶的</li><li><code>panorama</code>  全景，全貌，概述</li><li><code>decree</code>  法令，政令，判决</li><li><code>malice</code>  恶意，怨恨</li><li><code>parliament</code>  议会，国会</li></ul><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
    
    
    <summary type="html">Remember to review every day</summary>
    
    
    
    <category term="不想学辣" scheme="http://example.com/categories/%E4%B8%8D%E6%83%B3%E5%AD%A6%E8%BE%A3/"/>
    
    
    <category term="英语" scheme="http://example.com/tags/%E8%8B%B1%E8%AF%AD/"/>
    
  </entry>
  
  <entry>
    <title>梦</title>
    <link href="http://example.com/2023/10/12/%E3%80%90%E6%A2%A6%E3%80%91%E9%BB%84%E7%B2%B1%E4%B8%80%E6%A2%A6/"/>
    <id>http://example.com/2023/10/12/%E3%80%90%E6%A2%A6%E3%80%91%E9%BB%84%E7%B2%B1%E4%B8%80%E6%A2%A6/</id>
    <published>2023-10-12T13:54:19.697Z</published>
    <updated>2023-10-20T15:18:08.935Z</updated>
    
    <content type="html"><![CDATA[<p>我的故事，犹如大梦一场。</p><p>人生起起落落，曾几何时，有人在漆黑无尽的深渊中将我打捞起来。</p><p>再一次跌入寒冷，此时绝望更胜往日。</p><p>破开残云，震散阴霾，那无比熟悉的声音。</p><p>本来不再跳动的心，本来归于尘埃的心，再一次，强而有力的悸动。</p><hr><p>纵使千山万水，唯有心之所向。</p><p>无比渴望，无比热切，无比向往。</p><p>我从未有过信仰，像一叶扁舟般随波逐流。</p><p>直到卷入旋涡，卷入混乱，陷入自我否定，深感人生无意。</p><p>我也不想挣扎，任由破败侵蚀。</p><p>千疮百孔，丑陋不堪。</p><p>直到，那一束光穿透了躯壳和灵魂。</p><p>腐朽破碎的伤口，隐藏在漆黑之下的一抹鲜红。</p><hr><p>最开始，我忘了为什么而出发。</p><p>直到一种特殊的感觉笼罩全身。</p><p>我似乎将这一种感情归结于爱。</p><p>是爱吗？</p><p>还是找到了自我？</p><p>亦或者，那是信仰。</p><p>不管怎么说，我看到了曾经的自己。</p><p>为了掩盖自卑和懦弱，为了掩饰自己的散漫和不守纪律。</p><p>装作一副爱读书的好学生，作秀给其他人看的自己。</p><p>大学四年，我装的还算不错。</p><p>即使不需要怎么努力，我依旧能站在那里的顶点，自信渐渐来了，我也渐渐忘记了努力的样子，变得吃不了苦，静不下心，把一切问题归结于自己的身体，归结于社会环境，归结于原生家庭，归结于时也命也。</p><p>可是，面具总有被揭下的一天。</p><p>于是我害怕了。曾经的自卑再次占据了上风，我失去了自信，失去了自律的能力，失去了学习的能力，失去了我曾经引以为傲的一切。</p><p>今时不同往日，我正视了我。</p><p>我正视了我的无能，正视了我的情绪，正视了我的伪装。</p><p>枯木将死，却向阳而生。</p><p>好在一切还有机会，我还有时间，我还能扭转局面。</p><p>这一次，不再为了父母的要求，不再为了社会的流向，不再为了伪装自己的自卑。</p><p>为了我自己。</p><p>为了能与你并肩而行。</p><p>何为人生？就是一次又一次的超越自己，一次又一次的完成曾经口中的不可能。</p><p>如此，方才痛快！方才不枉活过一场！</p><hr><p>山巅与低谷。</p><p>二者都使我获益良多。</p><p>前者让我极尽辉煌，感受来自他人的谄媚和热情，享受机遇与资源天平的倾斜。</p><p>后者让我大梦方醒，体验人生百态，磨砺道心，不破不立，今日方知我是我。</p><p>于是，我出发了。</p><p>越接近那束光，我明悟的越多。</p><p>走出舒适圈，做没做过的事，率性而为，无欲无求。</p><p>不惧因果，大不了，尘归尘罢了。</p><p>这是破土而出的感觉，这是从未有过的真实。</p><p>本是随心随性，不求结局。</p><p>纵使山海相隔，时空相错。</p><p>我的道心纯粹，但并非无暇。</p><p>也曾被所谓的爱而误导，但这并不是爱，也不是为了所谓的爱。</p><p>问心，明己身。</p><hr><p>接近那一束光。</p><p>越是明亮耀眼，我身上的伤口愈合得越快。</p><p>我毫不忌讳地用行动表明我的心意。</p><p>尽管我不善言语。</p><p>也是，一年多的时间，自己将自己囚禁于狭小阴暗的空间内。</p><p>外头是持续不断的工地施工声，内头是无尽压力下的自耗。</p><p>我萌生了强烈的自我否定意识。</p><p>本就没有多少的时间，又被我一而再再而三的浪费。</p><p>还来得及吗？还来得及吗？</p><p>四月份，就应该要开始了。</p><p>而我现在却绝笔自退。</p><p>还来得及。</p><p>没有人在催我，没有人能催我，社会也不行。</p><p>我就是我，我能掌控自己的情绪，我能遵循自己的本心，我有资源，我不需要背负车房婚而成为上层人的奴隶。</p><p>我急什么？</p><p>生活本来就无意义，一次又一次的战胜自己，那才是我应追寻的乐趣。</p><p>现在还不能低头，以后也不能低头！</p><p>只要我踏出第一步，只要我把一切都推倒重来，只要我把习惯养成。</p><p>不破不立。</p><p>坠入深渊，低头已然触地，抬头明月可见。</p><hr><p>书接上回，我毫不忌讳地用行动表明我的心意。</p><p>就像一部充满曲折的电影，一本充满反转的小说。</p><p>我从未预想到。</p><p>尽可能避免情绪上的碰撞，尽可能规避一切因果。</p><p>本想着，送出来自灵隐寺的祝愿，送出生日当天的礼物和真挚道歉，陪着看一场歌剧。</p><p>三件事情，做完，前尘因果尽了。</p><p>之后便是我见天地，见众生和见自己的尘世闲游。</p><p>所以在十月七号，我极力避免第二天的约饭。</p><p>…但我还是赴约了。</p><p>我动心了。</p><p>但这也没关系，我早就动心了。</p><p>此是我之缘，亦是我之劫。</p><p>尚在我能处理的范畴中。</p><p>可是。</p><p>你动心了。</p><hr><p>荒诞的小说情节。</p><p>俗套到掉牙的小说情节。</p><p>一个失意的主人公，在行走世间的时候遇到了如太阳般明媚的心上人。</p><p>高贵如天仙般的少女，看上了一无所有的少年。</p><p>本来到这里，仅仅是俗套。</p><p>与传统的走向不同，少年和少女没有走到一起。</p><p>少女告诉少年，回去努力。</p><p>少年明白一切没有结局，相处的越是言笑晏晏你侬我侬，离别时的失落就越多撕心裂肺。</p><p>情绪的变化再次涌进少年的脑海里。</p><p>无力感，责任感，悲伤，自耗，以及深埋于心底的悸动。</p><p>至此，少年可以肯定了，最开始出现的情愫，是伪装成信仰的爱。</p><p>不同于以往的一切情感。</p><p>唯有爱，才能让人如痴如醉，而又患得患失。</p><p>最终，少年做了个决定。</p><p>他许下了一个承诺。</p><p>不是对着少女，而是对着他自己。</p><p>“我要给她一个未来，一个可以依靠的未来，无论以什么形式。”</p><p>从不轻许诺言。</p><p>因为承诺，哪怕赴汤蹈火，也要做到。</p><hr><p>本不该如此。</p><p>我成了剧中人，迷失了本心。</p><p>而她的行为向我证明了，是我想得太多了。</p><p>我想得太多了。</p><p>我对这段关系没有信心。</p><p>我对我自己没有信心。</p><p>怎能如此？</p><p>我的时间和精力，有一部分本就是为了你。</p><p>无需多言，山海抹不平我们之间的感情，时间也不行。</p><p>超越所谓的爱情和激情。</p><p>我现在应当无比笃定，遇见你是最正确的选择。</p><hr><p>奔赴心之所向，我并非无所图。</p><p>我想汲取阳光的温暖和能量。</p><p>我想借此机会锤炼自己。</p><p>但真的没想到。</p><p>故事的发展总有些意外。</p><p>紧紧握着的手，两颗心相拥在湘江水畔。</p><p>你依靠在我身上，听着我的心跳。</p><p>而我想的是，此情此景，终要离别。</p><p>最失意最无力的年纪，遇上了最想守护一生的人。</p><p>遇上了如此闪闪发光，更甚当年的星星。</p><p>暖风与我在此时缠绵，随后吹向远方。</p><p>我们的故事。</p><p>本以为封笔于三年前。</p><p>却泼墨在往后余生。</p><hr><blockquote><p>Wherever you go，whatever you do，I will be right here waiting for you.</p></blockquote><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
    
    
    <summary type="html">尘埃满面三千里，一笑相看似梦间</summary>
    
    
    
    <category term="梦时风月" scheme="http://example.com/categories/%E6%A2%A6%E6%97%B6%E9%A3%8E%E6%9C%88/"/>
    
    
    <category term="我" scheme="http://example.com/tags/%E6%88%91/"/>
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://example.com/2023/09/15/%E3%80%90ENVI%E3%80%91%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95/"/>
    <id>http://example.com/2023/09/15/%E3%80%90ENVI%E3%80%91%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95/</id>
    <published>2023-09-15T07:34:51.895Z</published>
    <updated>2023-09-15T07:35:05.935Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ENVI影像融合">ENVI影像融合</h3><p>加载高分辨率的全色影像与低分辨率的高光谱影像。</p><p><img src="/2023/09/15/%E3%80%90ENVI%E3%80%91%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95/image-20230915151332155.png" alt="image-20230915151332155"></p><p>如果两幅影像空间不一致，还需要进行地理配准：</p><p><img src="/2023/09/15/%E3%80%90ENVI%E3%80%91%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95/image-20230915151845770.png" alt="image-20230915151845770"></p><p>可以手动或自动添加控制点，完成影像配准。</p><p>在<code>Image Sharpening</code>里面选择不同类型的融合方式即可。</p><p><img src="/2023/09/15/%E3%80%90ENVI%E3%80%91%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95/image-20230915151712970.png" alt="image-20230915151712970"></p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ENVI影像融合&quot;&gt;ENVI影像融合&lt;/h3&gt;
&lt;p&gt;加载高分辨率的全色影像与低分辨率的高光谱影像。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2023/09/15/%E3%80%90ENVI%E3%80%91%E6%93%8D%E4%BD%9C%E8%AE%B0%E5</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>【优化算法】遗传算法</title>
    <link href="http://example.com/2023/08/26/%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95/"/>
    <id>http://example.com/2023/08/26/%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95/</id>
    <published>2023-08-25T17:07:03.775Z</published>
    <updated>2023-08-27T09:22:30.689Z</updated>
    
    <content type="html"><![CDATA[<h2 id="遗传算法">遗传算法</h2><p>遗传算法(Genetic Algorithm)属于智能优化算法的一种，本质上是模拟自然界中种群的演化来寻求问题的最优解。与之相似的还有模拟退火、粒子群、蚁群等算法。</p><p>在具体介绍遗传算法之前，我们先来了解一些知识🧀</p><blockquote><p>DNA： 携带有合成RNA和蛋白质所必需的遗传信息的生物大分子，是生物体发育和正常运作必不可少的生物大分子。一般情况下，是以双螺旋结构存在。</p></blockquote><p>现实中的DNA由碱基、脱氧核糖和磷酸双分子层组成，两条脱氧核苷酸链通过碱基间的氢键形成的碱基对相连，形成稳定的结构。碱基由四种，腺嘌呤，鸟嘌呤，胸腺嘧啶，胞嘧啶。</p><p>那么如何在计算机中对DNA进行编码？也不需要想的过于复杂，我们只需要表达每个位置上的碱基就行啦！譬如，一条DNA链可以写作：012332100123；每个数字对应一个碱基的映射。为了提高运行速度，我们将其以二进制的形式进行简化表达，即一条DNA链可以看做一串二进制文本：01011101010</p><blockquote><p>个体与种群</p></blockquote><p>我们将每条DNA链看做一个个体，实际上，也就是问题的一个解。譬如，我们寻找映射<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(X,Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span>的最优解，其中一个可能的值<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">X=6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">6</span></span></span></span>，便是一个个体。</p><p>种群就是个体的集合。注意，同一种群内部发生信息交换，不同种群之间不会发生信息交换。例如，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>的全集不会与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>的全集发生交换，DNA交换只会发生在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>集合或<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>集合内部。</p><blockquote><p>遗传： 生物的DNA来自于父母，一般情况下由父亲提供X或Y染色体，母亲提供X染色体</p></blockquote><p>假设现在有两个个体：</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1001</mn><mtext> </mtext><mn>0001</mn></mrow><annotation encoding="application/x-tex">1001\ 0001</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1001</span><span class="mspace"> </span><span class="mord">0001</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>00011001</mn></mrow><annotation encoding="application/x-tex">0001 1001</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">00011001</span></span></span></span> 分别作为父亲和母亲，生下了一个新的个体，那么该个体的DNA将由父亲和母亲来决定，例如前四位由父亲提供，后四位由母亲提供，那么该子代个体就是：</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1001</mn><mtext> </mtext><mn>1001</mn></mrow><annotation encoding="application/x-tex">1001\ 1001</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1001</span><span class="mspace"> </span><span class="mord">1001</span></span></span></span></p><blockquote><p>变异： 在DNA的某个位置发生了变化</p></blockquote><p>因为是二进制表达的DNA，那么所谓的变化就是某一位由0到1，或是由1到0</p><blockquote><p>自然选择： 优胜劣汰，将会选择更加适宜的个体</p></blockquote><p>个体的适宜度，实际上也就是满足函数最优解的值。适宜度越高，该个体在下一轮的自然选择中越容易存活，从而保留自身的DNA。</p><hr><p>下面我们将来说一下如何实现一个GA算法~</p><h3 id="一、创建属于我们的种群">一、创建属于我们的种群</h3><p>在一切的开始，我们为种群制定一个规则，比方说这个种群的大小，DNA链的长度~</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Population_Nums=<span class="number">200</span> <span class="comment"># 种群有200个个体</span></span><br><span class="line">DNA_Size=<span class="number">16</span> <span class="comment"># DNA链的长度</span></span><br><span class="line">Range=[[-<span class="number">3</span>,<span class="number">3</span>],[-<span class="number">3</span>,<span class="number">3</span>]] <span class="comment"># 自变量的值域范围</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np </span><br><span class="line"><span class="comment"># pop维度为(n,Population_Nums,DNA_Size)</span></span><br><span class="line"><span class="comment"># 其中n表示有几个种群，也就是自变量</span></span><br><span class="line">pop=np.random.randint(<span class="number">0</span>,<span class="number">2</span>,size=(<span class="built_in">len</span>(Range),Population_Nums,DNA_Size))</span><br></pre></td></tr></table></figure><p>种群的数量呢决定了收敛的速度，但是也有可能因此陷入局部最优解，并降低运行速度(注意跟收敛速度的区别)</p><p>DNA链的长度实际上决定了<code>精度</code>。这句话如何理解呢？我们要来看如何将一串DNA转译成我们需要的信息~</p><p>假设有一串DNA链：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10101</mn></mrow><annotation encoding="application/x-tex">10101</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10101</span></span></span></span>，我们的映射函数为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(X,Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>的值域为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><mn>5</mn><mo separator="true">,</mo><mn>5</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-5,5]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">5</span><span class="mclose">]</span></span></span></span>，想一想如何进行转译呢？</p><p>为了方便计算和模拟遗传变异，我们采用了二进制作为个体DNA。而我们想要的结果是十进制，那就需要先将二进制转为十进制！<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>∗</mo><msup><mn>2</mn><mn>4</mn></msup><mo>+</mo><mn>0</mn><mo>∗</mo><msup><mn>2</mn><mn>3</mn></msup><mo>+</mo><mn>1</mn><mo>∗</mo><msup><mn>2</mn><mn>2</mn></msup><mo>+</mo><mn>0</mn><mo>∗</mo><msup><mn>2</mn><mn>1</mn></msup><mo>+</mo><mn>1</mn><mo>∗</mo><msup><mn>2</mn><mn>0</mn></msup><mo>=</mo><mn>21</mn></mrow><annotation encoding="application/x-tex">1*2^{4}+0*2^3+1*2^2+0*2^1+1*2^0=21</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">21</span></span></span></span>，这样就来到了十进制。对于种群的基因，只需要除以一个最大值，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>11111</mn></mrow><annotation encoding="application/x-tex">11111</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">11111</span></span></span></span>，或者说<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>，就可以压缩到区间<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>，然后再通过区间匹配到实际值域区间中。</p><p>这段写成代码的话，可以是这样：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decoding</span>(<span class="params">pop</span>):</span><br><span class="line">    deList=[]</span><br><span class="line">    <span class="keyword">for</span> idx,i <span class="keyword">in</span> <span class="built_in">enumerate</span>(pop):</span><br><span class="line">        deList.append(i.dot(<span class="number">2</span>**np.arange(DNA_Size))/<span class="built_in">float</span>(<span class="number">2</span>**DNA_Size)*(Range[idx][<span class="number">1</span>]-Range[idx][<span class="number">0</span>])+Range[idx][<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> deList</span><br></pre></td></tr></table></figure><p>好啦，那么现在我们就需要评估一个个体的适宜度，这也是自然选择中最重要的部分。适宜度越大的个体，越容易在下一轮的选择中存活。</p><p>假设函数为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">F</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="number">3</span>*(<span class="number">1</span>-x)**<span class="number">2</span>*np.exp(-(x**<span class="number">2</span>)-(y+<span class="number">1</span>)**<span class="number">2</span>)-<span class="number">10</span>*(x/<span class="number">5</span>-x**<span class="number">3</span>-y**<span class="number">5</span>)*np.exp(-x**<span class="number">2</span>-y**<span class="number">2</span>)-<span class="number">1</span>/<span class="number">3</span>**np.exp(-(x+<span class="number">1</span>)**<span class="number">2</span>-y**<span class="number">2</span>)</span><br></pre></td></tr></table></figure><p>假设优化目标是求这个函数的极大值，那么我们的适宜度就应该是个体DNA转为十进制编码后，带入函数的结果，这个结果越大，说明适宜度越高。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">fitnetss</span>(<span class="params">pop</span>):</span><br><span class="line">    deList=decoding(pop)</span><br><span class="line">    pred=F(*deList)</span><br><span class="line">    <span class="keyword">return</span> (pred-pred.<span class="built_in">min</span>())+<span class="number">1e-3</span></span><br></pre></td></tr></table></figure><p>后面这个<code>1e-3</code>的实际含义是，让每一个个体都有机会，而不是绝对肯定或绝对否定哪个个体。</p><hr><h3 id="二、遗传和变异">二、遗传和变异</h3><p>在遗传部分，我们设置了一个参数，用来控制遗传发生的比例。毕竟有些个体并没有后代~</p><p>在变异部分，我们同样也有一个较小的参数，用来控制变异发生的可能性。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">mutation</span>(<span class="params">pop,rate=<span class="number">1e-3</span></span>):</span><br><span class="line">    <span class="comment"># 变异将随机发生</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> pop:</span><br><span class="line">        <span class="keyword">if</span> np.random.rand()&lt;rate:</span><br><span class="line">            <span class="comment"># 随机一个个体发生变异</span></span><br><span class="line">            i[np.random.randint(<span class="number">0</span>,DNA_Size)]^=<span class="number">1</span></span><br></pre></td></tr></table></figure><p>变异的作用是跳出局部最优解，下面是进行变异的三次结果：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(x,y):  -<span class="number">0.03668099860435703</span> <span class="number">1.499994903802568</span></span><br><span class="line">(x,y):  -<span class="number">0.013274610833800438</span> <span class="number">1.6933678801875045</span></span><br><span class="line">(x,y):  <span class="number">0.05119961805341333</span> <span class="number">1.4999723732455</span></span><br></pre></td></tr></table></figure><p>而下面是不进行变异的三次结果：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(x,y):  -<span class="number">0.027307929236169315</span> <span class="number">1.5981612562037268</span></span><br><span class="line">(x,y):  <span class="number">0.18948037561657305</span> <span class="number">1.4062327388663727</span></span><br><span class="line">(x,y):  -<span class="number">0.0962074456338553</span> <span class="number">1.4998157322296937</span></span><br></pre></td></tr></table></figure><p>可以发现，发生了变异后，结果稳定在[0,1.5]，而不是陷入部分最优解。</p><p>遗传过程的算法可以描述如下：</p><ul><li>遍历种群中的每个个体，并将该个体A作为父母个体</li><li>有一定概率该个体可以随机跟种群中的其他个体B发生基因交换（甚至包括它自己，但这对结果并没有影响，只是降低了遗传概率）</li><li>发生基因交换时，随机选择DNA的断点，断点前半部分由个体A提供，后半段由个体B提供</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">crossover</span>(<span class="params">pop,rate=<span class="number">0.7</span></span>):</span><br><span class="line">    <span class="comment"># 注意这里只与自身种群发生变化</span></span><br><span class="line">    new_pop=[]</span><br><span class="line">    <span class="keyword">for</span> idx <span class="keyword">in</span> pop.shape[<span class="number">0</span>]:</span><br><span class="line">        children=[]</span><br><span class="line">        <span class="keyword">for</span> father <span class="keyword">in</span> pop[idx]:</span><br><span class="line">            <span class="keyword">if</span> np.random.rand()&lt;rate:</span><br><span class="line">                child=father</span><br><span class="line">                mother=pop[idx][np.random.randn(<span class="number">0</span>,Population_Nums)]</span><br><span class="line">                <span class="comment"># 随机选择发生互换的碱基对</span></span><br><span class="line">                choicePoint=np.random.randn(<span class="number">0</span>,DNA_Size)</span><br><span class="line">                child[choicePoint:]=mother[choicePoint:]</span><br><span class="line">             <span class="comment"># 发生变异</span></span><br><span class="line">            children.append(mutation(child))</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">return</span> chidren</span><br></pre></td></tr></table></figure><hr><h3 id="三、自然选择">三、自然选择</h3><p>这部分将会根据个体的适宜度分配权值，决定该个体基因出现在下一轮概率。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">select</span>(<span class="params">pop,fitness</span>):</span><br><span class="line">    pop_s=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> pop:</span><br><span class="line">        pop_s.append(i[np.random.choice(np.array(Population_Nums),size=Population_Nums,replace=<span class="literal">True</span>,p=(fitness)/(fitness.<span class="built_in">sum</span>()))])</span><br><span class="line">    <span class="keyword">return</span> pop_s</span><br></pre></td></tr></table></figure><hr><h3 id="四、基于面向对象的遗传算法">四、基于面向对象的遗传算法</h3><p>现在，我们就要将这些东西封装成一个类啦，提高复用性和稳定性。</p><p>首先是构造函数，就是先写入一些常量。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">GA</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,popN=<span class="number">2000</span>,DNA_Size=<span class="number">16</span>,Epochs=<span class="number">500</span>,crossRate=<span class="number">0.8</span>,mutationRate=<span class="number">0.005</span></span>):</span><br><span class="line">        self.popN=popN <span class="comment"># 种群数量</span></span><br><span class="line">        self.DNA_Size=DNA_Size <span class="comment"># DNA长度</span></span><br><span class="line">        self.Epochs=Epochs <span class="comment"># 迭代次数</span></span><br><span class="line">        self.crossRate=crossRate <span class="comment"># 交叉遗传概率</span></span><br><span class="line">        self.mutationRate=mutationRate  <span class="comment"># 变异概率</span></span><br><span class="line">        self.Range=<span class="literal">None</span> <span class="comment"># 输入数据的值域</span></span><br><span class="line">        <span class="comment"># 例如：[[-3,3],[2,5],[1,9]] 这表示第一个变量的值域是[-3,3]，第二个是[2,5]</span></span><br><span class="line">        </span><br><span class="line">        self.plot_=[] <span class="comment"># 保留每轮的最优值</span></span><br><span class="line">        self.bestScore=<span class="literal">None</span> <span class="comment"># 最佳得分</span></span><br><span class="line">        self.best=<span class="literal">None</span> <span class="comment"># 最佳个体</span></span><br></pre></td></tr></table></figure><p>然后，需要提供一个输入函数的接口：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">fit_function</span>(<span class="params">self,f,<span class="built_in">range</span></span>):</span><br><span class="line">     self.f=f</span><br><span class="line">     self.Range=<span class="built_in">range</span></span><br><span class="line">     <span class="comment"># 初始化种群</span></span><br><span class="line">     self.pop=np.random.randint(<span class="number">0</span>,<span class="number">2</span>,size=(<span class="built_in">len</span>(<span class="built_in">range</span>),self.popN,self.DNA_Size))</span><br><span class="line">     self.plot_=[]</span><br></pre></td></tr></table></figure><p>解码方法：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decoding</span>(<span class="params">self</span>):</span><br><span class="line">     deList = []</span><br><span class="line">     <span class="keyword">for</span> idx, i <span class="keyword">in</span> <span class="built_in">enumerate</span>(self.pop):</span><br><span class="line">         deList.append(</span><br><span class="line">             i.dot(<span class="number">2</span> ** np.arange(self.DNA_Size)) / <span class="built_in">float</span>(<span class="number">2</span> ** self.DNA_Size) * (self.Range[idx][<span class="number">1</span>] - self.Range[idx][<span class="number">0</span>]) + self.Range[idx][</span><br><span class="line">                 <span class="number">0</span>])</span><br><span class="line">     <span class="keyword">return</span> deList</span><br></pre></td></tr></table></figure><p>适应值：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">fitness</span>(<span class="params">self</span>):</span><br><span class="line">    deList=self.decoding()</span><br><span class="line">    pred=self.f(*deList)</span><br><span class="line">    <span class="keyword">return</span> (pred-pred.<span class="built_in">min</span>())+<span class="number">1e-3</span></span><br></pre></td></tr></table></figure><p>变异：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">mutation</span>(<span class="params">self,pop</span>):</span><br><span class="line">    <span class="keyword">if</span> np.random.rand()&lt;self.mutationRate:</span><br><span class="line">        pop[np.random.randint(<span class="number">0</span>,self.DNA_Size)]^=<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> pop</span><br></pre></td></tr></table></figure><p>交叉遗传：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">crossover</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(self.pop.shape[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">for</span> _,father <span class="keyword">in</span> <span class="built_in">enumerate</span>(self.pop[idx]):</span><br><span class="line">            child = father</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> np.random.rand()&lt;self.crossRate:</span><br><span class="line">                mother=self.pop[idx][np.random.randint(<span class="number">0</span>,self.popN)]</span><br><span class="line">                crossPoint=np.random.randint(<span class="number">0</span>,self.DNA_Size)</span><br><span class="line">                child[crossPoint:]=mother[crossPoint:]</span><br><span class="line">                </span><br><span class="line">            self.pop[idx][_]=self.mutation(child)</span><br></pre></td></tr></table></figure><p>自然选择：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">select</span>(<span class="params">self,fitness</span>):</span><br><span class="line">    pops=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> self.pop:</span><br><span class="line">        pops.append(i[np.random.choice(self.popN,size=self.popN,replace=<span class="literal">True</span>,p=fitness/(fitness.<span class="built_in">sum</span>()))])</span><br><span class="line">    <span class="keyword">return</span> pops</span><br></pre></td></tr></table></figure><p>打印信息：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">getInfo</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;最优参数为： &#x27;</span>,[i <span class="keyword">for</span> i <span class="keyword">in</span> self.best])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;最优结果为: &quot;</span>,self.bestScore)</span><br></pre></td></tr></table></figure><p>提供一个训练接口和绘图接口供使用者调用：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">train</span>(<span class="params">self,plot=<span class="literal">False</span></span>):</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(self.Epochs):</span><br><span class="line">        self.crossover() <span class="comment"># 交叉变异</span></span><br><span class="line"></span><br><span class="line">        f=self.fitness() <span class="comment"># 计算适宜度</span></span><br><span class="line">                   </span><br><span class="line">        max_fit = np.argmax(f) <span class="comment"># 获取最大适宜度下标</span></span><br><span class="line">        k=[(i[max_fit].dot(<span class="number">2</span>**np.arange(self.DNA_Size))/<span class="built_in">float</span>(<span class="number">2</span>**self.DNA_Size))*(self.Range[idx][<span class="number">1</span>]-self.Range[idx][<span class="number">0</span>])+self.Range[idx][<span class="number">0</span>] <span class="keyword">for</span> idx,i <span class="keyword">in</span> <span class="built_in">enumerate</span>(self.pop)] <span class="comment"># 获取最佳个体的十进制值</span></span><br><span class="line">        bs=self.f(*k) <span class="comment"># 计算该值的适宜度</span></span><br><span class="line">        <span class="comment"># 请注意，适宜度并不代表函数结果，适宜度是一个相对的值</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 记录全局最优结果</span></span><br><span class="line">        <span class="keyword">if</span> self.bestScore==<span class="literal">None</span> <span class="keyword">or</span> bs&gt;self.bestScore:</span><br><span class="line">            self.bestScore=bs</span><br><span class="line">            self.best=k</span><br><span class="line">  </span><br><span class="line">self.pop = np.array(self.select(f)) <span class="comment"># 自然选择</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span> plot:</span><br><span class="line">            self.plot_.append(bs)</span><br><span class="line"></span><br><span class="line">    self.getInfo()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">plot</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="keyword">if</span> self.plot_==[]:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    plt.plot([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.Epochs)],self.plot_)</span><br><span class="line">    plt.xlabel(<span class="string">&quot;Epochs&quot;</span>)</span><br><span class="line">    plt.ylabel(<span class="string">&quot;BestValue&quot;</span>)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure><p>最终的结果如下：</p><img src="/2023/08/26/%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95/image-20230827172052205.png" alt="image-20230827172052205" style="zoom:50%;"><p>可以看到在25个Epoch左右就开始收敛了。</p><hr><h3 id="完整代码">完整代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GA</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,popN=<span class="number">2000</span>,DNA_Size=<span class="number">16</span>,Epochs=<span class="number">500</span>,crossRate=<span class="number">0.8</span>,mutationRate=<span class="number">0.005</span></span>):</span><br><span class="line">        self.popN=popN</span><br><span class="line">        self.DNA_Size=DNA_Size</span><br><span class="line">        self.Epochs=Epochs</span><br><span class="line">        self.crossRate=crossRate</span><br><span class="line">        self.mutationRate=mutationRate</span><br><span class="line">        self.Range=<span class="literal">None</span></span><br><span class="line">        self.plot_=[]</span><br><span class="line">        self.bestScore=<span class="literal">None</span></span><br><span class="line">        self.best=<span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">fit_function</span>(<span class="params">self,f,<span class="built_in">range</span></span>):</span><br><span class="line">        self.f=f</span><br><span class="line">        self.Range=<span class="built_in">range</span></span><br><span class="line">        self.pop=np.random.randint(<span class="number">0</span>,<span class="number">2</span>,size=(<span class="built_in">len</span>(<span class="built_in">range</span>),self.popN,self.DNA_Size))</span><br><span class="line">        self.plot_=[]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decoding</span>(<span class="params">self</span>):</span><br><span class="line">        deList = []</span><br><span class="line">        <span class="keyword">for</span> idx, i <span class="keyword">in</span> <span class="built_in">enumerate</span>(self.pop):</span><br><span class="line">            deList.append(</span><br><span class="line">                i.dot(<span class="number">2</span> ** np.arange(self.DNA_Size)) / <span class="built_in">float</span>(<span class="number">2</span> ** self.DNA_Size) * (self.Range[idx][<span class="number">1</span>] - self.Range[idx][<span class="number">0</span>]) + self.Range[idx][</span><br><span class="line">                    <span class="number">0</span>])</span><br><span class="line">        <span class="keyword">return</span> deList</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">fitness</span>(<span class="params">self</span>):</span><br><span class="line">        deList=self.decoding()</span><br><span class="line">        pred=self.f(*deList)</span><br><span class="line">        <span class="keyword">return</span> (pred-pred.<span class="built_in">min</span>())+<span class="number">1e-3</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mutation</span>(<span class="params">self,pop</span>):</span><br><span class="line">        <span class="keyword">if</span> np.random.rand()&lt;self.mutationRate:</span><br><span class="line">            pop[np.random.randint(<span class="number">0</span>,self.DNA_Size)]^=<span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> pop</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">crossover</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(self.pop.shape[<span class="number">0</span>]):</span><br><span class="line">            <span class="keyword">for</span> _,father <span class="keyword">in</span> <span class="built_in">enumerate</span>(self.pop[idx]):</span><br><span class="line">                child = father</span><br><span class="line">                <span class="keyword">if</span> np.random.rand()&lt;self.crossRate:</span><br><span class="line">                    mother=self.pop[idx][np.random.randint(<span class="number">0</span>,self.popN)]</span><br><span class="line">                    crossPoint=np.random.randint(<span class="number">0</span>,self.DNA_Size)</span><br><span class="line">                    child[crossPoint:]=mother[crossPoint:]</span><br><span class="line">                self.pop[idx][_]=self.mutation(child)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">select</span>(<span class="params">self,fitness</span>):</span><br><span class="line">        pops=[]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> self.pop:</span><br><span class="line">            pops.append(i[np.random.choice(self.popN,size=self.popN,replace=<span class="literal">True</span>,p=fitness/(fitness.<span class="built_in">sum</span>()))])</span><br><span class="line">        <span class="keyword">return</span> pops</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getInfo</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;最优参数为： &#x27;</span>,[i <span class="keyword">for</span> i <span class="keyword">in</span> self.best])</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;最优结果为: &quot;</span>,self.bestScore)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">train</span>(<span class="params">self,plot=<span class="literal">False</span></span>):</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(self.Epochs):</span><br><span class="line">            self.crossover()</span><br><span class="line"></span><br><span class="line">            f=self.fitness()</span><br><span class="line">            max_fit = np.argmax(f)</span><br><span class="line">            k=[(i[max_fit].dot(<span class="number">2</span>**np.arange(self.DNA_Size))/<span class="built_in">float</span>(<span class="number">2</span>**self.DNA_Size))*(self.Range[idx][<span class="number">1</span>]-self.Range[idx][<span class="number">0</span>])+self.Range[idx][<span class="number">0</span>] <span class="keyword">for</span> idx,i <span class="keyword">in</span> <span class="built_in">enumerate</span>(self.pop)]</span><br><span class="line">            bs=self.f(*k)</span><br><span class="line">            <span class="keyword">if</span> self.bestScore==<span class="literal">None</span> <span class="keyword">or</span> bs&gt;self.bestScore:</span><br><span class="line">                self.bestScore=bs</span><br><span class="line">                self.best=k</span><br><span class="line">            self.pop = np.array(self.select(f))</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> plot:</span><br><span class="line">                self.plot_.append(bs)</span><br><span class="line"></span><br><span class="line">        self.getInfo()</span><br><span class="line">        <span class="keyword">return</span> self.best</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">plot</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.plot_==[]:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        plt.plot([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.Epochs)],self.plot_)</span><br><span class="line">        plt.xlabel(<span class="string">&quot;Epochs&quot;</span>)</span><br><span class="line">        plt.ylabel(<span class="string">&quot;BestValue&quot;</span>)</span><br><span class="line">        plt.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    ga=GA(popN=<span class="number">200</span>,DNA_Size=<span class="number">16</span>,Epochs=<span class="number">200</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">F</span>(<span class="params">x, y</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3</span> * (<span class="number">1</span> - x) ** <span class="number">2</span> * np.exp(-(x ** <span class="number">2</span>) - (y + <span class="number">1</span>) ** <span class="number">2</span>) - <span class="number">10</span> * (x / <span class="number">5</span> - x ** <span class="number">3</span> - y ** <span class="number">5</span>) * np.exp(</span><br><span class="line">            -x ** <span class="number">2</span> - y ** <span class="number">2</span>) - <span class="number">1</span> / <span class="number">3</span> ** np.exp(-(x + <span class="number">1</span>) ** <span class="number">2</span> - y ** <span class="number">2</span>)</span><br><span class="line">    Range = [[-<span class="number">3</span>, <span class="number">3</span>], [-<span class="number">3</span>, <span class="number">3</span>]]</span><br><span class="line">    </span><br><span class="line">    ga.fit_function(F,Range)</span><br><span class="line">    ga.train(<span class="literal">True</span>)</span><br><span class="line">    ga.plot()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
    
    
    <summary type="html">可能陷入局部最优</summary>
    
    
    
    <category term="不想学辣" scheme="http://example.com/categories/%E4%B8%8D%E6%83%B3%E5%AD%A6%E8%BE%A3/"/>
    
    
    <category term="算法" scheme="http://example.com/tags/%E7%AE%97%E6%B3%95/"/>
    
    <category term="最优化" scheme="http://example.com/tags/%E6%9C%80%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>【赋权算法】熵权法</title>
    <link href="http://example.com/2023/08/24/%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E7%86%B5%E6%9D%83%E6%B3%95/"/>
    <id>http://example.com/2023/08/24/%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E7%86%B5%E6%9D%83%E6%B3%95/</id>
    <published>2023-08-24T09:18:28.852Z</published>
    <updated>2023-08-24T09:54:59.807Z</updated>
    
    <content type="html"><![CDATA[<p>在开始之前，我们先说一下信息熵的概念。</p><p>当一件事情发生，如果是意料之中，那么这个事情就并不能拿来当做茶余饭后的谈资，我们可以说这个事情并没有什么信息和价值。而当一件不可能发生的事情发生的时候，我们可能就会觉得震撼三观，这件事情太Crazy了，带来的信息量也就很多。</p><p>哼哼，通过上文我们可以知道，一个事情越稳定，信息量就越少，那么如何去衡量呢？我们可以用概率的倒数（也就是负相关）来衡量。</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>I</mi><mo>=</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">I=-log(p(x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span>也就是自信息，一件事情越确定，自信息也就越小。</p><p>而信息熵就是自信息的期望，代表这一件事情的<code>混乱程度</code>。信息熵越大，混乱程度越大，说明这件事情越疯狂。</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>H</mi><mo>=</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H=-log(p(x))p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></p><hr><p>再说熵权法(Entropy Weight Method)，熵权法是客观赋权的一种方式，对应的主观赋权有专家打分法，相似的还有层次分析法。熵权法是利用信息稳定程度而提出的方法，一般来说，某列属性越稳定，它的信息就越可信，那么在实际的权重也应当越高。</p><p>不说人话，那就是：</p><blockquote><p>一般来说，若某个指标的信息熵越小，表明指标值得变异程度越大，<strong>提供的信息量</strong>越多，在综合评价中所能起到的作用也越大，其权重也就越大。相反，某个指标的信息熵越大，表明指标值得变异程度越小，<strong>提供的信息量</strong>也越少，在综合评价中所起到的作用也越小，其权重也就越小。</p></blockquote><p>你会发现在这段话中，自信息和提供信息实际上是成反比的。</p><p>不管他，只需要知道原本越稳定的数据，对异常越敏感，也越可信。</p><p>在实际计算中，遵循以下步骤：</p><p><code>step1</code> 归一化</p><p><strong>正向指标</strong></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>X</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">Y_{ij}=\frac{X_{ij}-min(X_i)}{max(X_i)-min(X_i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">min</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">min</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><strong>负向指标</strong></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><msub><mi>X</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">Y_{ij}=\frac{max(X_i)-X_{ij}}{max(X_i)-min(X_i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">min</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><code>step2</code> 求频率替换概率</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><mo>∑</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">p_{ij}=\frac{Y_{ij}}{\sum Y_{ij}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3324em;vertical-align:-0.9721em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><code>step3</code> 计算归一化信息熵</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>E</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>y</mi><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mrow><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>∑</mo><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Entropy=-\frac{1}{ln(n)}\sum p_{ij}ln(p_{ij})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord mathnormal">ro</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2574em;vertical-align:-0.936em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-symbol large-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>以什么为底的不重要啦</p><p><code>step4</code> 计算权重</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>W</mi><mi>j</mi></msub><mo>=</mo><mfrac><mrow><mn>1</mn><mo>−</mo><msub><mi>E</mi><mi>j</mi></msub></mrow><mrow><mi>k</mi><mo>−</mo><mo>∑</mo><msub><mi>E</mi><mi>j</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">W_j=\frac{1-E_j}{k-\sum E_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3324em;vertical-align:-0.9721em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><hr><p>以下是实现代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">EWM</span>(<span class="params">data</span>):</span><br><span class="line">    t=(data-data.<span class="built_in">min</span>(axis=<span class="number">0</span>))/(data.<span class="built_in">max</span>(axis=<span class="number">0</span>)-data.<span class="built_in">min</span>(axis=<span class="number">0</span>))</span><br><span class="line">    t=t/t.<span class="built_in">sum</span>(axis=<span class="number">0</span>)</span><br><span class="line">    t[t&lt;<span class="number">0.0001</span>]=<span class="number">0.0001</span></span><br><span class="line">    entropy=-<span class="number">1</span>/np.log(t.shape[<span class="number">0</span>])*np.<span class="built_in">sum</span>(t*np.log(t))</span><br><span class="line">    <span class="keyword">return</span> [(<span class="number">1</span>-i)/(<span class="built_in">len</span>(entropy)-<span class="built_in">sum</span>(entropy)) <span class="keyword">for</span> i <span class="keyword">in</span> entropy]</span><br></pre></td></tr></table></figure><p>当然，这样的结果只是个权重，我们还需要对数据做乘法：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.matmul(data.values,np.array(EWM(data)).T)</span><br></pre></td></tr></table></figure><p><img src="/2023/08/24/%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E7%86%B5%E6%9D%83%E6%B3%95/image-20230824175234863.png" alt="image-20230824175234863"></p><p>对这样一组数据，A十分稳定，B是正态分布，C是二分布，得到的结果是：</p><p><strong>信息熵：</strong></p><p><img src="/2023/08/24/%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E7%86%B5%E6%9D%83%E6%B3%95/image-20230824175347424.png" alt="image-20230824175347424"></p><p><strong>权重：</strong></p><p><img src="/2023/08/24/%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E7%86%B5%E6%9D%83%E6%B3%95/image-20230824175405861.png" alt="image-20230824175405861"></p><hr><p>确实符合越稳定权重越大。</p><p><strong>熵权法的优点</strong></p><p>熵值法是根据各项指标指标值的变异程度来确定指标权数的，这是一种客观赋权法，避免了人为因素带来的偏差。</p><p>相对那些主观赋值法，精度较高客观性更强，能够更好的解释所得到的结果。</p><p><strong>熵权法的缺点</strong></p><p>**·**忽略了指标本身重要程度，有时确定的指标权数会与预期的结果相差甚远，同时熵值法不能减少评价指标的维数，也就是熵权法符合数学规律具有严格的数学意义，但往往会忽视决策者主观的意图；</p><p>**·**如果指标值的变动很小或者很突然地变大变小，熵权法用起来有局限</p><p><strong>熵权法的使用</strong></p><p>**·**一般指标个数最好小于对象个数，比较好；</p><p>**·**可用于任何评价问题中的确定指标权重；</p><p>**·**可用于剔除指标体系中对评价结果贡献不大的指标；</p><p>**·**可以用于任何需要确定权重的过程，也可以结合一些方法共同使用。</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
    
    
    <summary type="html">客观而非主观</summary>
    
    
    
    <category term="不想学辣" scheme="http://example.com/categories/%E4%B8%8D%E6%83%B3%E5%AD%A6%E8%BE%A3/"/>
    
    
    <category term="算法" scheme="http://example.com/tags/%E7%AE%97%E6%B3%95/"/>
    
    <category term="数学" scheme="http://example.com/tags/%E6%95%B0%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>【数据分析实践】斯里兰卡生态服务价值计算</title>
    <link href="http://example.com/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/"/>
    <id>http://example.com/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/</id>
    <published>2023-08-22T10:10:24.626Z</published>
    <updated>2023-08-22T14:22:03.241Z</updated>
    
    <content type="html"><![CDATA[<h1>斯里兰卡生态服务价值计算</h1><hr><h2 id="一、引言">一、引言</h2><p>生态系统服务价值是指人类<strong>间接</strong>或<strong>直接</strong>从生态系统各服务功能中获得的<strong>收益</strong>，对人类社会福祉起着极其重要的贡献。生态系统服务价值核算作为一项<strong>基础性研究工作</strong>，对生态安全格局的构建、生态补偿以及生态文明建设等研究有重要的参考价值，对促进人与自然和谐共生以及人类自己的可持续发展有重要意义(熊睿毅，2021)。</p><p>联合国生态评估组将生态系统服务分为四类：</p><ul><li>供给服务<ul><li>供给服务主要是提供人类生存生活所必须的物质资源，譬如食物、水资源、原材料等</li></ul></li><li>调节服务<ul><li>调节服务是指生态系统在发挥维持自我稳定和自我修复的特性时提供的服务，主要包括水文调节、气体调节、气候调节、净化环境等功能</li></ul></li><li>支持服务<ul><li>支持服务是指作为其他服务的基础，起到支持和维持作用的服务，譬如土壤保持、生物多样性保持和养分循环维持等</li></ul></li><li>文化服务<ul><li>文化服务是指为人类提供的满足人类文化兴趣和需求的服务，譬如灵感获取、宗教服务、精神价值、教育价值等，其最大的特点就是非消耗性，不受到消费而减少。</li></ul></li></ul><p>本文采用模拟市场法进行价值评估，细化方法为当量因子法，国内主流的是谢高地在Costanza的研究基础上进行改良后的适用于中国陆地生态系统的单位面积价值当量因子动态评估模型，其单位面积生态系统服务价值当量表如下：</p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230822160625301.png" alt="image-20230822160625301" style="zoom:50%;"><center>单位面积生态系统服务价值当量</center><p>生态系统服务价值量的计算公式如下：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>E</mi><mi>S</mi><mi>V</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mi>x</mi></munderover><msub><mi>A</mi><mi>m</mi></msub><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>y</mi></munderover><msub><mi>E</mi><mrow><mi>m</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">ESV=\sum_{m=1}^xA_m\sum_{n=1}^yE_{mn}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">ES</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9656em;vertical-align:-1.2671em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6985em;"><span style="top:-1.8829em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3471em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2671em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">mn</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>为第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>类生态系统，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>为第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>个服务功能，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">A_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为研究范围内第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>个生态系统的面积，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mrow><mi>m</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">E_{mn}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">mn</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>则是该服务功能的标准单位价值。</p><p>标准单位<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mi>S</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">ESV</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">ES</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span>当量因子的价值公式为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>V</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>7</mn><mo>×</mo><mi>P</mi><mo>×</mo><mi>Q</mi></mrow><annotation encoding="application/x-tex">V=1/7\times P\times Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/7</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span></span></p><p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>表示粮食均价，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span>表示粮食单产。</p><hr><h2 id="二、数据源">二、数据源</h2><p>土地覆盖数据来自于Esri公司的Sentinel-2 Land Cover Explorer产品，网址为：<a href="https://livingatlas.arcgis.com/landcoverexplorer/#mapCenter=-66.80083417615404%2C-9.321964396201427%2C11&amp;mode=step&amp;timeExtent=2017%2C2022&amp;year=2022%E3%80%82%E8%AF%A5%E4%BA%A7%E5%93%81%E6%8F%90%E4%BE%9B%E4%BA%86%E5%93%A8%E5%85%B5%E4%BA%8C%E5%8F%B7%E8%8E%B7%E5%8F%96%E7%9A%842017-2020%E5%B9%B410m%E5%88%86%E8%BE%A8%E7%8E%87%E7%9A%84%E5%85%A8%E7%90%83%E5%9C%9F%E5%9C%B0%E8%A6%86%E7%9B%96%E7%B1%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%EF%BC%8C%E4%B8%80%E5%85%B1%E6%9C%89%E4%B9%9D%E7%B1%BB%EF%BC%8C%E5%8C%85%E6%8B%AC%E6%B0%B4%E7%B3%BB%E3%80%81%E6%A3%AE%E6%9E%97%E3%80%81%E6%B9%BF%E5%9C%B0%E3%80%81%E8%80%95%E5%9C%B0%E3%80%81%E5%BB%BA%E7%AD%91%E7%94%A8%E5%9C%B0%E3%80%81%E8%A3%B8%E5%9C%B0%E3%80%81%E5%86%B0%E9%9B%AA%E3%80%81%E4%BA%91%E5%B1%82%E3%80%81%E8%8D%89%E7%94%B8%E3%80%82">https://livingatlas.arcgis.com/landcoverexplorer/#mapCenter=-66.80083417615404%2C-9.321964396201427%2C11&amp;mode=step&amp;timeExtent=2017%2C2022&amp;year=2022。该产品提供了哨兵二号获取的2017-2020年10m分辨率的全球土地覆盖类型数据，一共有九类，包括水系、森林、湿地、耕地、建筑用地、裸地、冰雪、云层、草甸。</a></p><p>行政区划数据来自于GADM官网，该数据集提供了全球所有国家及其下级行政区划的矢量边界和空间数据，网址为：<a href="https://gadm.org/index.html%E3%80%82%E5%80%BC%E5%BE%97%E6%B3%A8%E6%84%8F%E7%9A%84%EF%BC%8C%E8%BF%99%E9%87%8C%E7%9A%84%E4%B8%AD%E5%9B%BD%E6%95%B0%E6%8D%AE%E5%B9%B6%E6%B2%A1%E6%9C%89%E5%8F%B0%E6%B9%BE%E5%92%8C%E4%B9%9D%E6%AE%B5%E7%BA%BF%EF%BC%8C%E4%B8%8D%E5%BB%BA%E8%AE%AE%E5%9C%A8%E8%BF%99%E9%87%8C%E4%B8%8B%E8%BD%BD%E7%B2%BE%E7%A1%AE%E7%9A%84%E5%9B%BD%E5%AE%B6%E6%95%B0%E6%8D%AE%E3%80%82">https://gadm.org/index.html。值得注意的，这里的中国数据并没有台湾和九段线，不建议在这里下载精确的国家数据。</a></p><p>统计年鉴数据，包括主要农作物产量、单价，来自于国际粮农组织，官网为：<a href="https://www.fao.org/faostat/en/#data">https://www.fao.org/faostat/en/#data</a></p><hr><h2 id="三、数据处理">三、数据处理</h2><h3 id="3-1-数据预处理">3.1 数据预处理</h3><h4 id="3-1-1-土地覆盖类型数据处理">3.1.1 土地覆盖类型数据处理</h4><p>在Esri上下载的土地覆盖类型数据，每一年都有两幅图像，如下图所示，我们需要做的就是将其拼接起来，并通过斯里兰卡矢量边界进行裁剪。</p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230822163243616.png" alt="image-20230822163243616" style="zoom:33%;"><center>土地覆盖数据</center><p>其中，<code>镶嵌至新栅格</code>在工具箱中的位置如下：数据管理-&gt;栅格-&gt;栅格数据集-&gt;镶嵌至新栅格</p><p><code>裁剪</code>在工具箱中的位置如下：数据管理-&gt;栅格-&gt;栅格处理-&gt;裁剪</p><p>新建一个个人地理数据库，并将下载的<code>2017-2022</code>年数据处理好后保存到该数据库。</p><p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230822163636053.png" alt="image-20230822163636053"></p><center>工作数据库<p>裁剪完之后，数据分类值域会自动填充至[0,255]，这并不是我们想要的，因此，通过栅格计算器工具处理掉不需要的值。</p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230822163717282.png" alt="image-20230822163717282" style="zoom:50%;"><center>异常数据<p><code>栅格计算器</code>工具位于空间分析工具-&gt;地图代数-&gt;栅格计算器，计算表达式为：<code>Con(&quot;lc2021&quot;&gt;11,0,&quot;lc2021&quot;)</code>，该条件语句将大于11的值映射至0，而小于11的保持原状。</p><h4 id="3-1-2-产量、价格数据处理">3.1.2 产量、价格数据处理</h4><p>我们读取数据，并进行简单的统计量查看。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">path=<span class="string">r&quot;Path&quot;</span></span><br><span class="line">yield_=pd.read_csv(path+<span class="string">r&quot;\yield.csv&quot;</span>)</span><br><span class="line">pp_=pd.read_csv(path+<span class="string">r&quot;\Producer Prices.csv&quot;</span>)</span><br><span class="line">yield_.head()</span><br></pre></td></tr></table></figure><p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230818164633501.png" alt="image-20230818164633501"></p><center>产量数据<p>需要用到的属性只有<code>Item,Year,Unit,Value</code>,为了保证数据的时效性，我们只使用2000年以后的数据。因此需要对原始数据做时间和属性上的筛选。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">yield_=yield_[[<span class="string">&quot;Item&quot;</span>,<span class="string">&quot;Year&quot;</span>,<span class="string">&quot;Unit&quot;</span>,<span class="string">&quot;Value&quot;</span>]]</span><br><span class="line">yield_=yield_[yield_[<span class="string">&quot;Year&quot;</span>]&gt;<span class="number">2000</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对于价格数据同理</span></span><br><span class="line">pp_=pp_[[<span class="string">&quot;Item&quot;</span>,<span class="string">&quot;Year&quot;</span>,<span class="string">&quot;Value&quot;</span>,<span class="string">&quot;Element&quot;</span>]]</span><br><span class="line">pp_=pp_[pp_[<span class="string">&quot;Year&quot;</span>]&gt;<span class="number">2000</span>]</span><br></pre></td></tr></table></figure><p>实际上，在这个数据里，产量已经没有问题了。我们只需要做一个简单的处理：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yield_.groupby(<span class="string">&quot;Item&quot;</span>).mean()[<span class="string">&quot;Value&quot;</span>]/<span class="number">10</span> <span class="comment">#转为千克</span></span><br></pre></td></tr></table></figure><p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230818165519952.png" alt="image-20230818165519952"></p><center>平均产量<p>便可拿到每种作物近二十年的平均产量(单位：千克/公顷)。</p><hr><h3 id="3-2-基于LSTM的简单时间序列数据扩充">3.2 基于LSTM的简单时间序列数据扩充</h3><p>从世界粮农组织获得Sri Lanka主要农作物产量和价格数据时，其中的主要作物Sorghum仅有2001-2006年的数据，而Millet只有2001-2005,2020-2021这样的间断数据。虽然说可以直接剔除这种过分缺失的数据，但这无疑会对生态因子的计算造成重大影响。为了尽可能保证数据的稳定，我们采用循环神经网络来对数据进行拟合扩充。</p><h4 id="3-2-1-数据探查">3.2.1 数据探查</h4><p>在上一小节，我们读入了产量和价格数据。实际上，这个价格数据是有问题的。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pp_.tail(<span class="number">10</span>)</span><br></pre></td></tr></table></figure><p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230818165632557-1692693733911-14.png" alt="image-20230818165632557"></p><center>产量数据<p>高粱数据最新只到2006年。</p><h4 id="3-2-2-模型构建">3.2.2 模型构建</h4><p>在本小节，我们将比较传统一维CNN与RNN在结果上的异同。</p><p>一般做一维RNN时，可以指定一个<code>时间窗口</code>，比如用<code>2006,2007,2008</code>年的数据，推理<code>2009</code>年的数据，用<code>2007,2008,2009</code>年推理<code>2010</code>年。</p><p>我们现在要用之前处理好的<code>pp_c</code>数据中的玉米产量，来预测高粱产量。所以第一步就是将其转化为<code>torch</code>接受的格式。</p><p>别忘记导入模块：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> functional <span class="keyword">as</span> F</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x=pp_c[pp_c[<span class="string">&#x27;Item&#x27;</span>]==<span class="string">&quot;Maize (corn)&quot;</span>][<span class="string">&#x27;Value&#x27;</span>]</span><br><span class="line">x=torch.FloatTensor(x)</span><br></pre></td></tr></table></figure><p>之前写数据迭代器的时候，除了可以继承自<code>torch.utils.data.DataLoader</code>，也可以是任意的可迭代对象。这里我们可以简单的设置一个类：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置迭代器</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyDataSet</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,seq,ws=<span class="number">6</span></span>):</span><br><span class="line">        <span class="comment"># ws是滑动窗口大小</span></span><br><span class="line">        self.ori=[i <span class="keyword">for</span> i <span class="keyword">in</span> seq[:ws]]</span><br><span class="line">        self.label=[i <span class="keyword">for</span> i <span class="keyword">in</span> seq[ws:]]</span><br><span class="line">        self.reset()</span><br><span class="line">        self.ws=ws</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">set</span>(<span class="params">self,dpi</span>):</span><br><span class="line">        <span class="comment"># 添加数据</span></span><br><span class="line">        self.x.append(dpi)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">reset</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 初始化</span></span><br><span class="line">        self.x=self.ori[:]</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self,idx</span>):</span><br><span class="line">        <span class="keyword">return</span> self.x[idx:idx+self.ws],self.label[idx]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.x)</span><br></pre></td></tr></table></figure><p>在对数据按照时间窗口进行处理时，主要有两种方式，一种是用原始数据做预测，一种是用预测数据做预测。</p><p>假设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mo stretchy="false">[</mo><mi>a</mi><mn>1</mn><mo separator="true">,</mo><mi>a</mi><mn>2</mn><mo separator="true">,</mo><mi>a</mi><mn>3</mn><mo separator="true">,</mo><mi>a</mi><mn>4</mn><mo separator="true">,</mo><mi>a</mi><mn>5</mn><mo separator="true">,</mo><mi>a</mi><mn>6</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">A=[a1,a2,a3,a4,a5,a6]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">a</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">6</span><span class="mclose">]</span></span></span></span>，时间窗口大小为3。</p><p>用原始数据做预测，那么输入值为：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mn>1</mn><mo separator="true">,</mo><mi>a</mi><mn>2</mn><mo separator="true">,</mo><mi>a</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">a1,a2,a3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">3</span></span></span></span>，得到的结果将与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">a4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">a</span><span class="mord">4</span></span></span></span>做比较。下一轮输入为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mn>2</mn><mo separator="true">,</mo><mi>a</mi><mn>3</mn><mo separator="true">,</mo><mi>a</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">a2,a3,a4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">4</span></span></span></span>，得到的结果将与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mn>5</mn></mrow><annotation encoding="application/x-tex">a5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">a</span><span class="mord">5</span></span></span></span>做比较。</p><p>而用预测的数据做预测，第一轮输入值为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mn>1</mn><mo separator="true">,</mo><mi>a</mi><mn>2</mn><mo separator="true">,</mo><mi>a</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">a1,a2,a3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">3</span></span></span></span>，得到的结果是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">b4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span><span class="mord">4</span></span></span></span>，在与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">a4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">a</span><span class="mord">4</span></span></span></span>做比较后，下一轮的输入为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mn>2</mn><mo separator="true">,</mo><mi>a</mi><mn>3</mn><mo separator="true">,</mo><mi>b</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">a2,a3,b4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mord">4</span></span></span></span>，会出现如下情况：</p><p>输入数据为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mn>4</mn><mo separator="true">,</mo><mi>b</mi><mn>5</mn><mo separator="true">,</mo><mi>b</mi><mn>6</mn></mrow><annotation encoding="application/x-tex">b4,b5,b6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">b</span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mord">6</span></span></span></span>。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ws=<span class="number">6</span> <span class="comment"># 全局时间窗口</span></span><br><span class="line">train_data=MyDataSet(x,ws)</span><br></pre></td></tr></table></figure><p>网络的架构如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">   </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Net3</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,in_features=<span class="number">54</span>,n_hidden1=<span class="number">128</span>,n_hidden2=<span class="number">256</span>,n_hidden3=<span class="number">512</span>,out_features=<span class="number">7</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(Net3, self).__init__()</span><br><span class="line">        self.flatten=nn.Flatten()</span><br><span class="line">        self.hidden1=nn.Sequential(</span><br><span class="line">            nn.Linear(in_features,n_hidden1,<span class="literal">False</span>),</span><br><span class="line">           </span><br><span class="line">            nn.ReLU()</span><br><span class="line">        )</span><br><span class="line">        self.hidden2=nn.Sequential(</span><br><span class="line">            nn.Linear(n_hidden1,n_hidden2),</span><br><span class="line"></span><br><span class="line">            nn.ReLU()</span><br><span class="line">        )</span><br><span class="line">        self.hidden3=nn.Sequential(</span><br><span class="line">            nn.Linear(n_hidden2,n_hidden3),</span><br><span class="line"></span><br><span class="line">            nn.ReLU()</span><br><span class="line">        )</span><br><span class="line">        self.out=nn.Sequential(nn.Linear(n_hidden3,out_features))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,x</span>):</span><br><span class="line">        x=self.flatten(x)</span><br><span class="line">        x=self.hidden2(self.hidden1(x))</span><br><span class="line">        x=self.hidden3(x)</span><br><span class="line">        <span class="keyword">return</span> self.out(x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CNN</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, output_dim=<span class="number">1</span>,ws=<span class="number">6</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(CNN, self).__init__()</span><br><span class="line">        self.relu = nn.ReLU(inplace=<span class="literal">True</span>)</span><br><span class="line">        self.conv1 = nn.Conv1d(ws, <span class="number">64</span>, <span class="number">1</span>)</span><br><span class="line">        self.lr = nn.LeakyReLU(inplace=<span class="literal">True</span>)</span><br><span class="line">        self.conv2 = nn.Conv1d(<span class="number">64</span>, <span class="number">128</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        self.bn1, self.bn2 = nn.BatchNorm1d(<span class="number">64</span>), nn.BatchNorm1d(<span class="number">128</span>)</span><br><span class="line">        self.bn3, self.bn4 = nn.BatchNorm1d(<span class="number">1024</span>), nn.BatchNorm1d(<span class="number">128</span>)</span><br><span class="line">        self.flatten = nn.Flatten()</span><br><span class="line">        self.lstm1 = nn.LSTM(<span class="number">128</span>, <span class="number">1024</span>)</span><br><span class="line">        self.lstm2 = nn.LSTM(<span class="number">1024</span>, <span class="number">256</span>)</span><br><span class="line">        self.lstm3=nn.LSTM(<span class="number">256</span>,<span class="number">512</span>)</span><br><span class="line">        self.fc = nn.Linear(<span class="number">512</span>, <span class="number">512</span>)</span><br><span class="line">        self.fc4=nn.Linear(<span class="number">512</span>,<span class="number">256</span>)</span><br><span class="line">        self.fc1 = nn.Linear(<span class="number">256</span>, <span class="number">64</span>)</span><br><span class="line">        self.fc3 = nn.Linear(<span class="number">64</span>, output_dim)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">reS</span>(<span class="params">x</span>):</span><br><span class="line">        <span class="keyword">return</span> x.reshape(-<span class="number">1</span>, x.shape[-<span class="number">1</span>], x.shape[-<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        x = self.reS(x)</span><br><span class="line">        x = self.conv1(x) </span><br><span class="line">        x = self.lr(x)</span><br><span class="line"></span><br><span class="line">        x = self.conv2(x) </span><br><span class="line">        x = self.lr(x)</span><br><span class="line"></span><br><span class="line">        x = self.flatten(x)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># LSTM部分</span></span><br><span class="line">        x, h = self.lstm1(x)</span><br><span class="line">        x, h = self.lstm2(x)</span><br><span class="line">        x,h=self.lstm3(x)</span><br><span class="line">        x, _ = h</span><br><span class="line"></span><br><span class="line">        x = self.fc(x.reshape(-<span class="number">1</span>, ))</span><br><span class="line">        x = self.relu(x)</span><br><span class="line">        x = self.fc4(x)</span><br><span class="line">        x = self.relu(x)</span><br><span class="line">        x = self.fc1(x)</span><br><span class="line">        x = self.relu(x)</span><br><span class="line">        x = self.fc3(x)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>训练部分</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">Train</span>(<span class="params">model,train_data,seed=<span class="number">1</span></span>):</span><br><span class="line">    device=<span class="string">&quot;cuda&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span></span><br><span class="line">    model=model.to(device)</span><br><span class="line">    Mloss=<span class="number">100000</span></span><br><span class="line">    path=<span class="string">r&quot;YourPath\%s.pth&quot;</span>%seed</span><br><span class="line">    <span class="comment"># 设置损失函数,这里使用的是均方误差损失</span></span><br><span class="line">    criterion = nn.MSELoss()</span><br><span class="line">    <span class="comment"># 设置优化函数和学习率lr</span></span><br><span class="line">    optimizer=torch.optim.Adam(model.parameters(),lr=<span class="number">1e-5</span>,betas=(<span class="number">0.9</span>,<span class="number">0.99</span>),</span><br><span class="line">                               eps=<span class="number">1e-07</span>,weight_decay=<span class="number">0</span>)</span><br><span class="line">    <span class="comment"># 设置训练周期</span></span><br><span class="line">    epochs =<span class="number">3000</span></span><br><span class="line">    criterion=criterion.to(device)</span><br><span class="line">    model.train()</span><br><span class="line">    <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(epochs):</span><br><span class="line">        total_loss=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)-ws):</span><br><span class="line">            <span class="comment"># 每次更新参数前都梯度归零和初始化</span></span><br><span class="line">            seq,y_train=train_data.get(i) <span class="comment"># 从我们的数据集中拿出数据</span></span><br><span class="line">            seq,y_train=torch.FloatTensor(seq),torch.FloatTensor([y_train])</span><br><span class="line">            seq=seq.unsqueeze(dim=<span class="number">0</span>)</span><br><span class="line">            seq,y_train=seq.to(device),y_train.to(device)</span><br><span class="line"></span><br><span class="line">            optimizer.zero_grad()</span><br><span class="line">            <span class="comment"># 注意这里要对样本进行reshape，</span></span><br><span class="line">            <span class="comment"># 转换成conv1d的input size（batch size, channel, series length）</span></span><br><span class="line">            y_pred = model(seq)</span><br><span class="line">            loss = criterion(y_pred, y_train)</span><br><span class="line">            loss.backward()</span><br><span class="line">            train_data.<span class="built_in">set</span>(y_pred.to(<span class="string">&quot;cpu&quot;</span>).item()) <span class="comment"># 再放入预测数据</span></span><br><span class="line">            optimizer.step()</span><br><span class="line">            total_loss+=loss</span><br><span class="line"></span><br><span class="line">        train_data.reset()</span><br><span class="line">        <span class="keyword">if</span> total_loss.tolist()&lt;Mloss:</span><br><span class="line">            Mloss=total_loss.tolist()</span><br><span class="line">            torch.save(model.state_dict(),path)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Saving&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;Epoch: <span class="subst">&#123;epoch+<span class="number">1</span>:<span class="number">2</span>&#125;</span> Mean Loss: <span class="subst">&#123;total_loss.tolist()/<span class="built_in">len</span>(train_data):<span class="number">10.8</span>f&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> model</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d=CNN(ws=ws)</span><br><span class="line">Train(d,train_data,<span class="string">&quot;Net1&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230818173024746.png" alt="image-20230818173024746"></p><center>模型损失<p>平均损失在10点左右。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">checkpoint=torch.load(<span class="string">r&quot;YourPath\4.pth&quot;</span>)</span><br><span class="line">d.load_state_dict(checkpoint) <span class="comment"># 加载最佳参数</span></span><br><span class="line">d.to(<span class="string">&quot;cpu&quot;</span>)</span><br></pre></td></tr></table></figure><h4 id="3-2-3-结果可视化">3.2.3 结果可视化</h4><p>我们这里用到<code>Pyechart</code>进行可视化。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pyecharts.charts <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pyecharts <span class="keyword">import</span> options <span class="keyword">as</span> opts</span><br><span class="line"><span class="keyword">from</span> pyecharts.<span class="built_in">globals</span> <span class="keyword">import</span> CurrentConfig</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pre,ppre=[i.item() <span class="keyword">for</span> i <span class="keyword">in</span> x[:ws]],[]</span><br><span class="line"><span class="comment"># pre 是用原始数据做预测</span></span><br><span class="line"><span class="comment"># ppre 用预测数据做预测</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)-ws+<span class="number">1</span>):</span><br><span class="line">    ppre.append(d(torch.FloatTensor(x[i:i+ws]).unsqueeze(dim=<span class="number">0</span>)))</span><br><span class="line">    pre.append(d(torch.FloatTensor(pre[-ws:]).unsqueeze(dim=<span class="number">0</span>)).item())</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">l=Line()</span><br><span class="line">l.add_xaxis([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))])</span><br><span class="line">l.add_yaxis(<span class="string">&quot;Original Data&quot;</span>,x.tolist())</span><br><span class="line">l.add_yaxis(<span class="string">&quot;Pred Data(Using Raw Datas)&quot;</span>,x[:ws].tolist()+[i.item() <span class="keyword">for</span> i <span class="keyword">in</span> ppre])</span><br><span class="line">l.add_yaxis(<span class="string">&quot;Pred Data(Using Pred Datas)&quot;</span>,pre)</span><br><span class="line">l.set_series_opts(label_opts=opts.LabelOpts(is_show=<span class="literal">False</span>))</span><br><span class="line">l.set_global_opts(title_opts=opts.TitleOpts(title=<span class="string">&#x27;LSTM CNN&#x27;</span>))</span><br><span class="line"></span><br><span class="line">l.render_notebook()</span><br></pre></td></tr></table></figure><p>根据时间窗口的不同，可以得到不同的结果。</p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230818173641683.png" alt="image-20230818173641683" style="zoom:50%;"><center><b>窗口大小为4</b></center><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230818173542749.png" alt="image-20230818173542749" style="zoom:58%;"><center><b>窗口大小为5</b></center><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230818173724244.png" alt="image-20230818173724244" style="zoom:51%;"><center><b>窗口大小为6</b></center><p>从结果上来看，在一定范围内，时间窗口越大，损失误差越小。</p><p>至于验证，我们可以选<code>Rice</code>做验证：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">x=torch.FloatTensor(pp_c[pp_c[<span class="string">&#x27;Item&#x27;</span>]==<span class="string">&quot;Rice&quot;</span>][<span class="string">&#x27;Value&#x27;</span>].tolist())</span><br><span class="line">pre,ppre=[i.item() <span class="keyword">for</span> i <span class="keyword">in</span> x[:ws]],[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)-ws+<span class="number">1</span>):</span><br><span class="line">    ppre.append(d(torch.FloatTensor(x[i:i+ws]).unsqueeze(dim=<span class="number">0</span>)))</span><br><span class="line">    pre.append(d(torch.FloatTensor(pre[-ws:]).unsqueeze(dim=<span class="number">0</span>)).item())</span><br><span class="line">l=Line()</span><br><span class="line">l.add_xaxis([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))])</span><br><span class="line">l.add_yaxis(<span class="string">&quot;Original Data&quot;</span>,x.tolist())</span><br><span class="line">l.add_yaxis(<span class="string">&quot;Pred Data(Using Raw Datas)&quot;</span>,x[:ws].tolist()+[i.item() <span class="keyword">for</span> i <span class="keyword">in</span> ppre])</span><br><span class="line">l.add_yaxis(<span class="string">&quot;Pred Data(Using Pred Datas)&quot;</span>,pre)</span><br><span class="line">l.set_series_opts(label_opts=opts.LabelOpts(is_show=<span class="literal">False</span>))</span><br><span class="line">l.set_global_opts(title_opts=opts.TitleOpts(title=<span class="string">&#x27;LSTM CNN&#x27;</span>))</span><br><span class="line"></span><br><span class="line">l.render_notebook()</span><br></pre></td></tr></table></figure><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230818174046726.png" alt="image-20230818174046726" style="zoom:52%;"><center>基于Rice数据的验证结果<p>可以发现，用预测做预测的结果，基本上不会差太多，那也就意味着，我们可以对高粱进行预测。不过在这之前，我们可以看看用原始数据做训练的结果：</p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230818174214014.png" alt="image-20230818174214014" style="zoom:50%;"><center> 采用原始数据作训练的结果<p>时间窗口一样为6，可以看到在黑线贴合的非常好，但是面对大量缺失的数据，精度就远不如用预测数据做预测的结果了。</p><p>此外，这是用CNN做的结果</p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230818174436597.png" alt="image-20230818174436597" style="zoom:44%;"><center> CNN拟合结果<p>我们可以发现LSTM的波动要比CNN好，CNN后面死水一潭，应该是梯度消失导致的，前面信息没有了，后面信息又是自个构造的，这就导致了到后面变成了线性情况。</p><p>那么最后的最后，就是预测高粱产量了：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">pre_data=pp_c[pp_c[<span class="string">&#x27;Item&#x27;</span>]==<span class="string">&#x27;Sorghum&#x27;</span>][<span class="string">&#x27;Value&#x27;</span>].tolist()</span><br><span class="line">l=pre_data[:]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)-ws+<span class="number">1</span>):</span><br><span class="line">    l.append(d(torch.FloatTensor(l[-ws:]).unsqueeze(dim=<span class="number">0</span>)).item())</span><br><span class="line">L=Line()</span><br><span class="line">L.add_xaxis([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))])</span><br><span class="line">L.add_yaxis(<span class="string">&quot;Pred&quot;</span>,l)</span><br><span class="line">L.set_series_opts(label_opts=opts.LabelOpts(is_show=<span class="literal">False</span>))</span><br><span class="line">L.set_global_opts(title_opts=opts.TitleOpts(title=<span class="string">&#x27;sorghum production forecasts&#x27;</span>)</span><br><span class="line">                            </span><br><span class="line">                             )</span><br><span class="line"></span><br><span class="line">L.render_notebook()</span><br><span class="line">l.to_csv(<span class="string">&quot;path&quot;</span>)</span><br></pre></td></tr></table></figure><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230818174718747.png" alt="image-20230818174718747" style="zoom:52%;"><center> 高粱价格拟合曲线<p>将结果数据更新。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(x)-ws):</span><br><span class="line">pp_c=pp_c.append(&#123;<span class="string">&quot;Unnamed: 0&quot;</span>:<span class="number">91</span>+i,<span class="string">&quot;Year&quot;</span>:<span class="number">2006</span>+i,<span class="string">&quot;Value&quot;</span>:l[<span class="number">5</span>+i],<span class="string">&quot;Item&quot;</span>:<span class="string">&quot;Sorghum&quot;</span>,<span class="string">&#x27;Unit&#x27;</span>:<span class="string">&quot;卢比/kg&quot;</span>&#125;,ignore_index=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><hr><h3 id="3-3-斯里兰卡总ESV计算">3.3 斯里兰卡总ESV计算</h3><p>对于我们前面得到的数据，依据价值公式计算生态服务单位价值表。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">y=pd.read_excel(path+<span class="string">r&quot;\yield_final.xlsx&quot;</span>)</span><br><span class="line">p=pd.read_excel(path+<span class="string">r&quot;\Price_Mean.xls&quot;</span>)</span><br><span class="line"></span><br><span class="line">s=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> y[<span class="string">&quot;Item&quot;</span>].unique():</span><br><span class="line">    s+=y[y[<span class="string">&#x27;Item&#x27;</span>]==_][<span class="string">&#x27;Value&#x27;</span>].tolist()[<span class="number">0</span>]*p[p[<span class="string">&#x27;Item&#x27;</span>]==_][<span class="string">&quot;Price&quot;</span>].tolist()[<span class="number">0</span>]</span><br><span class="line">s/=<span class="number">4</span>*<span class="number">7</span></span><br></pre></td></tr></table></figure><p>可以得到这样一个因子：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s:<span class="number">16111.103594750322</span></span><br></pre></td></tr></table></figure><p>该因子表示每公顷的价值。接下来，我们读取生态系统服务价值表，该表根据本项目的类型做过修改。即：保留存在的类型，剔除不存在的类型，将森林因子记作针叶林、阔叶林、针阔混交林的平均值。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e=pd.read_excel(path+<span class="string">r&quot;/Esv_table.xls&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230822172406365.png" alt="image-20230822172406365"></p><center>改进标准价值当量<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> e.columns:</span><br><span class="line">    <span class="keyword">if</span> e[i].dtype ==np.float64:</span><br><span class="line">        e[i]=e[i]*<span class="number">16111</span> <span class="comment"># 不保留小数部分了</span></span><br></pre></td></tr></table></figure><p>于是，可以得到我们的最终结果表。</p><p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230822172555364.png" alt="image-20230822172555364"></p><center> 价值当量<p>将每年的土地覆盖属性表导出，接着将利用这些数据计算最终结果。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">path=<span class="string">r&quot;E:\Sri Lanka\attributeTable&quot;</span></span><br><span class="line"></span><br><span class="line">values=<span class="string">r&quot;E:\Sri Lanka\ESV_Pro.csv&quot;</span>  <span class="comment"># 这个就是上面那张表的导出</span></span><br><span class="line"></span><br><span class="line">mapTable=&#123;</span><br><span class="line">    <span class="number">1</span>:<span class="string">&quot;水系&quot;</span>,</span><br><span class="line">    <span class="number">2</span>:<span class="string">&quot;森林(针+针阔+阔叶)//3&quot;</span>,</span><br><span class="line">    <span class="number">4</span>:<span class="string">&quot;湿地&quot;</span>,</span><br><span class="line">    <span class="number">5</span>:<span class="string">&quot;耕地(旱地)&quot;</span>,</span><br><span class="line">    <span class="number">7</span>:<span class="string">&quot;城镇用地&quot;</span>,</span><br><span class="line">    <span class="number">8</span>:<span class="string">&quot;裸地&quot;</span>,</span><br><span class="line">    <span class="number">9</span>:<span class="string">&quot;冰川积雪&quot;</span>,</span><br><span class="line">    <span class="number">10</span>:<span class="string">&quot;云层&quot;</span>,</span><br><span class="line">    <span class="number">11</span>:<span class="string">&quot;草原&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">AT=[]</span><br><span class="line">tab=os.listdir(path)</span><br><span class="line">tables=[i <span class="keyword">for</span> i <span class="keyword">in</span> tab <span class="keyword">if</span> i.endswith(<span class="string">&quot;t.csv&quot;</span>)]</span><br><span class="line"><span class="comment"># [&#x27;2017t.csv&#x27;, &#x27;2018t.csv&#x27;, &#x27;2019t.csv&#x27;, &#x27;2020t.csv&#x27;, &#x27;2021t.csv&#x27;, &#x27;2022t.csv&#x27;]</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tables)):</span><br><span class="line">    newT=defaultdict(<span class="built_in">int</span>)</span><br><span class="line">    year=tables[i].split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    tb=pd.read_csv(os.path.join(path,tables[i]))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tb)):</span><br><span class="line">        <span class="keyword">if</span> (k:=mapTable[tb[<span class="string">&quot;Value&quot;</span>][i]]) <span class="keyword">in</span> v[<span class="string">&quot;Unnamed: 0&quot;</span>].unique():</span><br><span class="line">            _=tb[<span class="string">&#x27;Count&#x27;</span>][i]/<span class="number">100</span></span><br><span class="line">            <span class="keyword">for</span> n,g <span class="keyword">in</span> <span class="built_in">enumerate</span>(v.columns[<span class="number">2</span>:].tolist(),<span class="number">2</span>):</span><br><span class="line">                  <span class="comment"># 每一项都等于 每种类型的像元乘以该像元在该项之下的价值之和</span></span><br><span class="line">                newT[g]+=_/<span class="number">1e10</span>*v[v[<span class="string">&quot;Unnamed: 0&quot;</span>]==k].iloc[<span class="number">0</span>,n]</span><br><span class="line">    AT.append(newT)</span><br><span class="line">d=pd.DataFrame(AT,index=[<span class="string">&quot;%s&quot;</span>%i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2017</span>,<span class="number">2023</span>)])</span><br></pre></td></tr></table></figure><p>其结果如下：</p><p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230822173510089.png" alt="image-20230822173510089"></p><center> 分项ESV量表<p>其中，食物生产、原料生产、水资源供给属于<code>供给服务</code>，气体调节、气候调节、净化环境、水文调节属于<code>调节服务</code>，水土保持、养分循环、生物多样性属于<code>支持服务</code>，美学景观属于<code>文化服务</code>。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">newD=pd.DataFrame([],columns=[<span class="string">&quot;供给服务&quot;</span>,<span class="string">&quot;调节服务&quot;</span>,<span class="string">&quot;支持服务&quot;</span>,<span class="string">&quot;文化服务&quot;</span>])</span><br><span class="line">newD[<span class="string">&quot;供给服务&quot;</span>]=d.iloc[:,<span class="number">0</span>]+d.iloc[:,<span class="number">1</span>]+d.iloc[:,<span class="number">2</span>]</span><br><span class="line">x=d.iloc[:,<span class="number">3</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>,<span class="number">7</span>):</span><br><span class="line">    x+=d.iloc[:,i]</span><br><span class="line">newD[<span class="string">&quot;调节服务&quot;</span>]=x</span><br><span class="line">x=d.iloc[:,<span class="number">7</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>,<span class="number">10</span>):</span><br><span class="line">    x+=d.iloc[:,i]</span><br><span class="line">newD[<span class="string">&#x27;支持服务&#x27;</span>]=x</span><br><span class="line">newD[<span class="string">&#x27;文化服务&#x27;</span>]=d.iloc[:,-<span class="number">1</span>]</span><br></pre></td></tr></table></figure><p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230822173712909.png" alt="image-20230822173712909"></p><center>大类ESV量表<p>剩下的工作就是绘制图表了。</p><hr><h3 id="3-4-斯里兰卡行政县ESV变化情况">3.4 斯里兰卡行政县ESV变化情况</h3><p>在本部分中，我们将研究分析2017-2022年斯里兰卡各个行政县的ESV变化，并通过人为设置分级，对其总量进行量化。其计算公式如下：</p><table><thead><tr><th style="text-align:center">值(单位：10亿/卢比)</th><th style="text-align:center">级别</th></tr></thead><tbody><tr><td style="text-align:center">0-3</td><td style="text-align:center">低</td></tr><tr><td style="text-align:center">3-6</td><td style="text-align:center">较低</td></tr><tr><td style="text-align:center">6-9</td><td style="text-align:center">中等</td></tr><tr><td style="text-align:center">9-12</td><td style="text-align:center">较高</td></tr><tr><td style="text-align:center">&gt;12</td><td style="text-align:center">高</td></tr></tbody></table><p>为了能够实现按照各个省份分级，需将原本的土地覆盖栅格数据按照县面多边形进行裁剪，创建独立的县单元栅格，方便我们进行处理。当然，如果只是想做简单的聚合，则不需要进行独立栅格的构建，直接使用<code>分区统计</code>工具即可。</p><p>斯里兰卡有二十五个行政县，如果一个个用手点的话，是不是有些麻烦了，批处理也不支持迭代处理要素，那么有没有什么更加便捷的自动化操作呢？一开始我想的是用脚本来做，但是看到ArcGIS里面有一个模型构建器。通过模型构建器，可以创建迭代工作流，进而实现我们的需求。</p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230822144644519.png" alt="image-20230822144644519"><center> 裁剪模型迭代器<p>对行政区矢量数据内的所有面要素进行迭代，并将其作为裁剪工具的输入面要素，即可实现端到端的一键式任务流。将拆分数据的工作空间设置为一个新的<code>mdb</code>文件，即可获得分割好的数据。</p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230822144906569.png" alt="image-20230822144906569" style="zoom:50%;"><center> 迭代结果<p>由于分割的栅格没有属性表，此时我们需要迭代对其构建属性表。同样，可以使用模型构建器来进行，亦或是通过属性-&gt;符号系统来构建属性表。再拿到属性表之后，我们的数据应该是这样的：</p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230822145145242.png" alt="image-20230822145145242" style="zoom:50%;"><center> 地图效果<p>颜色斑杂是因为每个独立区块使用的色彩分级不一样，但这并不是我们要关注的重点。下一步操作将会导出这些属性表，并进行可视化。同样使用模型构建器，可以导出属性表：</p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230822145352556.png" alt="image-20230822145352556"><center> 属性表导出迭代器<p><code>表转Excel</code>位于转换工具-&gt;Excel-&gt;表转Excel。</p><p><code>表至表</code>位于转换工具-&gt;转出至地理数据库-&gt;表至表。</p><p>该操作后，我们便可取到对应栅格数据的数据表。下一步的工作内容是对这些表格进行处理，计算ESV价值。</p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230822145926891.png" alt="image-20230822145926891" style="zoom:50%;"><center> 导出结果<p>实际上，这个属性表长这个样子：</p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230822150346120.png" alt="image-20230822150346120" style="zoom:50%;"><center> 属性表<p>需要关注的就是<code>Value</code>属性和<code>Count</code>属性，前者代表土地覆盖类型，我们通过一个映射函数将映射到实际含义上，后者表示像元个数，注意像元大小是<code>10m by 10m</code>，如果换算成公顷，需要除以100。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">path=<span class="string">r&quot;E:\Sri Lanka\SubDivision&quot;</span> <span class="comment"># 文件路径</span></span><br><span class="line">mapTable=&#123;</span><br><span class="line">    <span class="number">1</span>:<span class="string">&quot;水系&quot;</span>,</span><br><span class="line">    <span class="number">2</span>:<span class="string">&quot;森林(针+针阔+阔叶)//3&quot;</span>,</span><br><span class="line">    <span class="number">4</span>:<span class="string">&quot;湿地&quot;</span>,</span><br><span class="line">    <span class="number">5</span>:<span class="string">&quot;耕地(旱地)&quot;</span>,</span><br><span class="line">    <span class="number">7</span>:<span class="string">&quot;城镇用地&quot;</span>,</span><br><span class="line">    <span class="number">8</span>:<span class="string">&quot;裸地&quot;</span>,</span><br><span class="line">    <span class="number">9</span>:<span class="string">&quot;冰川积雪&quot;</span>,</span><br><span class="line">    <span class="number">10</span>:<span class="string">&quot;云层&quot;</span>,</span><br><span class="line">    <span class="number">11</span>:<span class="string">&quot;草原&quot;</span></span><br><span class="line">&#125; <span class="comment"># 映射表</span></span><br><span class="line"></span><br><span class="line">values=<span class="string">r&quot;E:\Sri Lanka\ESV_Pro.csv&quot;</span> <span class="comment"># 前面得到的最终因子价值</span></span><br><span class="line">v=pd.read_csv(values)</span><br><span class="line">v.drop(v.columns[<span class="number">0</span>],axis=<span class="number">1</span>,inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getValue</span>(<span class="params">year</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">tem</span>):</span><br><span class="line">        Sum=<span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tem)):</span><br><span class="line">            <span class="comment"># 若映射存在</span></span><br><span class="line">            <span class="keyword">if</span>(k:=mapTable[tem[<span class="string">&#x27;Value&#x27;</span>][i]]) <span class="keyword">in</span> v[<span class="string">&#x27;Unnamed: 0&#x27;</span>].unique():</span><br><span class="line">                _=tem[<span class="string">&#x27;Count&#x27;</span>][i]/<span class="number">100</span> <span class="comment"># 换算成公顷</span></span><br><span class="line">                Sum+=v[v[<span class="string">&#x27;Unnamed: 0&#x27;</span>]==k].iloc[<span class="number">0</span>,<span class="number">1</span>:].<span class="built_in">sum</span>()*_ <span class="comment"># 总价值=\sum c_i*v_i</span></span><br><span class="line">        <span class="keyword">return</span> Sum</span><br><span class="line">    dicT=defaultdict(<span class="built_in">int</span>)</span><br><span class="line">    tabs=os.listdir(path+<span class="string">r&quot;\%sTabs&quot;</span>%year)</span><br><span class="line">    total_esv=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> tabs:</span><br><span class="line">        tb=pd.read_excel(path+<span class="string">r&quot;\%sTabs\\&quot;</span>%year+i)</span><br><span class="line">        total_esv+=(k:=f(tb))</span><br><span class="line">        dicT[i.split(<span class="string">&quot;_&quot;</span>)[<span class="number">0</span>]]=k/<span class="number">1e10</span></span><br><span class="line">    <span class="keyword">return</span> total_esv/<span class="number">1e10</span>,dicT</span><br></pre></td></tr></table></figure><p>为了验证该函数，我们可以尝试读取一下数据：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getValue(<span class="number">2017</span>)[<span class="number">0</span>] <span class="comment"># 获取2017年全国总量</span></span><br></pre></td></tr></table></figure><p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230822150741885.png" alt="image-20230822150741885"></p><center> 结果比对<p>从结果上，与前面未做分割的全国数据大致相等。由于按照多边形分割不可避免的会造成像元损失，因此该结果会小于整体的结果，误差在可接受范围内。</p><p>下一步，需要计算各个县每年的总量。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Stable=[getValue(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2017</span>,<span class="number">2023</span>)]</span><br><span class="line">DataShow=pd.DataFrame([],columns=[<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2017</span>,<span class="number">2023</span>)])</span><br><span class="line"><span class="comment"># 实际上，DF可以直接传入一个Dict，Key将作为Index，value将作为列值</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2017</span>,<span class="number">2023</span>):DataShow[<span class="built_in">str</span>(i)]=Stable[i-<span class="number">2017</span>][<span class="number">1</span>]</span><br></pre></td></tr></table></figure><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230822151043526.png" alt="image-20230822151043526" style="zoom:50%;"><center> 各县市年总ESV量表<p>我们将这个结果表导出，下一步便是在ArcGIS中绘制地图。</p><p>通过属性表的连接操作，可以将导出的表添加到矢量图中，然后就是对其进行地图制作，这方面不再赘述。</p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230822152158798.png" alt="image-20230822152158798" style="zoom:50%;"><center> 制图结果<p>再进一步，我们将利用<code>imageio</code>模块绘制动态图。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> imageio</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_gif</span>(<span class="params">filelist,name,dur=<span class="number">1.5</span></span>):</span><br><span class="line">    IMG=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> filelist:</span><br><span class="line">        IMG.append(imageio.imread(i))</span><br><span class="line">    <span class="keyword">return</span> imageio.mimsave(name,IMG,<span class="string">&#x27;GIF&#x27;</span>,duration=dur)</span><br><span class="line">path=[os.path.join(<span class="string">r&quot;E:\Sri Lanka\Res\Img&quot;</span>,i) <span class="keyword">for</span> i <span class="keyword">in</span> os.listdir(<span class="string">r&quot;E:\Sri Lanka\Res\Img&quot;</span>)]</span><br><span class="line">create_gif(path,<span class="string">r&quot;E:\Sri Lanka\Res\Img\res.gif&quot;</span>)</span><br></pre></td></tr></table></figure><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/res.gif" alt="res" style="zoom: 25%;"><center> 各省ESV年变化情况<p>结果如上图所示。</p><hr><h2 id="四、结果展示">四、结果展示</h2><p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230822174109522.png" alt="image-20230822174109522"></p><center> 斯里兰卡生态系统服务价值变化表<p>在斯里兰卡生态系统服务中，调节服务占了较大的比重，而文化服务的价值量较低，这与斯里兰卡大量的森林植被、湿地草甸覆盖有关。总体的价值量呈现波动上升趋势，说明斯里兰卡在新型人地关系的构建与维护上成果斐然。</p><p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230822174406411.png" alt="image-20230822174406411"></p><center> 斯里兰卡2022ESV分项占比<p><img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/image-20230822174431358.png" alt="image-20230822174431358"></p><center>各分项年变化情况<img src="/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%96%AF%E9%87%8C%E5%85%B0%E5%8D%A1%E7%94%9F%E6%80%81%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1%E4%BB%B7%E5%80%BC%E8%AE%A1%E7%AE%97/res.gif" alt="res" style="zoom: 25%;"><p>从各省结果来看，斯里兰卡的中部和东部具有较高的价值量，且随着时间变化，东部、中部地区总量呈现增加趋势，而<code>Matara</code>和<code>Puttalam</code>两个省份则是刚好在分界线上呈现先下降后上升的结果。</p><hr><h2 id="五、参考文献">五、参考文献</h2><p>熊睿毅. 福建省生态系统服务价值动态评估及影响因子研究[D].武汉大学,2021.DOI:10.27379/d.cnki.gwhdu.2021.000700.</p></center></center></center></center></center></center></center></center></center></center></center></center></center></center></center></center></center></center></center></center></center></center></center></center></center></center></center><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
    
    
    <summary type="html">开学做的一个项目</summary>
    
    
    
    <category term="不想学辣" scheme="http://example.com/categories/%E4%B8%8D%E6%83%B3%E5%AD%A6%E8%BE%A3/"/>
    
    
    <category term="项目实践" scheme="http://example.com/tags/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5/"/>
    
  </entry>
  
  <entry>
    <title>【数据分析实践】问题集</title>
    <link href="http://example.com/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E9%97%AE%E9%A2%98%E5%90%88%E9%9B%86/"/>
    <id>http://example.com/2023/08/22/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E9%97%AE%E9%A2%98%E5%90%88%E9%9B%86/</id>
    <published>2023-08-22T09:11:58.387Z</published>
    <updated>2023-08-24T09:43:05.559Z</updated>
    
    <content type="html"><![CDATA[<h1>【项目】斯里兰卡ESV计算</h1><p><strong>按照某一指标进行排序</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yield_c[yield_c[<span class="string">&quot;Year&quot;</span>]&gt;<span class="number">2015</span>].groupby(<span class="string">&#x27;Item&#x27;</span>).mean()</span><br></pre></td></tr></table></figure><p><strong><code>torch</code>存储和读取</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">torch.save(model.state_dict(),path) <span class="comment"># 存储</span></span><br><span class="line"></span><br><span class="line">checkpoint=torch.load(path)</span><br><span class="line">model.load_state_dict(checkpoint) <span class="comment"># 加载参数</span></span><br></pre></td></tr></table></figure><p><strong><code>Pyechart</code>制图参数</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">l.set_series_opts(label_opts=opts.LabelOpts(is_show=<span class="literal">False</span>))</span><br><span class="line">l.set_global_opts(title_opts=opts.TitleOpts(title=<span class="string">&#x27;1D CNN&#x27;</span>))</span><br></pre></td></tr></table></figure><p><code>Series</code>转列表</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pp_c[pp_c[<span class="string">&#x27;Item&#x27;</span>]==<span class="string">&quot;Rice&quot;</span>][<span class="string">&#x27;Value&#x27;</span>].tolist()</span><br></pre></td></tr></table></figure><p><strong>添加行数据</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pp_c=pp_c.append(&#123;<span class="string">&quot;Unnamed: 0&quot;</span>:<span class="number">91</span>+i,<span class="string">&quot;Year&quot;</span>:<span class="number">2006</span>+i,<span class="string">&quot;Value&quot;</span>:l[<span class="number">5</span>+i],<span class="string">&quot;Item&quot;</span>:<span class="string">&quot;Sorghum&quot;</span>,<span class="string">&#x27;Unit&#x27;</span>:<span class="string">&quot;卢比/kg&quot;</span>&#125;,ignore_index=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>注意需要列对应上，并且需要忽略索引，这里以字典形式做匹配。</p><p><strong>判断数据类型</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> e.columns:</span><br><span class="line">    <span class="keyword">if</span> e[i].dtype==np.float64:</span><br><span class="line">        e[i]*=<span class="number">16111</span></span><br></pre></td></tr></table></figure><p><strong>关于enumerate</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">tb,path</span>):</span><br><span class="line">    newT=defaultdict(<span class="built_in">int</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tb)):</span><br><span class="line">        <span class="keyword">if</span> (k:=mapTable[tb[<span class="string">&quot;Value&quot;</span>][i]]) <span class="keyword">in</span> v[<span class="string">&quot;Unnamed: 0&quot;</span>].unique(): <span class="comment"># unique()才能用 in，否则数据类型不是list</span></span><br><span class="line">            _=tb[<span class="string">&#x27;Count&#x27;</span>][i]/<span class="number">100</span></span><br><span class="line">            <span class="keyword">for</span> n,g <span class="keyword">in</span> <span class="built_in">enumerate</span>(v.columns[<span class="number">2</span>:].tolist(),<span class="number">2</span>): <span class="comment"># enumerate(list,idx) idx表示起始下标</span></span><br><span class="line">                newT[g]+=_/<span class="number">1e10</span>*v[v[<span class="string">&quot;Unnamed: 0&quot;</span>]==k].iloc[<span class="number">0</span>,n]</span><br><span class="line">    s=pd.DataFrame(newT,<span class="built_in">range</span>(<span class="number">1</span>))</span><br><span class="line">    s.to_csv(path)</span><br></pre></td></tr></table></figure><p><strong>很酷的运算1</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">AT=[]</span><br><span class="line">tab=os.listdir(path)</span><br><span class="line">tables=[i <span class="keyword">for</span> i <span class="keyword">in</span> tab <span class="keyword">if</span> i.endswith(<span class="string">&quot;t.csv&quot;</span>)]</span><br><span class="line"><span class="comment"># [&#x27;2017t.csv&#x27;, &#x27;2018t.csv&#x27;, &#x27;2019t.csv&#x27;, &#x27;2020t.csv&#x27;, &#x27;2021t.csv&#x27;, &#x27;2022t.csv&#x27;]</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tables)):</span><br><span class="line">    newT=defaultdict(<span class="built_in">int</span>)</span><br><span class="line">    year=tables[i].split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    tb=pd.read_csv(os.path.join(path,tables[i]))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tb)):</span><br><span class="line">        <span class="keyword">if</span> (k:=mapTable[tb[<span class="string">&quot;Value&quot;</span>][i]]) <span class="keyword">in</span> v[<span class="string">&quot;Unnamed: 0&quot;</span>].unique():</span><br><span class="line">            _=tb[<span class="string">&#x27;Count&#x27;</span>][i]/<span class="number">100</span></span><br><span class="line">            <span class="keyword">for</span> n,g <span class="keyword">in</span> <span class="built_in">enumerate</span>(v.columns[<span class="number">2</span>:].tolist(),<span class="number">2</span>):</span><br><span class="line">                  <span class="comment"># 每一项都等于 每种类型的像元乘以该像元在该项之下的价值之和</span></span><br><span class="line">                newT[g]+=_/<span class="number">1e10</span>*v[v[<span class="string">&quot;Unnamed: 0&quot;</span>]==k].iloc[<span class="number">0</span>,n]</span><br><span class="line">    AT.append(newT)</span><br><span class="line">d=pd.DataFrame(AT,index=[<span class="string">&quot;%s&quot;</span>%i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2017</span>,<span class="number">2023</span>)])</span><br></pre></td></tr></table></figure><p><strong>很酷的运算2</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">getValue</span>(<span class="params">year</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">tem</span>):</span><br><span class="line">        Sum=<span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tem)):</span><br><span class="line">            <span class="comment"># 若映射存在</span></span><br><span class="line">            <span class="keyword">if</span>(k:=mapTable[tem[<span class="string">&#x27;Value&#x27;</span>][i]]) <span class="keyword">in</span> v[<span class="string">&#x27;Unnamed: 0&#x27;</span>].unique():</span><br><span class="line">                _=tem[<span class="string">&#x27;Count&#x27;</span>][i]/<span class="number">100</span> <span class="comment"># 换算成公顷</span></span><br><span class="line">                Sum+=v[v[<span class="string">&#x27;Unnamed: 0&#x27;</span>]==k].iloc[<span class="number">0</span>,<span class="number">1</span>:].<span class="built_in">sum</span>()*_ <span class="comment"># 总价值=\sum c_i*v_i</span></span><br><span class="line">        <span class="keyword">return</span> Sum</span><br><span class="line">    dicT=defaultdict(<span class="built_in">int</span>)</span><br><span class="line">    tabs=os.listdir(path+<span class="string">r&quot;\%sTabs&quot;</span>%year)</span><br><span class="line">    total_esv=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> tabs:</span><br><span class="line">        tb=pd.read_excel(path+<span class="string">r&quot;\%sTabs\\&quot;</span>%year+i)</span><br><span class="line">        total_esv+=(k:=f(tb))</span><br><span class="line">        dicT[i.split(<span class="string">&quot;_&quot;</span>)[<span class="number">0</span>]]=k/<span class="number">1e10</span></span><br><span class="line">    <span class="keyword">return</span> total_esv/<span class="number">1e10</span>,dicT</span><br><span class="line"></span><br><span class="line">Stable=[getValue(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2017</span>,<span class="number">2023</span>)]</span><br><span class="line">DataShow=pd.DataFrame([],columns=[<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2017</span>,<span class="number">2023</span>)])</span><br><span class="line"><span class="comment"># 实际上，DF可以直接传入一个Dict，Key将作为Index，value将作为列值</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2017</span>,<span class="number">2023</span>):DataShow[<span class="built_in">str</span>(i)]=Stable[i-<span class="number">2017</span>][<span class="number">1</span>]</span><br></pre></td></tr></table></figure><p><strong>关于PyEchart图层的叠加</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a.overlap(l).render_notebook()</span><br></pre></td></tr></table></figure><p><strong>关于在训练过程中的新形式</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyDataSet</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,seq,ws=<span class="number">6</span></span>):</span><br><span class="line">        <span class="comment"># ws是滑动窗口大小</span></span><br><span class="line">        self.ori=[i <span class="keyword">for</span> i <span class="keyword">in</span> seq[:ws]]</span><br><span class="line">        self.label=[i <span class="keyword">for</span> i <span class="keyword">in</span> seq[ws:]]</span><br><span class="line">        self.reset()</span><br><span class="line">        self.ws=ws</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">set</span>(<span class="params">self,dpi</span>):</span><br><span class="line">        <span class="comment"># 添加数据</span></span><br><span class="line">        self.x.append(dpi)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">reset</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 初始化</span></span><br><span class="line">        self.x=self.ori[:]</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self,idx</span>):</span><br><span class="line">        <span class="keyword">return</span> self.x[idx:idx+self.ws],self.label[idx]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.x)</span><br><span class="line"></span><br><span class="line"> <span class="comment"># 数据迭代器不一定非得集成自DataLoader</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)-ws):</span><br><span class="line">            <span class="comment"># 每次更新参数前都梯度归零和初始化</span></span><br><span class="line">            seq,y_train=train_data.get(i) <span class="comment"># 从我们的数据集中拿出数据</span></span><br><span class="line">            seq,y_train=torch.FloatTensor(seq),torch.FloatTensor([y_train])</span><br><span class="line">            seq=seq.unsqueeze(dim=<span class="number">0</span>)</span><br><span class="line">            seq,y_train=seq.to(device),y_train.to(device)</span><br><span class="line"></span><br><span class="line">            optimizer.zero_grad()</span><br><span class="line">            <span class="comment"># 注意这里要对样本进行reshape，</span></span><br><span class="line">            <span class="comment"># 转换成conv1d的input size（batch size, channel, series length）</span></span><br><span class="line">            y_pred = model(seq)</span><br><span class="line">            loss = criterion(y_pred, y_train)</span><br><span class="line">            loss.backward()</span><br><span class="line">            train_data.<span class="built_in">set</span>(y_pred.to(<span class="string">&quot;cpu&quot;</span>).item()) <span class="comment"># 再放入预测数据</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 需要注意的是，一定要先构建计算图处理梯度后再放入，要不会出bug</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><p><strong>获取DataFrame中的数值</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.matmul(data.values,np.array(EWM(data)).T)</span><br></pre></td></tr></table></figure><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
    
    
    <summary type="html">针对项目中遇到的问题进行反思和总结</summary>
    
    
    
    <category term="不想学辣" scheme="http://example.com/categories/%E4%B8%8D%E6%83%B3%E5%AD%A6%E8%BE%A3/"/>
    
    
    <category term="项目实践" scheme="http://example.com/tags/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5/"/>
    
  </entry>
  
  <entry>
    <title>【数据分析实践】基于LSTM的一维数据拟合扩展</title>
    <link href="http://example.com/2023/08/18/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E4%B8%80%E7%BB%B4%E6%95%B0%E6%8D%AE%E6%89%A9%E5%B1%95/"/>
    <id>http://example.com/2023/08/18/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E4%B8%80%E7%BB%B4%E6%95%B0%E6%8D%AE%E6%89%A9%E5%B1%95/</id>
    <published>2023-08-18T08:24:55.317Z</published>
    <updated>2023-08-18T09:50:38.514Z</updated>
    
    <content type="html"><![CDATA[<h1>基于LSTM的一维数据拟合扩展</h1><h3 id="一、引-fei-言-hua">一、引(fei)言(hua)</h3><p>我在做Sri Lanka生态系统服务价值计算时，中间遇到了一点小问题。从世界粮农组织(<a href="https://www.fao.org/faostat/en/#data">FAO</a>)上获得Sri Lanka主要农作物产量和价格数据时，其中的主要作物Sorghum仅有2001-2006年的数据，而Millet只有2001-2005,2020-2021这样的间断数据。虽然说可以直接剔除这种过分缺失的数据，但这无疑会对生态因子的计算造成重大影响。所以我想要不要整个函数把他拟合一下，刚好Maize和Rice有2001-2021的完备数据，于是，这个文档就这样诞生了。</p><hr><h3 id="二、数据">二、数据</h3><p>数据来自FAO，考虑到可能有同学想要跟着尝试一下，这里给出用到的数据。</p><p><a href="https://github.com/Chen-XiaoLv/DemoGit/blob/master/yield.csv">作物产量</a></p><p><a href="https://github.com/Chen-XiaoLv/DemoGit/blob/master/Producer%20Prices.csv">作物价格</a></p><h4 id="2-1-数据探查">2.1 数据探查</h4><p>我们读取数据，并进行简单的统计量查看。如果要进一步深入研究数据分布及可视化，可以看看我的这篇<a href="https://github.com/Chen-XiaoLv/ML-in-Geochemistry/blob/master/READEME.md">文章</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">path=<span class="string">r&quot;YourPath&quot;</span></span><br><span class="line"></span><br><span class="line">yield_=pd.read_csv(path+<span class="string">r&quot;\yield.csv&quot;</span>)</span><br><span class="line">pp_=pd.read_csv(path+<span class="string">r&quot;\Producer Prices.csv&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yield_.head()</span><br></pre></td></tr></table></figure><p><img src="/2023/08/18/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E4%B8%80%E7%BB%B4%E6%95%B0%E6%8D%AE%E6%89%A9%E5%B1%95/image-20230818164633501.png" alt="image-20230818164633501"></p><p>需要用到的属性只有<code>Item,Year,Unit,Value</code></p><p>所以我们做这样的处理：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yield_=yield_[[<span class="string">&quot;Item&quot;</span>,<span class="string">&quot;Year&quot;</span>,<span class="string">&quot;Unit&quot;</span>,<span class="string">&quot;Value&quot;</span>]]</span><br></pre></td></tr></table></figure><p>可以看到有些数据是从1961年开始的，太旧了就不用了，我们从2001年开始。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yield_=yield_[yield_[<span class="string">&quot;Year&quot;</span>]&gt;<span class="number">2000</span>]</span><br></pre></td></tr></table></figure><p>同样，我们来看看pp_的情况：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pp_.head()</span><br></pre></td></tr></table></figure><p><img src="/2023/08/18/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E4%B8%80%E7%BB%B4%E6%95%B0%E6%8D%AE%E6%89%A9%E5%B1%95/image-20230818165001703.png" alt="image-20230818165001703"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pp_=pp_[[<span class="string">&quot;Item&quot;</span>,<span class="string">&quot;Year&quot;</span>,<span class="string">&quot;Value&quot;</span>,<span class="string">&quot;Element&quot;</span>]]</span><br><span class="line">pp_=pp_[pp_[<span class="string">&quot;Year&quot;</span>]&gt;<span class="number">2000</span>]</span><br></pre></td></tr></table></figure><p>实际上，在这个数据里，产量已经没有问题了。我们只需要做一个简单的处理：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yield_.groupby(<span class="string">&quot;Item&quot;</span>).mean()[<span class="string">&quot;Value&quot;</span>]/<span class="number">10</span> <span class="comment">#转为千克</span></span><br></pre></td></tr></table></figure><p><img src="/2023/08/18/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E4%B8%80%E7%BB%B4%E6%95%B0%E6%8D%AE%E6%89%A9%E5%B1%95/image-20230818165519952.png" alt="image-20230818165519952"></p><p>便可拿到每种作物近二十年的平均产量。</p><p>好了现在大问题出现在价值上，我们从下往上看就知道了：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pp_.tail(<span class="number">10</span>)</span><br></pre></td></tr></table></figure><p><img src="/2023/08/18/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E4%B8%80%E7%BB%B4%E6%95%B0%E6%8D%AE%E6%89%A9%E5%B1%95/image-20230818165632557.png" alt="image-20230818165632557"></p><p>高粱只有2006年的，那有没有办法利用现成的数据将其扩展呢？</p><p>实际上，这类拟合问题有很多种解决方案，但是本问题涉及到时间，之前时间段的因子，以及可能的周期性，都会增加拟合的复杂性。所以，在这里我们采用LSTM来填充数据。</p><hr><h3 id="三、模型构建">三、模型构建</h3><p>在本小节，我们将比较传统一维CNN与RNN在结果上的异同。</p><p>一般做一维RNN时，可以指定一个<code>时间窗口</code>，比如用<code>2006,2007,2008</code>年的数据，推理<code>2009</code>年的数据，用<code>2007,2008,2009</code>年推理<code>2010</code>年。</p><p>我们现在要用之前处理好的<code>pp_c</code>数据中的玉米产量，来预测高粱产量。所以第一步就是将其转化为<code>torch</code>接受的格式。</p><p>别忘记导入模块：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">from</span> torch.nn <span class="keyword">import</span> functional <span class="keyword">as</span> F</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x=pp_c[pp_c[<span class="string">&#x27;Item&#x27;</span>]==<span class="string">&quot;Maize (corn)&quot;</span>][<span class="string">&#x27;Value&#x27;</span>]</span><br><span class="line">x=torch.FloatTensor(x)</span><br></pre></td></tr></table></figure><p>之前写数据迭代器的时候，除了可以继承自<code>torch.utils.data.DataLoader</code>，也可以是任意的可迭代对象。这里我们可以简单的设置一个类：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置迭代器</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyDataSet</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,seq,ws=<span class="number">6</span></span>):</span><br><span class="line">        <span class="comment"># ws是滑动窗口大小</span></span><br><span class="line">        self.ori=[i <span class="keyword">for</span> i <span class="keyword">in</span> seq[:ws]]</span><br><span class="line">        self.label=[i <span class="keyword">for</span> i <span class="keyword">in</span> seq[ws:]]</span><br><span class="line">        self.reset()</span><br><span class="line">        self.ws=ws</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">set</span>(<span class="params">self,dpi</span>):</span><br><span class="line">        <span class="comment"># 添加数据</span></span><br><span class="line">        self.x.append(dpi)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">reset</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 初始化</span></span><br><span class="line">        self.x=self.ori[:]</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self,idx</span>):</span><br><span class="line">        <span class="keyword">return</span> self.x[idx:idx+self.ws],self.label[idx]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.x)</span><br></pre></td></tr></table></figure><p>哦这边提一下，有两种方式，一种是用原始数据做预测，一种是用预测数据做预测，可能有点抽象，下面举个例子。</p><p>假设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mo stretchy="false">[</mo><mi>a</mi><mn>1</mn><mo separator="true">,</mo><mi>a</mi><mn>2</mn><mo separator="true">,</mo><mi>a</mi><mn>3</mn><mo separator="true">,</mo><mi>a</mi><mn>4</mn><mo separator="true">,</mo><mi>a</mi><mn>5</mn><mo separator="true">,</mo><mi>a</mi><mn>6</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">A=[a1,a2,a3,a4,a5,a6]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">a</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">6</span><span class="mclose">]</span></span></span></span>，时间窗口大小为3。</p><p>用原始数据做预测，那么输入值为：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mn>1</mn><mo separator="true">,</mo><mi>a</mi><mn>2</mn><mo separator="true">,</mo><mi>a</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">a1,a2,a3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">3</span></span></span></span>，得到的结果将与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">a4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">a</span><span class="mord">4</span></span></span></span>做比较。下一轮输入为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mn>2</mn><mo separator="true">,</mo><mi>a</mi><mn>3</mn><mo separator="true">,</mo><mi>a</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">a2,a3,a4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">4</span></span></span></span>，得到的结果将与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mn>5</mn></mrow><annotation encoding="application/x-tex">a5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">a</span><span class="mord">5</span></span></span></span>做比较。</p><p>而用预测的数据做预测，第一轮输入值为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mn>1</mn><mo separator="true">,</mo><mi>a</mi><mn>2</mn><mo separator="true">,</mo><mi>a</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">a1,a2,a3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">3</span></span></span></span>，得到的结果是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">b4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span><span class="mord">4</span></span></span></span>，在与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">a4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">a</span><span class="mord">4</span></span></span></span>做比较后，下一轮的输入为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mn>2</mn><mo separator="true">,</mo><mi>a</mi><mn>3</mn><mo separator="true">,</mo><mi>b</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">a2,a3,b4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mord">4</span></span></span></span>，会出现如下情况：</p><p>输入数据为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mn>4</mn><mo separator="true">,</mo><mi>b</mi><mn>5</mn><mo separator="true">,</mo><mi>b</mi><mn>6</mn></mrow><annotation encoding="application/x-tex">b4,b5,b6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">b</span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mord">6</span></span></span></span>。</p><p>我们现在举的例子是用预测的数据做预测。当然，最后也会给出一个用原始数据做预测的版本，那个版本相对简单。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ws=<span class="number">6</span> <span class="comment"># 全局时间窗口</span></span><br><span class="line">train_data=MyDataSet(x,ws)</span><br></pre></td></tr></table></figure><hr><p>网络的架构如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">   </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Net3</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,in_features=<span class="number">54</span>,n_hidden1=<span class="number">128</span>,n_hidden2=<span class="number">256</span>,n_hidden3=<span class="number">512</span>,out_features=<span class="number">7</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(Net3, self).__init__()</span><br><span class="line">        self.flatten=nn.Flatten()</span><br><span class="line">        self.hidden1=nn.Sequential(</span><br><span class="line">            nn.Linear(in_features,n_hidden1,<span class="literal">False</span>),</span><br><span class="line">           </span><br><span class="line">            nn.ReLU()</span><br><span class="line">        )</span><br><span class="line">        self.hidden2=nn.Sequential(</span><br><span class="line">            nn.Linear(n_hidden1,n_hidden2),</span><br><span class="line"></span><br><span class="line">            nn.ReLU()</span><br><span class="line">        )</span><br><span class="line">        self.hidden3=nn.Sequential(</span><br><span class="line">            nn.Linear(n_hidden2,n_hidden3),</span><br><span class="line"></span><br><span class="line">            nn.ReLU()</span><br><span class="line">        )</span><br><span class="line">        self.out=nn.Sequential(nn.Linear(n_hidden3,out_features))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self,x</span>):</span><br><span class="line">        x=self.flatten(x)</span><br><span class="line">        x=self.hidden2(self.hidden1(x))</span><br><span class="line">        x=self.hidden3(x)</span><br><span class="line">        <span class="keyword">return</span> self.out(x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CNN</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, output_dim=<span class="number">1</span>,ws=<span class="number">6</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(CNN, self).__init__()</span><br><span class="line">        self.relu = nn.ReLU(inplace=<span class="literal">True</span>)</span><br><span class="line">        self.conv1 = nn.Conv1d(ws, <span class="number">64</span>, <span class="number">1</span>)</span><br><span class="line">        self.lr = nn.LeakyReLU(inplace=<span class="literal">True</span>)</span><br><span class="line">        self.conv2 = nn.Conv1d(<span class="number">64</span>, <span class="number">128</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        self.bn1, self.bn2 = nn.BatchNorm1d(<span class="number">64</span>), nn.BatchNorm1d(<span class="number">128</span>)</span><br><span class="line">        self.bn3, self.bn4 = nn.BatchNorm1d(<span class="number">1024</span>), nn.BatchNorm1d(<span class="number">128</span>)</span><br><span class="line">        self.flatten = nn.Flatten()</span><br><span class="line">        self.lstm1 = nn.LSTM(<span class="number">128</span>, <span class="number">1024</span>)</span><br><span class="line">        self.lstm2 = nn.LSTM(<span class="number">1024</span>, <span class="number">256</span>)</span><br><span class="line">        self.lstm3=nn.LSTM(<span class="number">256</span>,<span class="number">512</span>)</span><br><span class="line">        self.fc = nn.Linear(<span class="number">512</span>, <span class="number">512</span>)</span><br><span class="line">        self.fc4=nn.Linear(<span class="number">512</span>,<span class="number">256</span>)</span><br><span class="line">        self.fc1 = nn.Linear(<span class="number">256</span>, <span class="number">64</span>)</span><br><span class="line">        self.fc3 = nn.Linear(<span class="number">64</span>, output_dim)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">reS</span>(<span class="params">x</span>):</span><br><span class="line">        <span class="keyword">return</span> x.reshape(-<span class="number">1</span>, x.shape[-<span class="number">1</span>], x.shape[-<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        x = self.reS(x)</span><br><span class="line">        x = self.conv1(x) </span><br><span class="line">        x = self.lr(x)</span><br><span class="line"></span><br><span class="line">        x = self.conv2(x) </span><br><span class="line">        x = self.lr(x)</span><br><span class="line"></span><br><span class="line">        x = self.flatten(x)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># LSTM部分</span></span><br><span class="line">        x, h = self.lstm1(x)</span><br><span class="line">        x, h = self.lstm2(x)</span><br><span class="line">        x,h=self.lstm3(x)</span><br><span class="line">        x, _ = h</span><br><span class="line"></span><br><span class="line">        x = self.fc(x.reshape(-<span class="number">1</span>, ))</span><br><span class="line">        x = self.relu(x)</span><br><span class="line">        x = self.fc4(x)</span><br><span class="line">        x = self.relu(x)</span><br><span class="line">        x = self.fc1(x)</span><br><span class="line">        x = self.relu(x)</span><br><span class="line">        x = self.fc3(x)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>Net3</code>主要是一维卷积，<code>CNN</code>加入了LSTM结构。至于名字，是随便取的…跟内容并无关系。</p><hr><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">Train</span>(<span class="params">model,train_data,seed=<span class="number">1</span></span>):</span><br><span class="line">    device=<span class="string">&quot;cuda&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span></span><br><span class="line">    model=model.to(device)</span><br><span class="line">    Mloss=<span class="number">100000</span></span><br><span class="line">    path=<span class="string">r&quot;YourPath\%s.pth&quot;</span>%seed</span><br><span class="line">    <span class="comment"># 设置损失函数,这里使用的是均方误差损失</span></span><br><span class="line">    criterion = nn.MSELoss()</span><br><span class="line">    <span class="comment"># 设置优化函数和学习率lr</span></span><br><span class="line">    optimizer=torch.optim.Adam(model.parameters(),lr=<span class="number">1e-5</span>,betas=(<span class="number">0.9</span>,<span class="number">0.99</span>),</span><br><span class="line">                               eps=<span class="number">1e-07</span>,weight_decay=<span class="number">0</span>)</span><br><span class="line">    <span class="comment"># 设置训练周期</span></span><br><span class="line">    epochs =<span class="number">3000</span></span><br><span class="line">    criterion=criterion.to(device)</span><br><span class="line">    model.train()</span><br><span class="line">    <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(epochs):</span><br><span class="line">        total_loss=<span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)-ws):</span><br><span class="line">            <span class="comment"># 每次更新参数前都梯度归零和初始化</span></span><br><span class="line">            seq,y_train=train_data.get(i) <span class="comment"># 从我们的数据集中拿出数据</span></span><br><span class="line">            seq,y_train=torch.FloatTensor(seq),torch.FloatTensor([y_train])</span><br><span class="line">            seq=seq.unsqueeze(dim=<span class="number">0</span>)</span><br><span class="line">            seq,y_train=seq.to(device),y_train.to(device)</span><br><span class="line"></span><br><span class="line">            optimizer.zero_grad()</span><br><span class="line">            <span class="comment"># 注意这里要对样本进行reshape，</span></span><br><span class="line">            <span class="comment"># 转换成conv1d的input size（batch size, channel, series length）</span></span><br><span class="line">            y_pred = model(seq)</span><br><span class="line">            loss = criterion(y_pred, y_train)</span><br><span class="line">            loss.backward()</span><br><span class="line">            train_data.<span class="built_in">set</span>(y_pred.to(<span class="string">&quot;cpu&quot;</span>).item()) <span class="comment"># 再放入预测数据</span></span><br><span class="line">            optimizer.step()</span><br><span class="line">            total_loss+=loss</span><br><span class="line"></span><br><span class="line">        train_data.reset()</span><br><span class="line">        <span class="keyword">if</span> total_loss.tolist()&lt;Mloss:</span><br><span class="line">            Mloss=total_loss.tolist()</span><br><span class="line">            torch.save(model.state_dict(),path)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Saving&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;Epoch: <span class="subst">&#123;epoch+<span class="number">1</span>:<span class="number">2</span>&#125;</span> Mean Loss: <span class="subst">&#123;total_loss.tolist()/<span class="built_in">len</span>(train_data):<span class="number">10.8</span>f&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> model</span><br></pre></td></tr></table></figure><p>正常训练就OK</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d=CNN(ws=ws)</span><br><span class="line">Train(d,train_data,<span class="number">4</span>)</span><br></pre></td></tr></table></figure><p><img src="/2023/08/18/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E4%B8%80%E7%BB%B4%E6%95%B0%E6%8D%AE%E6%89%A9%E5%B1%95/image-20230818173024746.png" alt="image-20230818173024746"></p><p>平均损失在10点左右，还有很大优化空间。当然我们这里只是举个非常简单的例子，就是个<code>baseline</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">checkpoint=torch.load(<span class="string">r&quot;YourPath\4.pth&quot;</span>)</span><br><span class="line">d.load_state_dict(checkpoint) <span class="comment"># 加载最佳参数</span></span><br><span class="line">d.to(<span class="string">&quot;cpu&quot;</span>)</span><br></pre></td></tr></table></figure><hr><h3 id="四、结果可视化">四、结果可视化</h3><p>我们这里用到<code>Pyechart</code>进行可视化。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pyecharts.charts <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pyecharts <span class="keyword">import</span> options <span class="keyword">as</span> opts</span><br><span class="line"><span class="keyword">from</span> pyecharts.<span class="built_in">globals</span> <span class="keyword">import</span> CurrentConfig</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pre,ppre=[i.item() <span class="keyword">for</span> i <span class="keyword">in</span> x[:ws]],[]</span><br><span class="line"><span class="comment"># pre 是用原始数据做预测</span></span><br><span class="line"><span class="comment"># ppre 用预测数据做预测</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)-ws+<span class="number">1</span>):</span><br><span class="line">    ppre.append(d(torch.FloatTensor(x[i:i+ws]).unsqueeze(dim=<span class="number">0</span>)))</span><br><span class="line">    pre.append(d(torch.FloatTensor(pre[-ws:]).unsqueeze(dim=<span class="number">0</span>)).item())</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">l=Line()</span><br><span class="line">l.add_xaxis([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))])</span><br><span class="line">l.add_yaxis(<span class="string">&quot;Original Data&quot;</span>,x.tolist())</span><br><span class="line">l.add_yaxis(<span class="string">&quot;Pred Data(Using Raw Datas)&quot;</span>,x[:ws].tolist()+[i.item() <span class="keyword">for</span> i <span class="keyword">in</span> ppre])</span><br><span class="line">l.add_yaxis(<span class="string">&quot;Pred Data(Using Pred Datas)&quot;</span>,pre)</span><br><span class="line">l.set_series_opts(label_opts=opts.LabelOpts(is_show=<span class="literal">False</span>))</span><br><span class="line">l.set_global_opts(title_opts=opts.TitleOpts(title=<span class="string">&#x27;LSTM CNN&#x27;</span>))</span><br><span class="line"></span><br><span class="line">l.render_notebook()</span><br></pre></td></tr></table></figure><p>根据时间窗口的不同，可以得到不同的结果。</p><h4 id="ws-4">ws=4</h4><img src="/2023/08/18/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E4%B8%80%E7%BB%B4%E6%95%B0%E6%8D%AE%E6%89%A9%E5%B1%95/image-20230818173641683.png" alt="image-20230818173641683" style="zoom:50%;"><h4 id="ws-5">ws=5</h4><img src="/2023/08/18/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E4%B8%80%E7%BB%B4%E6%95%B0%E6%8D%AE%E6%89%A9%E5%B1%95/image-20230818173542749.png" alt="image-20230818173542749" style="zoom:50%;"><h4 id="ws-6">ws=6</h4><img src="/2023/08/18/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E4%B8%80%E7%BB%B4%E6%95%B0%E6%8D%AE%E6%89%A9%E5%B1%95/image-20230818173724244.png" alt="image-20230818173724244" style="zoom:50%;"><p>从结果上来看，时间窗口越大越好。但是这里我们只能到六了，再大就不礼貌了。(高粱只有六个节点的数据)。</p><p>至于验证，我们可以选<code>Rice</code>做验证：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">x=torch.FloatTensor(pp_c[pp_c[<span class="string">&#x27;Item&#x27;</span>]==<span class="string">&quot;Rice&quot;</span>][<span class="string">&#x27;Value&#x27;</span>].tolist())</span><br><span class="line">pre,ppre=[i.item() <span class="keyword">for</span> i <span class="keyword">in</span> x[:ws]],[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)-ws+<span class="number">1</span>):</span><br><span class="line">    ppre.append(d(torch.FloatTensor(x[i:i+ws]).unsqueeze(dim=<span class="number">0</span>)))</span><br><span class="line">    pre.append(d(torch.FloatTensor(pre[-ws:]).unsqueeze(dim=<span class="number">0</span>)).item())</span><br><span class="line">l=Line()</span><br><span class="line">l.add_xaxis([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))])</span><br><span class="line">l.add_yaxis(<span class="string">&quot;Original Data&quot;</span>,x.tolist())</span><br><span class="line">l.add_yaxis(<span class="string">&quot;Pred Data(Using Raw Datas)&quot;</span>,x[:ws].tolist()+[i.item() <span class="keyword">for</span> i <span class="keyword">in</span> ppre])</span><br><span class="line">l.add_yaxis(<span class="string">&quot;Pred Data(Using Pred Datas)&quot;</span>,pre)</span><br><span class="line">l.set_series_opts(label_opts=opts.LabelOpts(is_show=<span class="literal">False</span>))</span><br><span class="line">l.set_global_opts(title_opts=opts.TitleOpts(title=<span class="string">&#x27;LSTM CNN&#x27;</span>))</span><br><span class="line"></span><br><span class="line">l.render_notebook()</span><br></pre></td></tr></table></figure><p><img src="/2023/08/18/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E4%B8%80%E7%BB%B4%E6%95%B0%E6%8D%AE%E6%89%A9%E5%B1%95/image-20230818174046726.png" alt="image-20230818174046726"></p><p>可以发现，用预测做预测的结果，基本上不会差太多，那也就意味着，我们可以对高粱进行预测啦！不过在这之前，我们可以看看用原始数据做训练的结果：</p><p><img src="/2023/08/18/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E4%B8%80%E7%BB%B4%E6%95%B0%E6%8D%AE%E6%89%A9%E5%B1%95/image-20230818174214014.png" alt="image-20230818174214014"></p><p>时间窗口一样为6，可以看到在黑线贴合的非常好，但是面对大量缺失的数据，精度就远不如用预测数据做预测的结果了。</p><p>此外，这是用CNN做的结果</p><p><img src="/2023/08/18/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E4%B8%80%E7%BB%B4%E6%95%B0%E6%8D%AE%E6%89%A9%E5%B1%95/image-20230818174436597.png" alt="image-20230818174436597"></p><p>我们可以发现LSTM的波动要比CNN好，CNN后面死水一潭，应该是梯度消失导致的，前面信息没有了，后面信息又是自个构造的，这就导致了到后面变成了线性情况。</p><p>那么最后的最后，就是预测高粱产量了：</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">pre_data=pp_c[pp_c[<span class="string">&#x27;Item&#x27;</span>]==<span class="string">&#x27;Sorghum&#x27;</span>][<span class="string">&#x27;Value&#x27;</span>].tolist()</span><br><span class="line">l=pre_data[:]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)-ws+<span class="number">1</span>):</span><br><span class="line">    l.append(d(torch.FloatTensor(l[-ws:]).unsqueeze(dim=<span class="number">0</span>)).item())</span><br><span class="line">L=Line()</span><br><span class="line">L.add_xaxis([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))])</span><br><span class="line">L.add_yaxis(<span class="string">&quot;Pred&quot;</span>,l)</span><br><span class="line">L.set_series_opts(label_opts=opts.LabelOpts(is_show=<span class="literal">False</span>))</span><br><span class="line">L.set_global_opts(title_opts=opts.TitleOpts(title=<span class="string">&#x27;sorghum production forecasts&#x27;</span>)</span><br><span class="line">                            </span><br><span class="line">                             )</span><br><span class="line"></span><br><span class="line">L.render_notebook()</span><br><span class="line">l.to_csv(<span class="string">&quot;path&quot;</span>)</span><br></pre></td></tr></table></figure><img src="/2023/08/18/%E3%80%90%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%E3%80%91%E4%B8%80%E7%BB%B4%E6%95%B0%E6%8D%AE%E6%89%A9%E5%B1%95/image-20230818174718747.png" alt="image-20230818174718747" style="zoom:50%;"><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
    
    
    <summary type="html">无聊</summary>
    
    
    
    <category term="不想学辣" scheme="http://example.com/categories/%E4%B8%8D%E6%83%B3%E5%AD%A6%E8%BE%A3/"/>
    
    
    <category term="项目实践" scheme="http://example.com/tags/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5/"/>
    
  </entry>
  
  <entry>
    <title>扇贝英语单词扫盲</title>
    <link href="http://example.com/2023/08/06/%E3%80%90%E8%8B%B1%E8%AF%AD%E3%80%91%E6%89%87%E8%B4%9D%E8%8B%B1%E8%AF%AD%E5%8D%95%E8%AF%8D/"/>
    <id>http://example.com/2023/08/06/%E3%80%90%E8%8B%B1%E8%AF%AD%E3%80%91%E6%89%87%E8%B4%9D%E8%8B%B1%E8%AF%AD%E5%8D%95%E8%AF%8D/</id>
    <published>2023-08-06T12:35:50.213Z</published>
    <updated>2023-11-20T10:12:53.936Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Chapter-1">Chapter 1</h2><blockquote><p>consumption</p></blockquote><ul><li>这个词只能作名词，表示<code>消费，消耗，食用，引用</code>的意思，当然还有另外一个偏差比较大的：<code>肺痨</code></li><li>给一些例句：<code>I always take fuel consumption into consideration when buying a car</code></li><li><code>take into consideration</code>，<code>fuel consumption</code>，希望你能懂</li></ul><blockquote><p>accessory</p></blockquote><ul><li><code>access</code>表示路径，到达，访问，存取，微软的那个DBMS也叫Access</li><li>但是<code>accessory</code>并不是由<code>access</code>引申的，他作为形容词表示<code>辅助的，副的</code>，作为名词则表示<code>附件，配件，同谋，帮凶</code></li></ul><blockquote><p>premise</p></blockquote><ul><li>这玩意表示地基，房屋，以及最重要的<code>前提，假设</code></li><li><code>We should agree that our debate is based on the premise stated earlier.</code>这里<code>stated earlier</code>早先阐明的，修饰<code>the premise</code></li></ul><blockquote><p>vacate</p></blockquote><ul><li>表示<code>腾出，空出，还有离职，退位</code></li><li><code>We are requested to vacate our rooms by noon.</code></li></ul><blockquote><p>demanding</p></blockquote><ul><li>这表示<code>苛求的，难满足的，费力的，需求高的</code>，啊并不是需要的，而是难满足(需求)的</li><li><code>She doesn't have the ability to do this demanding job.</code></li></ul><blockquote><p>snap</p></blockquote><ul><li>突然折断，突然生气</li><li><code>The wind had snapped the tree in two.</code></li></ul><blockquote><p>barber</p></blockquote><ul><li><code>理发师</code>，没什么好说的，做动词就表示<code>为...理发</code></li></ul><blockquote><p>expel</p></blockquote><ul><li><code>排除，把...开除，喷出</code></li><li><code>She was expelled from school at 15.</code></li></ul><blockquote><p>autonomous</p></blockquote><ul><li>自治的，独立自主的</li></ul><blockquote><p>cater</p></blockquote><ul><li><code>满足...需求，迎合，提供饮食</code>，非常有意思的词语</li><li><code>He has to cater for his boss.</code> cater for 迎合XX</li></ul><blockquote><p>staff</p></blockquote><ul><li>职员</li></ul><blockquote><p>infrastructure</p></blockquote><ul><li><p>这个词啊，<code>structure</code>结构，词根<code>infra</code>表示在下，以下的意思，所以就是下层结构：<code>基础设施，基础结构</code></p></li><li><p><code>Improving the city's transport infrastructure is the governor's first step.</code></p></li></ul><hr><blockquote><p>conduct</p></blockquote><ul><li>表示名词，则为<code>举止，行为，处理，管理</code></li><li>动词表示<code>进行，组织，实施，处理，指挥</code>等等</li><li><code>to conduct an experiment</code></li></ul><blockquote><p>lease</p></blockquote><ul><li>名词表示<code>租约，租契</code></li><li>动词表示<code>租用，租借，出租</code></li></ul><blockquote><p>cereal</p></blockquote><ul><li>表示<code>谷物</code>，还有个类似的:<code>grain</code></li></ul><blockquote><p>versatile</p></blockquote><ul><li>形容词是多才多艺的，多方面的，多用途的</li><li><code>He's a versatile actor who has played a wide variety of parts.</code></li></ul><blockquote><p>dull</p></blockquote><ul><li><code>乏味的，单调的，迟钝的，阴沉昏暗</code>的</li><li><code>Life in a small town could be deadly dull.</code></li></ul><blockquote><p>cuisine</p></blockquote><ul><li>表示<code>烹饪，烹调法，烹调风格</code></li><li><code>The hotel restaurant is noted for its excellent cuisine.</code> 哦这里的<code>be noted for</code>，因…而出名</li></ul><blockquote><p>shred</p></blockquote><ul><li><code>碎片，细条，些许，少量</code></li><li><code>The paper was ripped to shreds and scattered on the floor.</code></li></ul><blockquote><p>specialize</p></blockquote><ul><li><code>专门从事，专门经营</code></li><li><code>The French restaurant specialized in seafood.</code> <code>specialize in</code> 专攻于…</li></ul><blockquote><p>spice</p></blockquote><ul><li><code>调味料，香料，调剂品</code>，表示动词就是<code>添加香料</code></li></ul><blockquote><p>incorporate</p></blockquote><ul><li><code>包含，并入，合并，吸纳</code></li><li><code>Many of your suggestions have been incorporated in the new plan.</code> 你的很多建议都已经被采纳进新计划中了</li></ul><blockquote><p>cultivate</p></blockquote><ul><li><code>耕作，种植，培养，结交</code></li><li><code>Most of the fertile land in the country has been cultivated.</code> 这个搭配很有意思，<code>fertile land</code> 肥沃的土地</li></ul><blockquote><p>puff</p></blockquote><ul><li>作动词表示<code>喘气，吸(烟),喷出，冒出</code>，做名词一般是<code>一小口烟，一缕，少量，吸烟</code>，甚至能表示<code>泡芙，吹捧的文章</code></li></ul><blockquote><p>consult</p></blockquote><ul><li>只能做动词，表示<code>咨询，查阅，商讨</code></li><li><code>Have you consulted your lawyer about this?</code> 你就此事咨询过你的律师吗</li></ul><hr><blockquote><p>sponge</p></blockquote><ul><li>作名词是<code>海绵，寄生虫</code></li><li>作动词是<code>用海绵擦</code></li></ul><blockquote><p>textile</p></blockquote><ul><li>表示<code>织物，纺织品，纺织业</code></li></ul><blockquote><p>absorb</p></blockquote><ul><li>表示<code>吸收，吸引...注意</code>，以及<code>使全神贯注</code></li><li><code>The cream is easily absorbed into the skin.</code></li></ul><blockquote><p>tube</p></blockquote><ul><li>表示<code>管子，管道</code></li></ul><blockquote><p>irrigate</p></blockquote><ul><li><code>灌溉，冲洗</code></li></ul><blockquote><p>weird</p></blockquote><ul><li><code>怪异的，神秘的</code></li><li><code>A series of weird things taht happened recently made people terrified.</code></li></ul><blockquote><p>odorous</p></blockquote><ul><li>顶级矛盾纠结体：<code>有气味的，难闻的，香味，芬芳的</code></li></ul><blockquote><p>relic</p></blockquote><ul><li><code>遗物，遗迹，遗风</code></li><li><code>Archaeologists found a beautiful mural in a relic from the Stone Age.</code>考古学家在一个石器时代的遗迹中发现了一幅精美壁画</li></ul><blockquote><p>excavation</p></blockquote><ul><li><code>挖掘，发掘，出土文物</code></li><li><code>The excavations are open to the public</code></li></ul><blockquote><p>affiliate</p></blockquote><ul><li>作名词表示<code>分公司，子公司</code>，做动词表示<code>使附属，接纳，加入，并入</code></li></ul><blockquote><p>pinpoint</p></blockquote><ul><li><code>精确定位，准确的，精确地</code></li></ul><blockquote><p>prominent</p></blockquote><ul><li><code>杰出的，显著的，突出的</code></li><li><code>As the leader, he played a prominent part in the team's victory.</code></li></ul><blockquote><p>distinctive</p></blockquote><ul><li>出色的，有特色的</li><li><code>I can recognize her from a mile away because she has a very distinctive voice.</code></li></ul><blockquote><p>grind</p></blockquote><ul><li>磨碎，折磨，压榨，反复灌输</li><li>当然做名词可以表示<code>磨光，苦干，苦学，苦差事</code></li></ul><blockquote><p>dwindle</p></blockquote><ul><li><code>减少，缩小</code></li><li><code>The country's population has dwindled to half of its former size</code></li></ul><blockquote><p>embody</p></blockquote><ul><li>具体表现，体现，代表</li><li><code>She embodies her principles in her behavior.</code></li></ul><blockquote><p>primitive</p></blockquote><ul><li>原始的，简陋的</li></ul><hr><blockquote><p>unearth</p></blockquote><ul><li>掘出，发掘，揭露</li></ul><blockquote><p>bronze</p></blockquote><ul><li>青铜，青铜色</li></ul><blockquote><p>cohesion</p></blockquote><ul><li>凝聚力，团结</li><li><code>The lack of cohesion within the team made them lose the game.</code></li></ul><blockquote><p>catalog</p></blockquote><ul><li>目录</li></ul><blockquote><p>exemplify</p></blockquote><ul><li>例证，是…的典型</li><li><code>This painting exemplifies the artist's early style.</code></li></ul><blockquote><p>spawn</p></blockquote><ul><li>产卵，产生，促成</li><li>卵</li></ul><blockquote><p>yield</p></blockquote><ul><li>产生，出产，生产，让位</li><li>产量，收益</li><li><code>Hard work yields good results</code></li></ul><blockquote><p>volatile</p></blockquote><ul><li>易挥发的，不稳定的</li></ul><blockquote><p>tender</p></blockquote><ul><li>温柔，柔软的，和善的，年轻的</li><li>投标，提出，交付</li></ul><blockquote><p>floral</p></blockquote><ul><li>花的，像花的</li></ul><blockquote><p>blossom</p></blockquote><ul><li>花</li><li>开花，长成</li></ul><blockquote><p>hail</p></blockquote><ul><li>出生地是，来自，招呼，呼喊，称颂</li><li>冰雹，一阵</li></ul><blockquote><p>qualify</p></blockquote><ul><li>合格，有资格，修饰，限定</li><li><code>We qualified for the final by beating Stanford in previous rounds</code></li></ul><blockquote><p>fragrant</p></blockquote><ul><li>香的</li></ul><blockquote><p>tutor</p></blockquote><ul><li>导师</li><li>教，任教</li></ul><blockquote><p>outrageously</p></blockquote><ul><li><code>令人不能容忍地，肆无忌惮地</code></li><li><code>The outrageously high prices astounded him</code></li></ul><blockquote><p>suspend</p></blockquote><ul><li>推迟，暂停，悬挂，取消</li><li><code>The school suspended the sports meeting</code></li></ul><hr><blockquote><p>braid</p></blockquote><ul><li>表示名词可以是<code>穗带，发带</code></li><li>表示动词可以是<code>编织</code>,与之相似的有<code>weave</code></li></ul><blockquote><p>aspire</p></blockquote><ul><li>有志于，向往</li><li><code>He loves painting, and aspires to be a world-famous artist.</code></li></ul><blockquote><p>stalk</p></blockquote><ul><li>潜行，跟踪</li><li>杆，柄</li></ul><blockquote><p>municipal</p></blockquote><ul><li>市政的，地方性的</li></ul><blockquote><p>craftsman</p></blockquote><ul><li>工匠，手艺人</li></ul><blockquote><p>adhere</p></blockquote><ul><li>粘附，附着，坚守，遵守</li><li><code>For ten months he adhered to a strict no-fat low-salt diet.</code></li></ul><blockquote><p>profound</p></blockquote><ul><li>深远的，深切的，深奥的，渊博的</li><li><code>The reports has profound implications for schools</code></li></ul><blockquote><p>scratch</p></blockquote><ul><li>划伤，取消</li></ul><hr><blockquote><p>guilty</p></blockquote><p>I felt guilt about not visiting my parents more often.</p><blockquote><p>convenience</p></blockquote><p>For convenience, the two groups have been treated as one in this report.</p><blockquote><p>fluid</p></blockquote><p>The political sitatution is so fluid that any thoughtless move could lead to military conflict.</p><blockquote><p>average</p></blockquote><p>an average rate/cost/price</p><blockquote><p>restrict</p></blockquote><p>We restrict the number of students per class to 10.</p><blockquote><p>revenue</p></blockquote><p>The goverment who gain about 12 billion dolor in tax revenues over 5 years.</p><blockquote><p>retail</p></blockquote><p>Could you tell me the retail prices of these shoes?</p><blockquote><p>anxious</p></blockquote><p>Parents are naturelly anxious for their children.</p><blockquote><p>lower</p></blockquote><p>Please lower your voice in the library.</p><blockquote><p>finance</p></blockquote><p>The fund has been used largely to finance schools.</p><blockquote><p>commerce</p></blockquote><p>Commerce between China and Africa reached a historic high last year.</p><blockquote><p>surge</p></blockquote><p>The unexpected surge in inflation put the country’s economy into crisis.</p><blockquote><p>sticky</p></blockquote><p>I have to take a shower before going out because the sweat had made my skin sticky.</p><blockquote><p>meridian</p></blockquote><p>A meridian is an imaginary line running from north to south.</p><blockquote><p>protein</p></blockquote><p>The doctor advised use to increase the intake of essential proteins to form muscles.</p><blockquote><p>beverage</p></blockquote><p>Alcoholic beverages can only be sold to adults according to the new law.</p><blockquote><p>potential</p></blockquote><p>the potential for change</p><blockquote><p>release</p></blockquote><p>The children were asked to release the butterflies they had caught into the wild.</p><blockquote><p>liquid</p></blockquote><blockquote><p>texture</p></blockquote><p>This gile likes the soft texture of silk, so most of her clothes are made of it.</p><blockquote><p>territory</p></blockquote><p>The mountain is in Chinese territory.</p><hr><blockquote><p>remains</p></blockquote><p>Take aways the remians of lunch in time and keep your desk clean.</p><blockquote><p>ripen</p></blockquote><p>The bananas ripen too quickly and begain to rot.</p><blockquote><p>jar</p></blockquote><p>a jar of coffee</p><blockquote><p>seasoning</p></blockquote><p>She cooked this dish with a variety of seasonings.</p><blockquote><p>portion</p></blockquote><p>A significant portion of the population speaks English.</p><blockquote><p>hint</p></blockquote><p>I won’t reply to you directly, but I can give you a hint about the answer.</p><blockquote><p>slice</p></blockquote><p>a slice of bread</p><blockquote><p>intense</p></blockquote><p>This work demains intense concentration.</p><blockquote><p>recommend</p></blockquote><p>Can you recommend a good hotel?</p><blockquote><p>superior</p></blockquote><p>Superior intellgence</p><blockquote><p>rinse</p></blockquote><p>冲洗，漂洗</p><p>Rinse the cooked pasta with boiling water.</p><blockquote><p>plump</p></blockquote><p>The teacher was a cheerful plump woman.</p><blockquote><p>noticeable</p></blockquote><p>The effect of the medisine is noticeable especially in young people.</p><blockquote><p>moisture</p></blockquote><p>A rich soil that retains moisture is needed for this kind of plants to glow.</p><blockquote><p>nutrition</p></blockquote><p>to study food science and nutrition</p><blockquote><p>amount</p></blockquote><p>You will receive a bill for the full amount.</p><blockquote><p>ongoing</p></blockquote><p>The negotiation is still ongoing since no agreement has been reached.</p><blockquote><p>generous</p></blockquote><p>to be generous with your time</p><blockquote><p>bland</p></blockquote><p>The expert just gave a few bland comments.</p><blockquote><p>aroma</p></blockquote><p>She was awoken by the aroma of coffee and frying eggs.</p><blockquote><p>stimulate</p></blockquote><p>The game has stimulated her interest in studying.</p><blockquote><p>chunk</p></blockquote><p>I often eat a chunk of bread for breakfast.</p><blockquote><p>sprinkle</p></blockquote><p>Sprinkle a little chesses over the pizza, and cut it into eight slices.</p><blockquote><p>refreshing</p></blockquote><p>The breeze after the rain is very refreshing.</p><hr><blockquote><p>concentration</p></blockquote><p>表示名词就是<code>专心、集中</code>的意思</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I lost my concentration during the long <span class="keyword">and</span> dull lecture.</span><br></pre></td></tr></table></figure><blockquote><p>organic</p></blockquote><p>表示形容词，<code>有机的、器官的、组织的、简单的</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Organic apples are much smaller.</span><br></pre></td></tr></table></figure><blockquote><p>float</p></blockquote><p>表示动词，就是<code>漂浮，漂流，浮动，提出，股票上市</code></p><p>表示名词，就是<code>零钱、漂浮物</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The boats were floating gently down the river.</span><br></pre></td></tr></table></figure><blockquote><p>dilute</p></blockquote><p>表示形容词，就是<code>稀释的，淡的，稀薄的，褪色的</code></p><p>表示动词，就是<code>稀释、冲淡、变淡</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Dilute the fruit jucie <span class="keyword">with</span> about an equal amount of water.</span><br></pre></td></tr></table></figure><blockquote><p>metric</p></blockquote><p>表示名词，就是<code>米</code></p><p>表示形容词，就是<code>米制的，公制的</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Most high-tech industry have been using the metric system <span class="keyword">for</span> decade.</span><br></pre></td></tr></table></figure><blockquote><p>removeal</p></blockquote><p>表示名词，就是<code>移动，搬迁，除去</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">It<span class="string">&#x27;s just the removeal of a small lump, so you don&#x27;</span>t need to worry.</span><br></pre></td></tr></table></figure><blockquote><p>chamber</p></blockquote><p>表示名词，是<code>议会、会议、房间</code>的意思</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">They were have a meeting <span class="keyword">in</span> the council chamber.</span><br></pre></td></tr></table></figure><blockquote><p>mimic</p></blockquote><p>表示动词，<code>模仿，像</code></p><p>表示名词，<code>小丑，模仿者</code></p><p>表示形容词，<code>模仿的，模拟的</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The students could mimic the math teache<span class="string">r&#x27;s accents.</span></span><br></pre></td></tr></table></figure><blockquote><p>ventilation</p></blockquote><p>表名词，<code>通风设备</code>，<code>空气流通</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The factory had poor ventilation <span class="keyword">and</span> <span class="keyword">in</span> summer it became hot <span class="keyword">and</span> humid.</span><br></pre></td></tr></table></figure><blockquote><p>tend</p></blockquote><p>表动词，<code>倾向于，照料</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">When I<span class="string">&#x27;m tired, I tend to make mistakes.</span></span><br></pre></td></tr></table></figure><blockquote><p>flame</p></blockquote><p>表名词，<code>火焰，光芒，热情</code></p><p>表动词，<code>燃烧，爆发，激起</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The flame were growing higher <span class="keyword">and</span> higher.</span><br></pre></td></tr></table></figure><blockquote><p>solution</p></blockquote><p>表名词，<code>溶液，解答，应答</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Boosting tourism will provide a long-term soluntion to the city<span class="string">&#x27;s employment problems.</span></span><br></pre></td></tr></table></figure><blockquote><p>allergic</p></blockquote><p>表形容词，表示<code>过敏的，对...讨厌的</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A great number of people are born to be allergic to peanuts.</span><br></pre></td></tr></table></figure><blockquote><p>emit</p></blockquote><p>表动词，<code>发射，发出</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The new device can emit bright <span class="keyword">and</span> powerful lights.</span><br></pre></td></tr></table></figure><blockquote><p>ailment</p></blockquote><p>表名词，<code>小病</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Your cold <span class="keyword">is</span> just a minor ailment <span class="keyword">and</span> you neen<span class="string">&#x27;t go to hosipital.</span></span><br></pre></td></tr></table></figure><blockquote><p>quality</p></blockquote><p>表名词，<code>质量，品质，特性</code></p><p>表形容词，<code>优秀的，优质的</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">goods of a high quality</span><br></pre></td></tr></table></figure><blockquote><p>factor</p></blockquote><p>表名词，<code>因素，因子</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The deciding factor of the competition between top players <span class="keyword">is</span> their state of mind.</span><br></pre></td></tr></table></figure><blockquote><p>category</p></blockquote><p>表名词，<code>种类</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">We are divided into sev category by grades.</span><br></pre></td></tr></table></figure><hr><blockquote><p>freight</p></blockquote><p>v. 货运，寄送，使充满</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You can freight your belongings by air or sea.</span><br></pre></td></tr></table></figure><blockquote><p>ordeal</p></blockquote><p>n. 折磨，严峻考验</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">He believed he would survive the ordeal. <span class="comment"># 他相信可以熬过这场折磨</span></span><br></pre></td></tr></table></figure><blockquote><p>ordinate</p></blockquote><p>n. 纵坐标</p><blockquote><p>peripheral</p></blockquote><p>adj. 次要的，边缘的，附带的</p><blockquote><p>myopic</p></blockquote><p>adj. 近视的，缺乏远见的</p><blockquote><p>appraise</p></blockquote><p>v. 估价，评估</p><blockquote><p>bizarre</p></blockquote><p>adj. 奇形怪状的，古怪可笑的，怪诞的</p><blockquote><p>refute</p></blockquote><p>v. 反驳，驳斥</p><blockquote><p>newsletter</p></blockquote><p>n. 时事通讯</p><blockquote><p>embellish</p></blockquote><p>v. 装饰，渲染</p><blockquote><p>solder</p></blockquote><p>v. 焊接</p><blockquote><p>plasma</p></blockquote><p>n. 血浆，等离子体</p><blockquote><p>personnel</p></blockquote><p>n. 人事部门，人员，职员</p><blockquote><p>belie</p></blockquote><p>v. 掩饰，证明…不正确</p><blockquote><p>offensive</p></blockquote><p>adj. 冒犯，令人不适</p><blockquote><p>speculate</p></blockquote><p>v. 推测，猜测</p><blockquote><p>reconcile</p></blockquote><p>v. 调和，和解，将就，妥协</p><blockquote><p>withhold</p></blockquote><p>v. 拒绝，阻挡，隐瞒，克制，抑制</p><hr><blockquote><p>laborious</p></blockquote><p>adj. 耗费时力的，辛苦的，费力的</p><blockquote><p>pliant</p></blockquote><p>adj. 顺从的，易受影响的</p><blockquote><p>affluent</p></blockquote><p>adj. 富裕的，富足的</p><blockquote><p>unanimous</p></blockquote><p>adj. 全体同意的</p><blockquote><p>precipitate</p></blockquote><p>adj. 鲁莽的，仓促的</p><p>v. 加速，突然降临</p><blockquote><p>negligent</p></blockquote><p>adj. 疏忽的，玩忽职守的</p><blockquote><p>hamper</p></blockquote><p>v. 阻碍，妨碍</p><blockquote><p>concede</p></blockquote><p>v. 承认，授予</p><blockquote><p>vacant</p></blockquote><p>adj. 空着的，茫然的</p><blockquote><p>they face abysmal working conditions</p></blockquote><p>adj. 深不可测的，糟糕的</p><blockquote><p>unparalleled</p></blockquote><p>adj. 无与伦比的</p><blockquote><p>skeletal</p></blockquote><p>adj. 骨骼的，像骨骼的</p><blockquote><p>impede</p></blockquote><p>v. 妨碍，阻碍</p><blockquote><p>he was complelely eclipse by his brother</p></blockquote><p>n. 日食，月食；黯然失色；羽毛暗淡期；消失，丧失<br>v. 遮住……的光，使黯然失色</p><blockquote><p>illusory</p></blockquote><p>adj. 虚假的，幻觉的</p><blockquote><p>consistent</p></blockquote><p>adj. 始终如一的，一贯的；持续的，连续的；固守的，坚持的；一致的，吻合的</p><blockquote><p>overt secret</p></blockquote><p>adj. 公开的，不隐瞒的</p><blockquote><p>incessant</p></blockquote><p>adj. （令人不快的事物）不停的，连续的</p><blockquote><p>I’ll just improvise</p></blockquote><p>v. 即兴表演，即兴创作；临时做，临时凑成</p><blockquote><p>notable</p></blockquote><p>adj. 显要的，值得注意的；非常成功的，令人尊敬的</p><blockquote><p>nostalgia</p></blockquote><p>n. 怀旧，念旧</p><blockquote><p>mesmerize</p></blockquote><p>vt. 施催眠术；迷住；以魅力迫使</p><blockquote><p>recasting</p><p>reforge</p><p>remodel</p></blockquote><p>重铸</p><blockquote><p>burrow into sth.</p></blockquote><p>挖掘，深挖</p><hr><blockquote><p>rage</p></blockquote><p>盛怒，风靡一时</p><blockquote><p>eligible ineligible</p></blockquote><p>有资格的，合适的</p><blockquote><p>focalize in</p></blockquote><p>使聚焦，使集中</p><blockquote><p>bonanza</p></blockquote><p>财运，好运，兴盛，繁荣</p><blockquote><p>chaste</p></blockquote><p>贞洁的，简朴的，朴实的</p><blockquote><p>ample</p></blockquote><p>足够的，丰裕的，肥沃的</p><blockquote><p>depredation</p></blockquote><p>n. 劫掠，掠夺</p><blockquote><p>resin</p></blockquote><p>n. 树脂</p><blockquote><p>germ</p></blockquote><p>n. 微生物，细菌，萌芽</p><blockquote><p>citadel</p></blockquote><p>n. 堡垒，要塞</p><blockquote><p>crippling</p></blockquote><p>adj. 令人震惊的，极其有害的</p><blockquote><p>saunter</p></blockquote><p>v. 闲逛，漫步</p><blockquote><p>mercantile</p></blockquote><p>adj. 贸易的，商业的</p><blockquote><p>earnest</p></blockquote><p>adj. 真诚的，认真的</p><blockquote><p>auxiliary</p></blockquote><p>adj. 辅助的，后备的</p><blockquote><p>convene</p></blockquote><p>v. 召集，召开，集合</p><blockquote><p>simultaneous</p></blockquote><p>adj. 铜焊丝发生的，同步的</p><blockquote><p>competence</p></blockquote><p>n. 能力，胜任，称职</p><blockquote><p>hummingbird</p></blockquote><p>n. 蜂鸟</p><blockquote><p>tendon</p></blockquote><p>n. 腱</p><blockquote><p>reliance</p></blockquote><p>n. 依靠，依赖，信任</p><blockquote><p>sprawl</p></blockquote><p>v. 扩展，蔓延</p><blockquote><p>beaver</p></blockquote><p>n. 海狸鼠</p><p>v. 忙于，勤奋工作</p><blockquote><p>spinet</p></blockquote><p>小型立式钢琴</p><blockquote><p>coarse</p></blockquote><p>adj. 粗糙的</p><blockquote><p>demolish</p></blockquote><p>v. 拆除，破坏，驳倒，推翻</p><blockquote><p>hockey</p></blockquote><p>n. 曲棍球</p><blockquote><p>lizard</p></blockquote><p>n. 蜥蜴</p><blockquote><p>rodent</p></blockquote><p>n. 啮齿类动物</p><blockquote><p>appliance</p></blockquote><p>n. 装置，器械，应用</p><blockquote><p>parachute</p></blockquote><p>n. 降落伞</p><blockquote><p>theoretical</p></blockquote><p>adj. 理论的，理论上的</p><hr><blockquote><p>notch</p></blockquote><p>n. 等级，档次，圆形切口</p><blockquote><p>pronounced</p></blockquote><p>adj. 显著的，明确的</p><blockquote><p>prairie</p></blockquote><p>n. 大草原</p><blockquote><p>anomie</p></blockquote><p>n. 道德沦丧，失范，混乱</p><blockquote><p>paucity</p></blockquote><p>n. 极少量，少量</p><blockquote><p>seminar</p></blockquote><p>n. 研讨会，研讨班</p><blockquote><p>retrieval</p></blockquote><p>n. 数据检索，取回，索回</p><blockquote><p>invertebrate</p></blockquote><p>n. 无脊椎的</p><blockquote><p>monarch</p></blockquote><p>n. 君主，帝王</p><blockquote><p>cider</p></blockquote><p>n. 苹果酒</p><blockquote><p>integrity</p></blockquote><p>n. 正直，诚实，完整，完好</p><blockquote><p>gait</p></blockquote><p>n. 步法，步态</p><blockquote><p>shuttle</p></blockquote><p>n. 航天飞机，往返航班，梭子</p><blockquote><p>extrinsic intrinsic</p></blockquote><p>adj. 外来的，外在的，非本质的</p><blockquote><p>illegible eligible</p></blockquote><p>adj. 难以辨认的，模糊的</p><blockquote><p>exalt</p></blockquote><p>升迁</p><blockquote><p>ambiguous</p></blockquote><p>模棱两可的</p><blockquote><p>syntactic</p></blockquote><p>adj. 句法的，按照句法的</p><blockquote><p>grocery</p></blockquote><p>n. 杂货铺，咋活</p><blockquote><p>commonplace</p></blockquote><p>adj. 平凡的，普通的</p><blockquote><p>novice</p></blockquote><p>n. 新手，生手</p><blockquote><p>gregarious</p></blockquote><p>adj. 群居的，合群的</p><blockquote><p>ethic</p></blockquote><p>n. 道德规范的</p><blockquote><p>ore</p></blockquote><p>矿</p><blockquote><p>trumpet</p></blockquote><p>v. 鼓吹，宣扬</p><blockquote><p>conceivable</p></blockquote><p>adj. 可能的，可信的，可想象的</p><blockquote><p>allegiance</p></blockquote><p>n. 忠诚，拥戴</p><hr><blockquote><p>tactile</p></blockquote><p>adj. 触觉的，有触觉的</p><blockquote><p>intelligent</p></blockquote><p>adj. 聪明的，智能的</p><blockquote><p>stimulus</p></blockquote><p>n. 刺激(物)，激励，促进因素</p><blockquote><p>cargo</p></blockquote><p>n. 货物</p><blockquote><p>locality</p></blockquote><p>n. 地区，位置，地点，发生地</p><blockquote><p>disaster</p></blockquote><p>n. 灾难</p><blockquote><p>slumber</p></blockquote><p>n. 睡觉，睡眠</p><blockquote><p>pupil</p></blockquote><p>n. 学生，弟子，小学生</p><blockquote><p>irresistible</p></blockquote><p>adj. 无法抗拒的，诱人的，不能自己的</p><blockquote><p>systematize</p></blockquote><p>v. 使系统化，使条理化，使成体系</p><blockquote><p>hearsay</p></blockquote><p>n. 谣言，道听途说，传闻</p><blockquote><p>speckle</p></blockquote><p>v. 弄上斑点，点缀</p><blockquote><p>mottled</p></blockquote><p>adj. 有杂色的，斑驳的</p><blockquote><p>blush</p></blockquote><p>n. 脸红</p><blockquote><p>angiosperm</p></blockquote><p>n. 被子植物</p><blockquote><p>plow</p></blockquote><p>n. 犁</p><blockquote><p>exhale</p></blockquote><p>v. 呼出气，散发</p><blockquote><p>expeditious</p></blockquote><p>adj. 迅速有效的，迅速完成的</p><blockquote><p>stumble</p></blockquote><p>v. 绊脚，蹒跚而行，结巴</p><blockquote><p>roost</p></blockquote><p>v. 栖息</p><blockquote><p>fortum</p></blockquote><p>n. 公共讨论场所，论坛</p><blockquote><p>incapacitate</p></blockquote><p>v. 使无资格，使失去能力，使不胜任</p><blockquote><p>agonize</p></blockquote><p>v. 苦苦思索，焦虑不已</p><blockquote><p>exemplary</p></blockquote><p>adj. 模范的，典型的</p><blockquote><p>charisma</p></blockquote><p>n. 超凡魅力，感召力，号召力</p><blockquote><p>seismology</p></blockquote><p>n. 地震学</p><blockquote><p>luminous</p></blockquote><p>adj. 夜光的，发光的，发亮的</p><blockquote><p>antecedent</p></blockquote><p>n. 祖先，先辈</p><blockquote><p>siege</p></blockquote><p>n. 围攻，围困，包围，封锁</p><blockquote><p>subjugate</p></blockquote><p>vt. 征服，制服，使服从</p><blockquote><p>spontaneity</p></blockquote><p>n. 自发性，自发行为</p><blockquote><p>frivolity</p></blockquote><p>n. 轻浮，愚蠢的行为</p><blockquote><p>linguist</p></blockquote><p>n. 语言学家</p><hr><blockquote><p>perquisite</p></blockquote><p>Bonus/Privilege/Allowance</p><p>n. 特权，福利，附带的好处</p><blockquote><p>vaccine</p></blockquote><p>n. 疫苗</p><blockquote><p>aloof</p></blockquote><p>Distant/Reserved/Detached</p><p>adj. 冷漠的，冷淡的</p><blockquote><p>inert</p></blockquote><p>Passive/Lifeless/Inactive</p><p>adj. 不活动的，缺乏活力的</p><blockquote><p>palate</p></blockquote><p>n. 上颚，味觉</p><blockquote><p>aquifer</p></blockquote><p>n. 含水层</p><blockquote><p>advent</p></blockquote><p>Arrival/Onset/Commencement</p><p>n. 到来，来临</p><blockquote><p>curative</p></blockquote><p>Healing/Remedial/Therapeutic</p><p>adj. 治愈的，有疗效的</p><p>n. 医药，治疗无</p><blockquote><p>tectonics</p></blockquote><p>n. 构造学，板块构造</p><blockquote><p>teem</p></blockquote><p>Abound/Overflow/Swarm/fill</p><p>vi. 充满，倾注</p><blockquote><p>extrapolate</p></blockquote><p>Speculate/deduce/postulate</p><p>v. 推断，推知</p><blockquote><p>othodox</p></blockquote><p>Traditional/Conventional</p><p>adj. 正统的</p><blockquote><p>criticize</p></blockquote><p>Censure/Condemn/Denounce</p><p>v. 批评，批判，指责</p><blockquote><p>vertebrate</p></blockquote><p>Invertebrate</p><p>n. 脊椎动物</p><blockquote><p>olfactory</p></blockquote><p>Aroma/Fragrance/Scent</p><p>n. 嗅觉，鼻，嗅觉器官</p><p>adj. 嗅觉的</p><blockquote><p>concur</p></blockquote><p>Agree/Consent/Coincide/Co-occur</p><p>v. 赞同，同时发生</p><blockquote><p>pique</p></blockquote><p>Resentment</p><p>n. 愤恨，恼怒，不悦</p><p>v. 使愤恨</p><blockquote><p>disciple</p></blockquote><p>pupil</p><p>n. 门徒，追随者</p><blockquote><p>plausible</p></blockquote><p>Credible/Believable/Convincing</p><p>adj. 看似合理的</p><blockquote><p>swoon</p></blockquote><p>Faint/Collapse/Unconsciousness</p><p>v/n 昏迷</p><blockquote><p>pertinent</p></blockquote><p>Relevant/Applicable/Apropos</p><p>adj. 直接相关的，有关的</p><blockquote><p>accordion</p></blockquote><p>n. 手风琴</p><blockquote><p>huddle</p></blockquote><p>v/n 挤在一起</p><blockquote><p>with all due respect</p></blockquote><p>恕我直言</p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
    
    
    <summary type="html">针对扇贝英语单词印象不深的做一个记录。</summary>
    
    
    
    <category term="不想学辣" scheme="http://example.com/categories/%E4%B8%8D%E6%83%B3%E5%AD%A6%E8%BE%A3/"/>
    
    
    <category term="英语" scheme="http://example.com/tags/%E8%8B%B1%E8%AF%AD/"/>
    
  </entry>
  
  <entry>
    <title>【GEE】GEE中文食用说明书！</title>
    <link href="http://example.com/2023/07/23/%E3%80%90GEE%E3%80%91GEE%E4%B8%AD%E6%96%87%E9%A3%9F%E7%94%A8%E8%AF%B4%E6%98%8E%E4%B9%A6%EF%BC%81/"/>
    <id>http://example.com/2023/07/23/%E3%80%90GEE%E3%80%91GEE%E4%B8%AD%E6%96%87%E9%A3%9F%E7%94%A8%E8%AF%B4%E6%98%8E%E4%B9%A6%EF%BC%81/</id>
    <published>2023-07-23T12:43:08.603Z</published>
    <updated>2023-07-23T12:45:24.281Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>详见 <a href="https://chen-xiaolv.github.io/GeeDocumentC/">https://chen-xiaolv.github.io/GeeDocumentC/</a></p></blockquote><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
    
    
    <summary type="html">正在施工中！</summary>
    
    
    
    <category term="不想学辣" scheme="http://example.com/categories/%E4%B8%8D%E6%83%B3%E5%AD%A6%E8%BE%A3/"/>
    
    
    <category term="GIS" scheme="http://example.com/tags/GIS/"/>
    
    <category term="RS" scheme="http://example.com/tags/RS/"/>
    
    <category term="GEE" scheme="http://example.com/tags/GEE/"/>
    
  </entry>
  
  <entry>
    <title>【GEE】GeeMap食用说明书</title>
    <link href="http://example.com/2023/07/17/%E3%80%90GEE%E3%80%91GeeMap/"/>
    <id>http://example.com/2023/07/17/%E3%80%90GEE%E3%80%91GeeMap/</id>
    <published>2023-07-17T12:28:33.343Z</published>
    <updated>2023-07-23T12:44:12.547Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>纪念一下我装了半个下午终于装上的环境</p></blockquote><p>GEE是吴秋生博士为GEE开发的一套可视化Python模块，这个模块集成了诸多可视化工具和算法，能够助力GEE Python API的开发。目前已经在Github上获得2.8k stars了。</p><img src="/2023/07/17/%E3%80%90GEE%E3%80%91GeeMap/image-20230717203655539.png" alt="image-20230717203655539" style="zoom:50%;"><blockquote><p>吴老师是美国田纳西大学地理系的助理教授</p></blockquote><hr><h3 id="Chapter-1-GeeMap安装">Chapter 1 GeeMap安装</h3><p>保证conda环境下，我们按照如下步骤安装：</p><blockquote><p>这个是否一定是3.8不好说，反正我3.9是出问题了</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">conda create -n gee python=<span class="number">3.8</span></span><br><span class="line"></span><br><span class="line">conda activate gee</span><br><span class="line"></span><br><span class="line">conda install geemap -c conda-forge</span><br><span class="line"></span><br><span class="line">conda install geopandas</span><br><span class="line"></span><br><span class="line">conda install mamba -c conda-forge</span><br><span class="line"></span><br><span class="line">mamba install geemap xarray_leaflet -c conda-forge</span><br></pre></td></tr></table></figure><p>然后我们打开Jupyter：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">activate gee</span><br><span class="line"></span><br><span class="line">jupyter lab</span><br></pre></td></tr></table></figure><p>输入以下代码进行测试：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ee</span><br><span class="line"><span class="keyword">import</span> geemap</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">geemap.set_proxy(port=<span class="number">7890</span>)</span><br><span class="line"></span><br><span class="line">ee.Authenticate() <span class="comment"># 这一步是需要Google账号授权，按照步骤来填入tokens就行啦</span></span><br><span class="line"></span><br><span class="line">ee.Initialize() <span class="comment"># 初始化(实例化)</span></span><br><span class="line"></span><br><span class="line">Map=geemap.Map()</span><br><span class="line">Map</span><br></pre></td></tr></table></figure><p>当出现下图时，说明安装成功啦：</p><img src="/2023/07/17/%E3%80%90GEE%E3%80%91GeeMap/image-20230717204659590.png" alt="image-20230717204659590" style="zoom:50%;"><p>当然，这里指不定会爆出一些有的没的的问题，比如DLL找不到模块什么的：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pillow --upgrade</span><br></pre></td></tr></table></figure><p>或者是SSL Error:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">os.environ[<span class="string">&#x27;HTTP_PROXY&#x27;</span>] = <span class="string">&#x27;http://127.0.0.1:7890&#x27;</span></span><br><span class="line">os.environ[<span class="string">&#x27;HTTPS_PROXY&#x27;</span>] = <span class="string">&#x27;https://127.0.0.1:7890&#x27;</span></span><br></pre></td></tr></table></figure><p>将其设置为全局代理就行。</p><img src="/2023/07/17/%E3%80%90GEE%E3%80%91GeeMap/image-20230717210225282.png" alt="image-20230717210225282" style="zoom:33%;"><p>代理可能要开TUN Model <a href="https://docs.cfw.lbyczf.com/contents/tun.html#windows">说明</a></p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
    
    
    <summary type="html">~没有简介！</summary>
    
    
    
    <category term="不想学辣" scheme="http://example.com/categories/%E4%B8%8D%E6%83%B3%E5%AD%A6%E8%BE%A3/"/>
    
    
    <category term="GIS" scheme="http://example.com/tags/GIS/"/>
    
    <category term="RS" scheme="http://example.com/tags/RS/"/>
    
    <category term="GEE" scheme="http://example.com/tags/GEE/"/>
    
  </entry>
  
  <entry>
    <title>【Typora】常用公式查询</title>
    <link href="http://example.com/2023/07/14/%E3%80%90Typora%E3%80%91%E5%B8%B8%E7%94%A8%E5%85%AC%E5%BC%8F%E6%9F%A5%E8%AF%A2/"/>
    <id>http://example.com/2023/07/14/%E3%80%90Typora%E3%80%91%E5%B8%B8%E7%94%A8%E5%85%AC%E5%BC%8F%E6%9F%A5%E8%AF%A2/</id>
    <published>2023-07-14T02:13:41.525Z</published>
    <updated>2023-09-12T06:25:32.742Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>其实之前整过这一类，但是好像在本地没有存档，这边就重新记录一下</p></blockquote><h4 id="绘制花括号函数">绘制花括号函数</h4><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mo fence="true" lspace="0em" rspace="0em">{</mo></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}\left\{\right.\end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;">{</span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-2.85em;"><span class="pstrut" style="height:2.84em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">{</mo><mtable rowspacing="0.16em" columnalign="left right" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>x</mi><mo>=</mo><mfrac><mrow><mn>3</mn><mi mathvariant="normal">/</mi><mi>p</mi><mi>i</mi></mrow><mn>2</mn></mfrac><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mn>2</mn><mi>t</mi><mo stretchy="false">)</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mfrac><mrow><mn>3</mn><mi mathvariant="normal">/</mi><mi>p</mi><mi>i</mi></mrow><mn>2</mn></mfrac><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mn>2</mn><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>y</mi><mo>=</mo><mi>s</mi><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>0</mn><mo>≤</mo><mi>s</mi><mo>≤</mo><mi>L</mi><mo separator="true">,</mo><mi mathvariant="normal">∣</mi><mi>t</mi><mi mathvariant="normal">∣</mi><mo>≤</mo><mn>1.</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>z</mi><mo>=</mo><mfrac><mrow><mn>3</mn><mi mathvariant="normal">/</mi><mi>p</mi><mi>i</mi></mrow><mn>2</mn></mfrac><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mn>2</mn><mi>t</mi><mo stretchy="false">)</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mfrac><mrow><mn>3</mn><mi mathvariant="normal">/</mi><mi>p</mi><mi>i</mi></mrow><mn>2</mn></mfrac><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mn>2</mn><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd></mtr></mtable></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}\left\{\begin{array}{lr}x=\frac{3/pi}{2}(1+2t)cos(\frac{3/pi}{2}(1+2t)),\\y=s, &amp; 0\le s \le L, |t|\le 1.\\z=\frac{3/pi}{2}(1+2t)sin(\frac{3/pi}{2}(1+2t)),\end{array}\right.\end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.94em;vertical-align:-1.72em;"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.22em;"><span style="top:-4.22em;"><span class="pstrut" style="height:4.22em;"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-2.5em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.492em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.016em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.016em" style="width:0.8889em" viewbox="0 0 888.89 16" preserveaspectratio="xMinYMin"><path d="M384 0 H504 V16 H384z M384 0 H504 V16 H384z"/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.016em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.016em" style="width:0.8889em" viewbox="0 0 888.89 16" preserveaspectratio="xMinYMin"><path d="M384 0 H504 V16 H384z M384 0 H504 V16 H384z"/></svg></span></span><span style="top:-4.3em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.22em;"><span style="top:-4.22em;"><span class="pstrut" style="height:3.01em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3/</span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mord mathnormal">cos</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3/</span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord mathnormal">t</span><span class="mclose">))</span><span class="mpunct">,</span></span></span><span style="top:-3.02em;"><span class="pstrut" style="height:3.01em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">s</span><span class="mpunct">,</span></span></span><span style="top:-1.65em;"><span class="pstrut" style="height:3.01em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3/</span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mord mathnormal">s</span><span class="mord mathnormal">in</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3/</span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mord mathnormal">t</span><span class="mclose">))</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.72em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∣</span><span class="mord mathnormal">t</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.72em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.22em;"><span style="top:-4.22em;"><span class="pstrut" style="height:4.22em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.72em;"><span></span></span></span></span></span></span></span></span></p><h4 id="分段函数">分段函数</h4><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>y</mi><mo>=</mo><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">{</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>x</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>x</mi><mo>≤</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>x</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>x</mi><mo>&gt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">y=    \begin{equation}\left\{    \begin{array}{c}        x-1,&amp; x \le 0\\            x+1, &amp; x&gt;0            \end{array}    \right.    \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.45em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">{</span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mpunct">,</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.45em;"><span class="pstrut" style="height:3.45em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>F</mi><mrow><mi>n</mi><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">{</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>P</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>∗</mo><msub><mi>F</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub><mtext> </mtext><mi>o</mi><mi>r</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>R</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>∗</mo><msub><mi>F</mi><mrow><mi>n</mi><mn>2</mn></mrow></msub><mtext> </mtext><mi>o</mi><mi>r</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>∗</mo><msub><mi>F</mi><mrow><mi>n</mi><mn>2</mn></mrow></msub></mrow></mstyle></mtd></mtr></mtable></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">F_{nij}=\begin{equation}\left\{\begin{array}{c}P_{ij}*F_{n1} \ or\\R_{ij}*F_{n2} \ or\\S_{ij}*F_{n2}\end{array}\right.\end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">nij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:4.05em;"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-2.5em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.492em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.016em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.016em" style="width:0.8889em" viewbox="0 0 888.89 16" preserveaspectratio="xMinYMin"><path d="M384 0 H504 V16 H384z M384 0 H504 V16 H384z"/></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.016em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.016em" style="width:0.8889em" viewbox="0 0 888.89 16" preserveaspectratio="xMinYMin"><path d="M384 0 H504 V16 H384z M384 0 H504 V16 H384z"/></svg></span></span><span style="top:-4.3em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:4.05em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span></span></span></p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">]]></content>
    
    
    <summary type="html">记录一些常用的数学公式</summary>
    
    
    
    <category term="不想学辣" scheme="http://example.com/categories/%E4%B8%8D%E6%83%B3%E5%AD%A6%E8%BE%A3/"/>
    
    
  </entry>
  
</feed>
